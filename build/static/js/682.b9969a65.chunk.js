"use strict";(self.webpackChunkagristack_farmer_management=self.webpackChunkagristack_farmer_management||[]).push([[682],{6682:(e,s,a)=>{a.r(s),a.d(s,{default:()=>N});var l=a(5043),t=a(5016),i=a(476),r=(a(5812),a(6428)),n=a(980),c=a(2383),d=a(9553),o=a(1125),m=a(8022),h=a(2343),u=(a(8756),a(838)),v=a(51),p=a(8874),j=(a(1953),a(9764)),x=a(579);const N=()=>{const{user:e,logout:s}=(0,t.As)(),[a,N]=(0,l.useState)("overview"),[g,y]=(0,l.useState)([]),[b,k]=(0,l.useState)([]),[f,E]=(0,l.useState)(""),[S,A]=(0,l.useState)(!1),[C,w]=(0,l.useState)(!1),[R,D]=(0,l.useState)(!1),[P,F]=(0,l.useState)(!1),[K,T]=(0,l.useState)(null),[Y,I]=(0,l.useState)(!1),[_,O]=(0,l.useState)(null),[B,G]=(0,l.useState)(!1),[V,U]=(0,l.useState)(null),[M,J]=(0,l.useState)(null),[q,L]=(0,l.useState)(null),[W,H]=(0,l.useState)([]),[Q,$]=(0,l.useState)(!1),[z,X]=(0,l.useState)(null),[Z,ee]=(0,l.useState)(!1),[se,ae]=(0,l.useState)(null),[le,te]=(0,l.useState)(!1),[ie,re]=(0,l.useState)(!1),[ne,ce]=(0,l.useState)({role:"",status:""}),[de,oe]=(0,l.useState)({state:"",district:"",region:"",kycStatus:"",assignmentStatus:"",employeeFilter:""}),[me,he]=(0,l.useState)(!1),[ue,ve]=(0,l.useState)(!1),[pe,je]=(0,l.useState)(!1),[xe,Ne]=(0,l.useState)(null),[ge,ye]=(0,l.useState)(null),[be,ke]=(0,l.useState)(!1);(0,l.useEffect)((()=>{fe();const e=e=>{console.log("\ud83d\udd04 Admin Dashboard: KYC status updated, refreshing data..."),console.log("\ud83d\udcca KYC Update details:",e.detail),setTimeout((()=>{console.log("\ud83d\udd04 Refreshing Admin data after KYC update..."),fe()}),2e3)};return window.addEventListener("kycStatusUpdated",e),()=>{window.removeEventListener("kycStatusUpdated",e)}}),[]);const fe=async()=>{try{console.log("\ud83d\udd0d Admin: Starting to fetch real data from API...");const[e,s,a]=await Promise.all([i.Er.getFarmersWithKyc(),i.Er.getEmployeesWithStats(),i.Dv.getRegistrationList()]);console.log("\u2705 Admin API Response:",{farmersCount:(null===e||void 0===e?void 0:e.length)||0,employeesCount:(null===s||void 0===s?void 0:s.length)||0,registrationsCount:(null===a||void 0===a?void 0:a.length)||0}),y(e||[]),k(s||[]),H(a||[]),console.log("\u2705 Admin: Using real data from APIs"),console.log("- Farmers:",(null===e||void 0===e?void 0:e.length)||0,"records"),console.log("- Employees:",(null===s||void 0===s?void 0:s.length)||0,"records"),console.log("- Registrations:",(null===a||void 0===a?void 0:a.length)||0,"records")}catch(e){console.error("\u274c Admin error fetching data:",e),console.log("\u274c Using fallback endpoints due to API error");try{const[e,s,a]=await Promise.all([i.Er.getAllFarmers(),i.Er.getAllEmployees(),i.Dv.getRegistrationList()]);console.log("\u2705 Fallback API Response:",{farmersCount:(null===e||void 0===e?void 0:e.length)||0,employeesCount:(null===s||void 0===s?void 0:s.length)||0,registrationsCount:(null===a||void 0===a?void 0:a.length)||0}),y(e||[]),k(s||[]),H(a||[])}catch(s){console.error("\u274c Fallback API also failed:",s),y([]),k([]),H([])}}},Ee=e=>{ae(e),ee(!0)},Se=async e=>{try{await i.Dv.approveUser(e,"FARMER"),H((s=>s.map((s=>s.id===e?{...s,status:"APPROVED"}:s)))),alert("Registration approved successfully!")}catch(s){console.error("Error approving registration:",s),alert("Failed to approve registration. Please try again.")}},Ae=async e=>{try{await i.Dv.rejectUser(e,"Rejected by Admin"),H((s=>s.map((s=>s.id===e?{...s,status:"REJECTED"}:s)))),alert("Registration rejected successfully!")}catch(s){console.error("Error rejecting registration:",s),alert("Failed to reject registration. Please try again.")}},Ce=()=>{const e=(null===g||void 0===g?void 0:g.length)||0,s=(null===b||void 0===b?void 0:b.length)||0,a=(g||[]).filter((e=>!e.assignedEmployee||"Not Assigned"===e.assignedEmployee)).length,l=(g||[]).filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,t=(g||[]).filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,i=(g||[]).filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,r=(g||[]).filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return console.log("Admin Stats calculated from real data:"),console.log("- Total Farmers:",e),console.log("- Total Employees:",s),console.log("- Unassigned Farmers:",a),console.log("- Pending KYC:",l),console.log("- Approved KYC:",t),console.log("- Refer Back KYC:",i),console.log("- Rejected KYC:",r),{totalFarmers:e,totalEmployees:s,unassignedFarmers:a,pendingKYC:l,approvedKYC:t,referBackKYC:i,rejectedKYC:r}},we=e=>{T(e),F(!0)},Re=e=>{O(e),I(!0)},De=e=>{U(e),G(!0)},Pe=e=>{J(e),w(!0)},Fe=e=>{L(e),D(!0)},Ke=()=>{w(!0),N("overview")},Te=()=>{ve(!0),Ne(null),N("overview")},Ye=()=>{D(!0),N("overview")},Ie=()=>{je(!0),ye(null),N("overview")},_e=()=>{A(!0),N("overview")},Oe=()=>{ke(!0),N("overview")};return(0,x.jsxs)("div",{className:"dashboard",children:[(0,x.jsxs)("div",{className:"top-bar",children:[(0,x.jsxs)("div",{className:"top-bar-left",children:[(0,x.jsx)("div",{className:"logo-container",children:(0,x.jsxs)("div",{className:"logo-text",children:[(0,x.jsx)("h1",{className:"logo-title",children:"DATE"}),(0,x.jsx)("p",{className:"logo-subtitle",children:"Digital Agristack Transaction Enterprises"})]})}),(0,x.jsx)("div",{className:"date-display",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,x.jsxs)("div",{className:"top-bar-right",children:[(0,x.jsx)(p.A,{}),(0,x.jsx)(v.A,{})]})]}),(0,x.jsxs)("aside",{className:"dashboard-sidebar",children:[(0,x.jsx)("div",{className:"sidebar-header",children:(0,x.jsxs)("div",{className:"logo",children:[(0,x.jsx)("div",{className:"logo-text",children:"Welcome !!!"}),(0,x.jsx)("div",{className:"logo-subtitle",children:"Admin"})]})}),(0,x.jsxs)("nav",{className:"sidebar-nav",children:[(0,x.jsx)("button",{className:"nav-item "+("overview"===a?"active":""),onClick:()=>N("overview"),children:"\ud83d\udcca Overview"}),(0,x.jsx)("button",{className:"nav-item "+("kyc-overview"===a?"active":""),onClick:()=>N("kyc-overview"),children:"\ud83e\udeaa KYC Overview"}),(0,x.jsx)("button",{className:"nav-item "+("farmers"===a?"active":""),onClick:()=>N("farmers"),children:"\ud83d\udc68\u200d\ud83c\udf3e Farmers"}),(0,x.jsx)("button",{className:"nav-item "+("employees"===a?"active":""),onClick:()=>N("employees"),children:"\ud83d\udc65 Employees"}),(0,x.jsx)("button",{className:"nav-item "+("registration"===a?"active":""),onClick:()=>N("registration"),children:"\ud83d\udcdd Registrations"})]})]}),(0,x.jsx)("main",{className:"dashboard-main",children:(0,x.jsxs)("div",{className:"dashboard-content",children:["overview"===a&&(0,x.jsx)("header",{className:"dashboard-header",children:(0,x.jsx)("div",{className:"header-center",children:(0,x.jsxs)("div",{className:"welcome-message",children:[(0,x.jsxs)("h2",{className:"greeting",children:[(()=>{const e=(new Date).getHours();return e>=5&&e<12?"Good Morning":e>=12&&e<17?"Good Afternoon":e>=17&&e<21?"Good Evening":"Good Night"})(),", ",(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.email)||"Admin","! \ud83c\udf8b"]}),(0,x.jsx)("p",{className:"welcome-text",children:"Welcome to DATE Digital Agristack - Manage farmers, employees and registrations efficiently."})]})})}),C?(0,x.jsx)("div",{className:"dashboard-form-container",children:(0,x.jsx)(r.A,{isInDashboard:!0,editData:M,onClose:()=>{w(!1),J(null)},onSubmit:async e=>{try{if(M){const s=await i.xs.updateFarmer(M.id,e);y((e=>e.map((e=>e.id===M.id?s:e)))),alert("Farmer updated successfully!")}else{const s=await i.xs.createFarmer(e);y((e=>[...e,s])),alert("Farmer created successfully!")}w(!1),J(null)}catch(s){console.error("Error saving farmer:",s),alert("Failed to save farmer. Please try again.")}}})}):R?(0,x.jsx)("div",{className:"dashboard-form-container",children:(0,x.jsx)(c.A,{isInDashboard:!0,editData:q,onClose:()=>{D(!1),L(null)},onSubmit:async e=>{try{if(q){const s=await i.s2.updateEmployee(q.id,e);k((e=>e.map((e=>e.id===q.id?s:e)))),alert("Employee updated successfully!")}else{const s=await i.s2.createEmployee(e);k((e=>[...e,s])),alert("Employee created successfully!")}D(!1),L(null)}catch(s){console.error("Error saving employee:",s),alert("Failed to save employee. Please try again.")}}})}):ue?(0,x.jsx)("div",{className:"dashboard-form-container",children:(0,x.jsx)(m.A,{isInDashboard:!0,farmerData:xe||g,onClose:()=>{xe?Ne(null):ve(!1)},onFarmerSelect:e=>{Ne(e)}})}):pe?(0,x.jsx)("div",{className:"dashboard-form-container",children:(0,x.jsx)(h.A,{isInDashboard:!0,employeeData:ge||b,onClose:()=>{ge?ye(null):je(!1)},onEmployeeSelect:e=>{ye(e)}})}):be?(0,x.jsx)("div",{className:"dashboard-form-container",children:(0,x.jsxs)("div",{className:"view-farmer-dashboard",children:[(0,x.jsx)("div",{className:"dashboard-header",children:(0,x.jsxs)("div",{className:"header-content",children:[(0,x.jsxs)("div",{className:"header-text",children:[(0,x.jsx)("h1",{className:"dashboard-title",children:"Pending KYC"}),(0,x.jsx)("p",{className:"dashboard-subtitle",children:"Review and manage pending KYC applications"})]}),(0,x.jsxs)("button",{className:"back-button",onClick:()=>{ke(!1)},children:[(0,x.jsx)("i",{className:"fas fa-arrow-left"}),"Back"]})]})}),(0,x.jsx)("div",{className:"dashboard-content",children:(0,x.jsx)("div",{className:"farmers-table-container",children:(0,x.jsxs)("table",{className:"farmers-table",children:[(0,x.jsx)("thead",{className:"table-header",children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"Name"}),(0,x.jsx)("th",{children:"Phone"}),(0,x.jsx)("th",{children:"State"}),(0,x.jsx)("th",{children:"District"}),(0,x.jsx)("th",{children:"KYC Status"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{className:"table-body",children:g.filter((e=>"PENDING"===e.kycStatus)).map((e=>(0,x.jsxs)("tr",{className:"table-row",children:[(0,x.jsx)("td",{className:"table-cell",children:e.name}),(0,x.jsx)("td",{className:"table-cell",children:e.phone}),(0,x.jsx)("td",{className:"table-cell",children:e.state}),(0,x.jsx)("td",{className:"table-cell",children:e.district}),(0,x.jsx)("td",{className:"table-cell",children:(0,x.jsx)("span",{className:"status-badge pending",children:"PENDING"})}),(0,x.jsx)("td",{className:"table-cell",children:(0,x.jsx)("button",{className:"action-btn small",onClick:()=>De(e),children:"Review KYC"})})]},e.id)))})]})})})]})}):(0,x.jsxs)(x.Fragment,{children:["overview"===a&&(()=>{const e=Ce();return(0,x.jsxs)("div",{className:"overview-section",children:[(0,x.jsxs)("div",{className:"overview-header",children:[(0,x.jsx)("h2",{className:"overview-title",children:"Admin Dashboard Overview"}),(0,x.jsx)("p",{className:"overview-description",children:"Manage farmers, employees, and assignments efficiently."})]}),(0,x.jsxs)("div",{className:"stats-grid admin-stats-grid",children:[(0,x.jsxs)("div",{className:"stats-card assigned",children:[(0,x.jsx)("h3",{className:"stats-title",children:"Farmers"}),(0,x.jsx)("div",{className:"stats-number",children:e.totalFarmers})]}),(0,x.jsxs)("div",{className:"stats-card approved",children:[(0,x.jsx)("h3",{className:"stats-title",children:"Employees"}),(0,x.jsx)("div",{className:"stats-number",children:e.totalEmployees})]}),(0,x.jsxs)("div",{className:"stats-card refer",children:[(0,x.jsx)("h3",{className:"stats-title",children:"FPO"}),(0,x.jsx)("div",{className:"stats-number",children:"0"})]})]}),(0,x.jsxs)("div",{className:"bottom-sections",children:[(0,x.jsxs)("div",{className:"section-card",children:[(0,x.jsxs)("div",{className:"section-header",children:[(0,x.jsx)("h3",{children:"Recent Activities"}),(0,x.jsx)("button",{className:"section-link",onClick:()=>console.log("View All clicked"),children:"View All"})]}),(0,x.jsxs)("div",{className:"activities-list",children:[(0,x.jsxs)("div",{className:"activity-item success",children:[(0,x.jsx)("div",{className:"activity-icon",children:"\ud83d\udc64"}),(0,x.jsxs)("div",{className:"activity-content",children:[(0,x.jsx)("div",{className:"activity-text",children:"Farmer profile updated"}),(0,x.jsx)("div",{className:"activity-time",children:"20m ago"}),(0,x.jsx)("button",{className:"activity-badge success",children:"SUCCESS"})]})]}),(0,x.jsxs)("div",{className:"activity-item success",children:[(0,x.jsx)("div",{className:"activity-icon",children:"\ud83d\udc68\u200d\ud83d\udcbc"}),(0,x.jsxs)("div",{className:"activity-content",children:[(0,x.jsx)("div",{className:"activity-text",children:"Employee profile updated"}),(0,x.jsx)("div",{className:"activity-time",children:"10m ago"}),(0,x.jsx)("button",{className:"activity-badge success",children:"SUCCESS"})]})]}),(0,x.jsxs)("div",{className:"activity-item pending",children:[(0,x.jsx)("div",{className:"activity-icon",children:"\ud83d\udccb"}),(0,x.jsxs)("div",{className:"activity-content",children:[(0,x.jsx)("div",{className:"activity-text",children:"New registration pending approval"}),(0,x.jsx)("div",{className:"activity-time",children:"5m ago"}),(0,x.jsx)("button",{className:"activity-badge pending",children:"PENDING"})]})]})]})]}),(0,x.jsxs)("div",{className:"section-card",children:[(0,x.jsx)("div",{className:"section-header",children:(0,x.jsx)("h3",{children:"Quick Actions"})}),(0,x.jsxs)("div",{className:"quick-actions-grid",children:[(0,x.jsxs)("button",{className:"quick-action-btn primary",onClick:Ke,children:[(0,x.jsx)("i",{className:"fas fa-user-plus"}),"Add Farmer"]}),(0,x.jsxs)("button",{className:"quick-action-btn secondary",onClick:Te,children:[(0,x.jsx)("i",{className:"fas fa-users"}),"View Farmers"]}),(0,x.jsxs)("button",{className:"quick-action-btn primary",onClick:Ye,children:[(0,x.jsx)("i",{className:"fas fa-user-tie"}),"Add Employee"]}),(0,x.jsxs)("button",{className:"quick-action-btn secondary",onClick:Ie,children:[(0,x.jsx)("i",{className:"fas fa-user-tie"}),"View Employee"]}),(0,x.jsxs)("button",{className:"quick-action-btn primary",onClick:_e,children:[(0,x.jsx)("i",{className:"fas fa-link"}),"Assign Farmers"]}),(0,x.jsxs)("button",{className:"quick-action-btn secondary",onClick:Oe,children:[(0,x.jsx)("i",{className:"fas fa-clock"}),"Pending KYC"]})]})]})]})]})})(),"kyc-overview"===a&&(()=>{const e=Ce();return(0,x.jsxs)("div",{className:"overview-section",children:[(0,x.jsxs)("div",{className:"overview-header",children:[(0,x.jsx)("h2",{className:"overview-title",children:"KYC Overview"}),(0,x.jsx)("p",{className:"overview-description",children:"Comprehensive view of KYC status across all farmers and employees."})]}),(0,x.jsxs)("div",{className:"kyc-breakdown",children:[(0,x.jsx)("h3",{children:"KYC Status Breakdown"}),(0,x.jsxs)("div",{className:"kyc-stats-grid",children:[(0,x.jsxs)("div",{className:"kyc-stat-card approved",children:[(0,x.jsx)("span",{className:"kyc-stat-number",children:e.approvedKYC}),(0,x.jsx)("span",{className:"kyc-stat-label",children:"Approved"})]}),(0,x.jsxs)("div",{className:"kyc-stat-card pending",children:[(0,x.jsx)("span",{className:"kyc-stat-number",children:e.pendingKYC}),(0,x.jsx)("span",{className:"kyc-stat-label",children:"Pending"})]}),(0,x.jsxs)("div",{className:"kyc-stat-card refer-back",children:[(0,x.jsx)("span",{className:"kyc-stat-number",children:e.referBackKYC}),(0,x.jsx)("span",{className:"kyc-stat-label",children:"Refer Back"})]}),(0,x.jsxs)("div",{className:"kyc-stat-card rejected",children:[(0,x.jsx)("span",{className:"kyc-stat-number",children:e.rejectedKYC}),(0,x.jsx)("span",{className:"kyc-stat-label",children:"Rejected"})]})]})]}),(0,x.jsxs)("div",{className:"employee-stats",children:[(0,x.jsx)("h3",{children:"Employee KYC Progress"}),(0,x.jsx)("div",{className:"employee-stats-grid",children:b.map((e=>{const s=(g||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,l=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,t=s.filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,i=s.filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return(0,x.jsxs)("div",{className:"employee-stat-card",children:[(0,x.jsxs)("div",{className:"employee-info",children:[(0,x.jsx)("h4",{children:e.name}),(0,x.jsxs)("p",{children:[e.designation," - ",e.district]})]}),(0,x.jsxs)("div",{className:"employee-kyc-stats",children:[(0,x.jsxs)("div",{className:"kyc-stat",children:[(0,x.jsx)("span",{className:"stat-number",children:s.length}),(0,x.jsx)("span",{className:"stat-label",children:"Total Assigned"})]}),(0,x.jsxs)("div",{className:"kyc-stat",children:[(0,x.jsx)("span",{className:"stat-number approved",children:a}),(0,x.jsx)("span",{className:"stat-label",children:"Approved"})]}),(0,x.jsxs)("div",{className:"kyc-stat",children:[(0,x.jsx)("span",{className:"stat-number pending",children:l}),(0,x.jsx)("span",{className:"stat-label",children:"Pending"})]}),(0,x.jsxs)("div",{className:"kyc-stat",children:[(0,x.jsx)("span",{className:"stat-number refer-back",children:t}),(0,x.jsx)("span",{className:"stat-label",children:"Refer Back"})]}),(0,x.jsxs)("div",{className:"kyc-stat",children:[(0,x.jsx)("span",{className:"stat-number rejected",children:i}),(0,x.jsx)("span",{className:"stat-label",children:"Rejected"})]})]})]},e.id)}))})]}),(0,x.jsxs)("div",{className:"kyc-progress-section",children:[(0,x.jsx)("h3",{children:"KYC Progress Overview"}),(0,x.jsxs)("div",{className:"kyc-progress-grid",children:[(0,x.jsxs)("div",{className:"progress-card approved",children:[(0,x.jsx)("div",{className:"progress-circle",children:(0,x.jsx)("div",{className:"progress-number",children:e.approvedKYC})}),(0,x.jsx)("div",{className:"progress-label",children:"Approved KYC"})]}),(0,x.jsxs)("div",{className:"progress-card pending",children:[(0,x.jsx)("div",{className:"progress-circle",children:(0,x.jsx)("div",{className:"progress-number",children:e.pendingKYC})}),(0,x.jsx)("div",{className:"progress-label",children:"Pending KYC"})]}),(0,x.jsxs)("div",{className:"progress-card refer-back",children:[(0,x.jsx)("div",{className:"progress-circle",children:(0,x.jsx)("div",{className:"progress-number",children:e.referBackKYC})}),(0,x.jsx)("div",{className:"progress-label",children:"Refer Back"})]}),(0,x.jsxs)("div",{className:"progress-card rejected",children:[(0,x.jsx)("div",{className:"progress-circle",children:(0,x.jsx)("div",{className:"progress-number",children:e.rejectedKYC})}),(0,x.jsx)("div",{className:"progress-label",children:"Rejected KYC"})]})]})]})]})})(),"farmers"===a&&(()=>{const e=(g||[]).filter((e=>{const s=!de.state||e.state===de.state,a=!de.district||e.district===de.district,l=!de.kycStatus||e.kycStatus===de.kycStatus,t=!de.employeeFilter||e.assignedEmployee===de.employeeFilter;return s&&a&&l&&t}));return(0,x.jsx)("div",{className:"overview-section",children:ie?(0,x.jsxs)("div",{className:"farmer-registration-section",children:[(0,x.jsxs)("div",{className:"section-header",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{className:"section-title",children:"Add New Farmer"}),(0,x.jsx)("p",{className:"section-description",children:"Fill in the farmer details to create a new farmer account."})]}),(0,x.jsx)("div",{className:"section-actions",children:(0,x.jsxs)("button",{className:"action-btn-small secondary",onClick:()=>re(!1),children:[(0,x.jsx)("i",{className:"fas fa-arrow-left"}),"Back to Farmers"]})})]}),(0,x.jsx)(n.A,{isInDashboard:!0,onClose:()=>re(!1),onSubmit:async e=>{try{const s=await i.xs.createFarmer(e);y((e=>[...e,s])),alert("Farmer created successfully!"),re(!1)}catch(s){console.error("Error creating farmer:",s),alert("Failed to create farmer. Please try again.")}}})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"overview-header",children:[(0,x.jsx)("h2",{className:"overview-title",children:"Farmer Management"}),(0,x.jsx)("p",{className:"overview-description",children:"View and manage all farmer profiles with KYC status and assignments."}),(0,x.jsxs)("div",{className:"overview-actions",children:[(0,x.jsx)("button",{className:"action-btn primary",onClick:()=>re(!0),children:"Add Farmer"}),(0,x.jsx)("button",{className:"action-btn secondary",onClick:()=>A(!0),children:"Assign Farmers"})]})]}),(0,x.jsxs)("div",{className:"filters-section",children:[(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("label",{className:"filter-label",children:"State"}),(0,x.jsxs)("select",{value:de.state,onChange:e=>oe((s=>({...s,state:e.target.value}))),className:"filter-select",children:[(0,x.jsx)("option",{value:"",children:"All States"}),(0,x.jsx)("option",{value:"Telangana",children:"Telangana"}),(0,x.jsx)("option",{value:"Andhrapradesh",children:"Andhrapradesh"}),(0,x.jsx)("option",{value:"Maharashtra",children:"Maharashtra"}),(0,x.jsx)("option",{value:"Gujarat",children:"Gujarat"}),(0,x.jsx)("option",{value:"Punjab",children:"Punjab"}),(0,x.jsx)("option",{value:"Uttar Pradesh",children:"Uttar Pradesh"}),(0,x.jsx)("option",{value:"Tamil Nadu",children:"Tamil Nadu"})]})]}),(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("label",{className:"filter-label",children:"District"}),(0,x.jsxs)("select",{value:de.district,onChange:e=>oe((s=>({...s,district:e.target.value}))),className:"filter-select",children:[(0,x.jsx)("option",{value:"",children:"All Districts"}),(0,x.jsx)("option",{value:"Karimnagar",children:"Karimnagar"}),(0,x.jsx)("option",{value:"rangareddy",children:"Rangareddy"}),(0,x.jsx)("option",{value:"kadapa",children:"Kadapa"}),(0,x.jsx)("option",{value:"Kadapa",children:"Kadapa"}),(0,x.jsx)("option",{value:"kadpaa",children:"Kadpaa"}),(0,x.jsx)("option",{value:"Kuppam",children:"Kuppam"}),(0,x.jsx)("option",{value:"Pune",children:"Pune"}),(0,x.jsx)("option",{value:"Ahmedabad",children:"Ahmedabad"}),(0,x.jsx)("option",{value:"Amritsar",children:"Amritsar"}),(0,x.jsx)("option",{value:"Lucknow",children:"Lucknow"}),(0,x.jsx)("option",{value:"Chennai",children:"Chennai"})]})]}),(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("label",{className:"filter-label",children:"KYC Status"}),(0,x.jsxs)("select",{value:de.kycStatus,onChange:e=>oe((s=>({...s,kycStatus:e.target.value}))),className:"filter-select",children:[(0,x.jsx)("option",{value:"",children:"All KYC Status"}),(0,x.jsx)("option",{value:"APPROVED",children:"Approved"}),(0,x.jsx)("option",{value:"PENDING",children:"Pending"}),(0,x.jsx)("option",{value:"NOT_STARTED",children:"Not Started"}),(0,x.jsx)("option",{value:"REFER_BACK",children:"Refer Back"}),(0,x.jsx)("option",{value:"REJECTED",children:"Rejected"})]})]}),(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("label",{className:"filter-label",children:"Assignment Status"}),(0,x.jsxs)("select",{value:de.assignmentStatus,onChange:e=>oe((s=>({...s,assignmentStatus:e.target.value}))),className:"filter-select",children:[(0,x.jsx)("option",{value:"",children:"All Assignment Status"}),(0,x.jsx)("option",{value:"ASSIGNED",children:"Assigned"}),(0,x.jsx)("option",{value:"UNASSIGNED",children:"Unassigned"})]})]}),(0,x.jsxs)("div",{className:"filter-group",children:[(0,x.jsx)("label",{className:"filter-label",children:"Assigned Employee"}),(0,x.jsxs)("select",{value:de.employeeFilter,onChange:e=>oe((s=>({...s,employeeFilter:e.target.value}))),className:"filter-select",children:[(0,x.jsx)("option",{value:"",children:"All Employees"}),b.map((e=>(0,x.jsx)("option",{value:e.name,children:e.name},e.id)))]})]}),(0,x.jsx)("div",{className:"filter-actions",children:(0,x.jsxs)("button",{className:"filter-btn-clear",onClick:()=>oe({state:"",district:"",region:"",kycStatus:"",assignmentStatus:"",employeeFilter:""}),children:[(0,x.jsx)("i",{className:"fas fa-times"}),"Clear Filters"]})})]}),(0,x.jsx)(u.A,{data:e,columns:[{key:"name",label:"Name"},{key:"contactNumber",label:"Phone"},{key:"state",label:"State"},{key:"district",label:"District"},{key:"kycStatus",label:"KYC Status",render:e=>e?"PENDING"===e||"pending"===e?"PENDING":"APPROVED"===e||"approved"===e?"APPROVED":"REFER_BACK"===e||"refer_back"===e?"REFER_BACK":"REJECTED"===e||"rejected"===e?"REJECTED":"NOT_STARTED"===e||"not_started"===e?"NOT_STARTED":e.toUpperCase():"NOT_STARTED"},{key:"assignedEmployee",label:"Assigned Employee"}],customActions:[{label:"View",className:"action-btn-small info",onClick:we},{label:"Edit",className:"action-btn-small primary",onClick:Pe},{label:"KYC",className:"action-btn-small warning",onClick:De}]})]})})})(),"employees"===a&&(()=>{const e=(b||[]).filter((e=>!de.district||e.district===de.district));return(0,x.jsx)("div",{className:"overview-section",children:le?(0,x.jsxs)("div",{className:"employee-registration-section",children:[(0,x.jsxs)("div",{className:"section-header",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{className:"section-title",children:"Add New Employee"}),(0,x.jsx)("p",{className:"section-description",children:"Fill in the employee details to create a new employee account."})]}),(0,x.jsx)("div",{className:"section-actions",children:(0,x.jsxs)("button",{className:"action-btn-small secondary",onClick:()=>te(!1),children:[(0,x.jsx)("i",{className:"fas fa-arrow-left"}),"Back to Employees"]})})]}),(0,x.jsx)(c.A,{isInDashboard:!0,onClose:()=>te(!1),onSubmit:async e=>{try{const s=await i.s2.createEmployee(e);k((e=>[...e,s])),alert("Employee created successfully!"),te(!1)}catch(s){console.error("Error creating employee:",s),alert("Failed to create employee. Please try again.")}}})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"overview-header",children:[(0,x.jsx)("h2",{className:"overview-title",children:"Employee Management"}),(0,x.jsx)("p",{className:"overview-description",children:"View and manage employee profiles with KYC assignment statistics."}),(0,x.jsx)("div",{className:"overview-actions",children:(0,x.jsx)("button",{className:"action-btn primary",onClick:()=>te(!0),children:"Add Employee"})})]}),(0,x.jsxs)("div",{className:"employee-stats",children:[(0,x.jsx)("h3",{children:"Employee KYC Progress"}),(0,x.jsx)("div",{className:"employee-stats-grid",children:b.map((e=>{const s=(g||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,l=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,t=s.filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,i=s.filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return(0,x.jsxs)("div",{className:"employee-stat-card",children:[(0,x.jsxs)("div",{className:"employee-info",children:[(0,x.jsx)("h4",{children:e.name}),(0,x.jsxs)("p",{children:[e.designation," - ",e.district]})]}),(0,x.jsxs)("div",{className:"employee-kyc-stats",children:[(0,x.jsxs)("div",{className:"kyc-stat",children:[(0,x.jsx)("span",{className:"stat-number",children:s.length}),(0,x.jsx)("span",{className:"stat-label",children:"Total Assigned"})]}),(0,x.jsxs)("div",{className:"kyc-stat",children:[(0,x.jsx)("span",{className:"stat-number approved",children:a}),(0,x.jsx)("span",{className:"stat-label",children:"Approved"})]}),(0,x.jsxs)("div",{className:"kyc-stat",children:[(0,x.jsx)("span",{className:"stat-number pending",children:l}),(0,x.jsx)("span",{className:"stat-label",children:"Pending"})]}),(0,x.jsxs)("div",{className:"kyc-stat",children:[(0,x.jsx)("span",{className:"stat-number refer-back",children:t}),(0,x.jsx)("span",{className:"stat-label",children:"Refer Back"})]}),(0,x.jsxs)("div",{className:"kyc-stat",children:[(0,x.jsx)("span",{className:"stat-number rejected",children:i}),(0,x.jsx)("span",{className:"stat-label",children:"Rejected"})]})]})]},e.id)}))})]}),(0,x.jsx)(u.A,{data:e.map((e=>{const s=(g||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,l=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length;return{...e,totalAssigned:s.length,approvedKyc:a,pendingKyc:l}})),columns:[{key:"name",label:"Name"},{key:"contactNumber",label:"Contact"},{key:"email",label:"Email"},{key:"state",label:"State"},{key:"district",label:"District"},{key:"totalAssigned",label:"Assigned Farmers"},{key:"approvedKyc",label:"Approved KYC"},{key:"pendingKyc",label:"Pending KYC"}],customActions:[{label:"View",className:"action-btn-small info",onClick:Re},{label:"Edit",className:"action-btn-small primary",onClick:Fe}]})]})})})(),"registration"===a&&(()=>{const e=(()=>{console.log("All registrations:",W);const e=(W||[]).filter((e=>{const s=!ne.role||e.role===ne.role,a=!ne.status||e.status===ne.status;return s&&a}));return console.log("Filtered registrations:",e),e})();return(0,x.jsxs)("div",{className:"registration-section",children:[(0,x.jsxs)("div",{className:"section-header",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h2",{className:"section-title",children:"Registration Management"}),(0,x.jsx)("p",{className:"section-description",children:"Review and manage user registration requests."})]}),(0,x.jsx)("div",{className:"section-actions",children:(0,x.jsxs)("button",{className:"action-btn-small primary",onClick:()=>{console.log("\ud83d\udd04 Manually refreshing data..."),fe()},children:[(0,x.jsx)("i",{className:"fas fa-sync-alt"}),"Refresh Data"]})})]}),(0,x.jsxs)("div",{className:"filters-section",children:[(0,x.jsx)("div",{className:"filter-group",children:(0,x.jsxs)("select",{className:"filter-select",value:ne.role,onChange:e=>ce((s=>({...s,role:e.target.value}))),children:[(0,x.jsx)("option",{value:"",children:"All Roles"}),(0,x.jsx)("option",{value:"FARMER",children:"Farmer"}),(0,x.jsx)("option",{value:"EMPLOYEE",children:"Employee"}),(0,x.jsx)("option",{value:"ADMIN",children:"Admin"})]})}),(0,x.jsx)("div",{className:"filter-group",children:(0,x.jsxs)("select",{className:"filter-select",value:ne.status,onChange:e=>ce((s=>({...s,status:e.target.value}))),children:[(0,x.jsx)("option",{value:"",children:"All Status"}),(0,x.jsx)("option",{value:"PENDING",children:"Pending"}),(0,x.jsx)("option",{value:"APPROVED",children:"Approved"}),(0,x.jsx)("option",{value:"REJECTED",children:"Rejected"})]})})]}),(0,x.jsx)(u.A,{data:e,columns:[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"phoneNumber",label:"Phone"},{key:"role",label:"Role"},{key:"status",label:"Status"}],customActions:[{label:"View",className:"action-btn-small info",onClick:Ee},{label:"Approve",className:"action-btn-small success",onClick:e=>Se(e.id),show:e=>"PENDING"===e.status},{label:"Reject",className:"action-btn-small danger",onClick:e=>Ae(e.id),show:e=>"PENDING"===e.status}]})]})})()]})]})}),S&&(0,x.jsx)(d.A,{farmers:g.filter((e=>!e.assignedEmployee||"Not Assigned"===e.assignedEmployee||null===e.assignedEmployee||void 0===e.assignedEmployee||""===e.assignedEmployee)),employees:b,onClose:()=>A(!1),onAssign:async e=>{try{var s;const t=e.map((e=>e.farmerId)),r=null===(s=e[0])||void 0===s?void 0:s.employeeId;if(!r||0===t.length)return void alert("Please select an employee and at least one farmer");try{await i.Er.bulkAssignFarmers(t,r)}catch(a){console.log("Bulk assign failed, trying individual assignments...");for(const e of t)try{await i.Er.assignFarmer(e,r)}catch(l){console.error(`Failed to assign farmer ${e}:`,l)}}y((s=>s.map((s=>{const a=e.find((e=>e.farmerId===s.id));return a?{...s,assignmentStatus:"ASSIGNED",assignedEmployee:a.employeeName,assignedDate:(new Date).toISOString().split("T")[0]}:s})))),A(!1),alert("Farmers assigned successfully!")}catch(t){console.error("Error assigning farmers:",t),alert("Failed to assign farmers")}}}),P&&K&&(0,x.jsx)(m.A,{farmerData:K,onClose:()=>{F(!1),T(null)}}),Y&&_&&(0,x.jsx)(h.A,{employee:_,onClose:()=>{I(!1),O(null)},onUpdate:e=>{k((s=>s.map((s=>s.id===e.id?e:s)))),I(!1),O(null)}}),B&&V&&(0,x.jsx)(o.A,{farmer:V,onClose:()=>{G(!1),U(null)},onApprove:(e,s)=>{y((s=>s.map((s=>s.id===e?{...s,kycStatus:"APPROVED"}:s)))),G(!1),U(null)},onReject:(e,s,a)=>{y((s=>s.map((s=>s.id===e?{...s,kycStatus:"REJECTED"}:s)))),G(!1),U(null)},onReferBack:(e,s,a)=>{y((s=>s.map((s=>s.id===e?{...s,kycStatus:"REFER_BACK"}:s)))),G(!1),U(null)}}),Z&&se&&(0,x.jsx)(j.A,{registration:se,onClose:()=>{ee(!1),ae(null)},onUpdate:()=>{fe()},onApprove:Se,onReject:Ae})]})}},8756:(e,s,a)=>{a(5043),a(579)}}]);
//# sourceMappingURL=682.b9969a65.chunk.js.map