"use strict";(self.webpackChunkagristack_farmer_management=self.webpackChunkagristack_farmer_management||[]).push([[682],{6682:(e,s,a)=>{a.r(s),a.d(s,{default:()=>y});var t=a(5043),l=a(5016),r=a(476),i=(a(5812),a(6428)),n=a(980),c=a(2383),o=a(9553),d=a(1125),m=a(8022),h=a(2343),p=a(8756),x=a(838),u=a(2064),v=a(8874),j=(a(1953),a(9764)),g=a(579);const y=()=>{const{user:e,logout:s}=(0,l.As)(),[a,y]=(0,t.useState)("overview"),[N,k]=(0,t.useState)([]),[f,b]=(0,t.useState)([]),[C,E]=(0,t.useState)(""),[A,S]=(0,t.useState)(!1),[D,w]=(0,t.useState)(!1),[R,F]=(0,t.useState)(!1),[P,K]=(0,t.useState)(!1),[T,Y]=(0,t.useState)(null),[I,_]=(0,t.useState)(!1),[O,W]=(0,t.useState)(null),[B,M]=(0,t.useState)(!1),[G,U]=(0,t.useState)(null),[V,L]=(0,t.useState)(null),[J,q]=(0,t.useState)(null),[$,H]=(0,t.useState)([]),[Q,z]=(0,t.useState)(!1),[X,Z]=(0,t.useState)(null),[ee,se]=(0,t.useState)(!1),[ae,te]=(0,t.useState)(null),[le,re]=(0,t.useState)(!1),[ie,ne]=(0,t.useState)(!1),[ce,oe]=(0,t.useState)({role:"",status:""}),[de,me]=(0,t.useState)({state:"",district:"",region:"",kycStatus:"",assignmentStatus:"",employeeFilter:""}),[he,pe]=(0,t.useState)(!1);(0,t.useEffect)((()=>{xe();const e=e=>{console.log("\ud83d\udd04 Admin Dashboard: KYC status updated, refreshing data..."),console.log("\ud83d\udcca KYC Update details:",e.detail),setTimeout((()=>{console.log("\ud83d\udd04 Refreshing Admin data after KYC update..."),xe()}),2e3)};return window.addEventListener("kycStatusUpdated",e),()=>{window.removeEventListener("kycStatusUpdated",e)}}),[]);const xe=async()=>{try{console.log("\ud83d\udd0d Admin: Starting to fetch real data from API...");const[e,s,a]=await Promise.all([r.Er.getFarmersWithKyc(),r.Er.getEmployeesWithStats(),r.Dv.getRegistrationList()]);console.log("\u2705 Admin API Response:",{farmersCount:(null===e||void 0===e?void 0:e.length)||0,employeesCount:(null===s||void 0===s?void 0:s.length)||0,registrationsCount:(null===a||void 0===a?void 0:a.length)||0}),k(e||[]),b(s||[]),H(a||[]),console.log("\u2705 Admin: Using real data from APIs"),console.log("- Farmers:",(null===e||void 0===e?void 0:e.length)||0,"records"),console.log("- Employees:",(null===s||void 0===s?void 0:s.length)||0,"records"),console.log("- Registrations:",(null===a||void 0===a?void 0:a.length)||0,"records")}catch(e){console.error("\u274c Admin error fetching data:",e),console.log("\u274c Using fallback endpoints due to API error");try{const[e,s,a]=await Promise.all([r.Er.getAllFarmers(),r.Er.getAllEmployees(),r.Dv.getRegistrationList()]);console.log("\u2705 Fallback API Response:",{farmersCount:(null===e||void 0===e?void 0:e.length)||0,employeesCount:(null===s||void 0===s?void 0:s.length)||0,registrationsCount:(null===a||void 0===a?void 0:a.length)||0}),k(e||[]),b(s||[]),H(a||[])}catch(s){console.error("\u274c Fallback API also failed:",s),k([]),b([]),H([])}}},ue=e=>{te(e),se(!0)},ve=async e=>{try{await r.Dv.approveUser(e,"FARMER"),H((s=>s.map((s=>s.id===e?{...s,status:"APPROVED"}:s)))),alert("Registration approved successfully!")}catch(s){console.error("Error approving registration:",s),alert("Failed to approve registration. Please try again.")}},je=async e=>{try{await r.Dv.rejectUser(e,"Rejected by Admin"),H((s=>s.map((s=>s.id===e?{...s,status:"REJECTED"}:s)))),alert("Registration rejected successfully!")}catch(s){console.error("Error rejecting registration:",s),alert("Failed to reject registration. Please try again.")}},ge=()=>{const e=(null===N||void 0===N?void 0:N.length)||0,s=(null===f||void 0===f?void 0:f.length)||0,a=(N||[]).filter((e=>!e.assignedEmployee||"Not Assigned"===e.assignedEmployee)).length,t=(N||[]).filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,l=(N||[]).filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,r=(N||[]).filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,i=(N||[]).filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return console.log("Admin Stats calculated from real data:"),console.log("- Total Farmers:",e),console.log("- Total Employees:",s),console.log("- Unassigned Farmers:",a),console.log("- Pending KYC:",t),console.log("- Approved KYC:",l),console.log("- Refer Back KYC:",r),console.log("- Rejected KYC:",i),{totalFarmers:e,totalEmployees:s,unassignedFarmers:a,pendingKYC:t,approvedKYC:l,referBackKYC:r,rejectedKYC:i}},ye=e=>{Y(e),K(!0)},Ne=e=>{W(e),_(!0)},ke=e=>{U(e),M(!0)},fe=e=>{L(e),w(!0)},be=e=>{q(e),F(!0)};return(0,g.jsxs)("div",{className:"dashboard",children:[(0,g.jsxs)("div",{className:"top-bar",children:[(0,g.jsxs)("div",{className:"top-bar-left",children:[(0,g.jsxs)("div",{className:"logo-container",children:[(0,g.jsx)("div",{className:"logo-icon","aria-hidden":"true",children:(0,g.jsxs)("svg",{width:"88",height:"48",viewBox:"0 0 88 64",xmlns:"http://www.w3.org/2000/svg",role:"img","aria-label":"Sunflowers logo",children:[(0,g.jsxs)("g",{stroke:"#15803d",strokeWidth:"2",fill:"none",strokeLinecap:"round",children:[(0,g.jsx)("path",{d:"M18 38 C18 46 18 54 18 62"}),(0,g.jsx)("path",{d:"M44 38 C44 46 44 54 44 62"}),(0,g.jsx)("path",{d:"M70 38 C70 46 70 54 70 62"}),(0,g.jsx)("path",{d:"M56 38 C56 47 57 56 57 62",opacity:"0.6"}),(0,g.jsx)("path",{d:"M18 48 C22 46 24 44 26 42"}),(0,g.jsx)("path",{d:"M44 48 C40 46 38 44 36 42"}),(0,g.jsx)("path",{d:"M70 48 C66 46 64 44 62 42"})]}),(0,g.jsxs)("g",{children:[(0,g.jsxs)("g",{transform:"translate(18 26)",children:[(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(30)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(60)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(90)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(120)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(150)"}),(0,g.jsx)("circle",{cx:"0",cy:"0",r:"8",fill:"#8B5E3C",stroke:"#A16207",strokeWidth:"2"})]}),(0,g.jsxs)("g",{transform:"translate(44 24)",children:[(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(45)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(90)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(135)"}),(0,g.jsx)("circle",{cx:"0",cy:"0",r:"8",fill:"#8B5E3C",stroke:"#A16207",strokeWidth:"2"})]}),(0,g.jsxs)("g",{transform:"translate(70 26)",children:[(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(30)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(60)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(90)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(120)"}),(0,g.jsx)("circle",{cx:"0",cy:"0",r:"8",fill:"#8B5E3C",stroke:"#A16207",strokeWidth:"2"})]}),(0,g.jsxs)("g",{transform:"translate(56 20) scale(0.8)",children:[(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(30)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(60)"}),(0,g.jsx)("ellipse",{cx:"0",cy:"0",rx:"5",ry:"10",fill:"#FACC15",stroke:"#D97706",strokeWidth:"2",transform:"rotate(90)"}),(0,g.jsx)("circle",{cx:"0",cy:"0",r:"8",fill:"#8B5E3C",stroke:"#A16207",strokeWidth:"2"})]})]})]})}),(0,g.jsxs)("div",{className:"logo-text",children:[(0,g.jsx)("h1",{className:"logo-title",children:"DATE Digital"}),(0,g.jsx)("p",{className:"logo-subtitle",children:"Agristack Platform"})]})]}),(0,g.jsx)("div",{className:"date-display",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,g.jsxs)("div",{className:"top-bar-right",children:[(0,g.jsx)(v.A,{}),(0,g.jsx)(u.A,{})]})]}),(0,g.jsxs)("aside",{className:"dashboard-sidebar",children:[(0,g.jsx)("div",{className:"sidebar-header",children:(0,g.jsxs)("div",{className:"logo",children:[(0,g.jsx)("div",{className:"logo-text",children:"DATE"}),(0,g.jsx)("div",{className:"logo-subtitle",children:"Admin"})]})}),(0,g.jsxs)("nav",{className:"sidebar-nav",children:[(0,g.jsx)("button",{className:"nav-item "+("overview"===a?"active":""),onClick:()=>y("overview"),children:"\ud83d\udcca Overview"}),(0,g.jsx)("button",{className:"nav-item "+("kyc-overview"===a?"active":""),onClick:()=>y("kyc-overview"),children:"\ud83e\udeaa KYC Overview"}),(0,g.jsx)("button",{className:"nav-item "+("farmers"===a?"active":""),onClick:()=>y("farmers"),children:"\ud83d\udc68\u200d\ud83c\udf3e Farmers"}),(0,g.jsx)("button",{className:"nav-item "+("employees"===a?"active":""),onClick:()=>y("employees"),children:"\ud83d\udc65 Employees"}),(0,g.jsx)("button",{className:"nav-item "+("registration"===a?"active":""),onClick:()=>y("registration"),children:"\ud83d\udcdd Registrations"})]})]}),(0,g.jsx)("main",{className:"dashboard-main",children:(0,g.jsxs)("div",{className:"dashboard-content",children:[(0,g.jsx)("header",{className:"dashboard-header",children:(0,g.jsx)("div",{className:"header-center",children:(0,g.jsxs)("div",{className:"welcome-message",children:[(0,g.jsxs)("h2",{className:"greeting",children:[(()=>{const e=(new Date).getHours();return e>=5&&e<12?"Good Morning":e>=12&&e<17?"Good Afternoon":e>=17&&e<21?"Good Evening":"Good Night"})(),", ",(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.email)||"Admin","! \ud83c\udf8b"]}),(0,g.jsx)("p",{className:"welcome-text",children:"Welcome to DATE Digital Agristack - Manage farmers, employees and registrations efficiently."})]})})}),D?(0,g.jsx)("div",{className:"dashboard-form-container",children:(0,g.jsx)(i.A,{isInDashboard:!0,editData:V,onClose:()=>{w(!1),L(null)},onSubmit:async e=>{try{if(V){const s=await r.xs.updateFarmer(V.id,e);k((e=>e.map((e=>e.id===V.id?s:e)))),alert("Farmer updated successfully!")}else{const s=await r.xs.createFarmer(e);k((e=>[...e,s])),alert("Farmer created successfully!")}w(!1),L(null)}catch(s){console.error("Error saving farmer:",s),alert("Failed to save farmer. Please try again.")}}})}):R?(0,g.jsx)("div",{className:"dashboard-form-container",children:(0,g.jsx)(c.A,{isInDashboard:!0,editData:J,onClose:()=>{F(!1),q(null)},onSubmit:async e=>{try{if(J){const s=await r.s2.updateEmployee(J.id,e);b((e=>e.map((e=>e.id===J.id?s:e)))),alert("Employee updated successfully!")}else{const s=await r.s2.createEmployee(e);b((e=>[...e,s])),alert("Employee created successfully!")}F(!1),q(null)}catch(s){console.error("Error saving employee:",s),alert("Failed to save employee. Please try again.")}}})}):(0,g.jsxs)(g.Fragment,{children:["overview"===a&&(()=>{const e=ge();return(0,g.jsxs)("div",{className:"overview-section",children:[(0,g.jsxs)("div",{className:"overview-header",children:[(0,g.jsx)("h2",{className:"overview-title",children:"Admin Dashboard Overview"}),(0,g.jsx)("p",{className:"overview-description",children:"Manage farmers, employees, and assignments efficiently."})]}),(0,g.jsxs)("div",{className:"stats-grid",children:[(0,g.jsx)(p.A,{title:"FARMERS",value:e.totalFarmers,change:"+12.4%",changeType:"positive",icon:"\ud83d\udc65"}),(0,g.jsx)(p.A,{title:"EMPLOYEES",value:e.totalEmployees,change:"-3.0%",changeType:"negative",icon:"\ud83d\udc68\u200d\ud83d\udcbc"}),(0,g.jsx)(p.A,{title:"FPO",value:"0",change:"+0.0%",changeType:"neutral",icon:"\ud83c\udfe2"})]}),(0,g.jsxs)("div",{className:"bottom-sections",children:[(0,g.jsxs)("div",{className:"section-card",children:[(0,g.jsxs)("div",{className:"section-header",children:[(0,g.jsx)("h3",{children:"Recent Activities"}),(0,g.jsx)("button",{className:"section-link",onClick:()=>console.log("View All clicked"),children:"View All"})]}),(0,g.jsxs)("div",{className:"activities-list",children:[(0,g.jsx)("div",{className:"activity-item",children:(0,g.jsxs)("div",{className:"activity-content",children:[(0,g.jsxs)("div",{className:"activity-text",children:[(0,g.jsx)("span",{className:"activity-dot success"}),"Farmer profile updated"]}),(0,g.jsx)("div",{className:"activity-time",children:"20m ago"}),(0,g.jsx)("button",{className:"activity-badge success",children:"SUCCESS"})]})}),(0,g.jsx)("div",{className:"activity-item",children:(0,g.jsxs)("div",{className:"activity-content",children:[(0,g.jsxs)("div",{className:"activity-text",children:[(0,g.jsx)("span",{className:"activity-dot error"}),"Employee profile updated"]}),(0,g.jsx)("div",{className:"activity-time",children:"10m ago"}),(0,g.jsx)("button",{className:"activity-badge success",children:"SUCCESS"})]})})]})]}),(0,g.jsxs)("div",{className:"section-card",children:[(0,g.jsx)("div",{className:"section-header",children:(0,g.jsx)("h3",{children:"Quick Actions"})}),(0,g.jsxs)("div",{className:"quick-actions-grid",children:[(0,g.jsxs)("button",{className:"quick-action-btn primary",children:[(0,g.jsx)("i",{className:"fas fa-users"}),"View Users"]}),(0,g.jsxs)("button",{className:"quick-action-btn secondary",children:[(0,g.jsx)("i",{className:"fas fa-tractor"}),"View Farmers"]})]})]})]})]})})(),"kyc-overview"===a&&(()=>{const e=ge();return(0,g.jsxs)("div",{className:"overview-section",children:[(0,g.jsxs)("div",{className:"overview-header",children:[(0,g.jsx)("h2",{className:"overview-title",children:"KYC Overview"}),(0,g.jsx)("p",{className:"overview-description",children:"Comprehensive view of KYC status across all farmers and employees."})]}),(0,g.jsxs)("div",{className:"kyc-breakdown",children:[(0,g.jsx)("h3",{children:"KYC Status Breakdown"}),(0,g.jsxs)("div",{className:"kyc-stats-grid",children:[(0,g.jsxs)("div",{className:"kyc-stat-card approved",children:[(0,g.jsx)("span",{className:"kyc-stat-number",children:e.approvedKYC}),(0,g.jsx)("span",{className:"kyc-stat-label",children:"Approved"})]}),(0,g.jsxs)("div",{className:"kyc-stat-card pending",children:[(0,g.jsx)("span",{className:"kyc-stat-number",children:e.pendingKYC}),(0,g.jsx)("span",{className:"kyc-stat-label",children:"Pending"})]}),(0,g.jsxs)("div",{className:"kyc-stat-card refer-back",children:[(0,g.jsx)("span",{className:"kyc-stat-number",children:e.referBackKYC}),(0,g.jsx)("span",{className:"kyc-stat-label",children:"Refer Back"})]}),(0,g.jsxs)("div",{className:"kyc-stat-card rejected",children:[(0,g.jsx)("span",{className:"kyc-stat-number",children:e.rejectedKYC}),(0,g.jsx)("span",{className:"kyc-stat-label",children:"Rejected"})]})]})]}),(0,g.jsxs)("div",{className:"employee-stats",children:[(0,g.jsx)("h3",{children:"Employee KYC Progress"}),(0,g.jsx)("div",{className:"employee-stats-grid",children:f.map((e=>{const s=(N||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,t=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,l=s.filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,r=s.filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return(0,g.jsxs)("div",{className:"employee-stat-card",children:[(0,g.jsxs)("div",{className:"employee-info",children:[(0,g.jsx)("h4",{children:e.name}),(0,g.jsxs)("p",{children:[e.designation," - ",e.district]})]}),(0,g.jsxs)("div",{className:"employee-kyc-stats",children:[(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number",children:s.length}),(0,g.jsx)("span",{className:"stat-label",children:"Total Assigned"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number approved",children:a}),(0,g.jsx)("span",{className:"stat-label",children:"Approved"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number pending",children:t}),(0,g.jsx)("span",{className:"stat-label",children:"Pending"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number refer-back",children:l}),(0,g.jsx)("span",{className:"stat-label",children:"Refer Back"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number rejected",children:r}),(0,g.jsx)("span",{className:"stat-label",children:"Rejected"})]})]})]},e.id)}))})]}),(0,g.jsxs)("div",{className:"kyc-progress-section",children:[(0,g.jsx)("h3",{children:"KYC Progress Overview"}),(0,g.jsxs)("div",{className:"kyc-progress-grid",children:[(0,g.jsxs)("div",{className:"progress-card approved",children:[(0,g.jsx)("div",{className:"progress-circle",children:(0,g.jsx)("div",{className:"progress-number",children:e.approvedKYC})}),(0,g.jsx)("div",{className:"progress-label",children:"Approved KYC"})]}),(0,g.jsxs)("div",{className:"progress-card pending",children:[(0,g.jsx)("div",{className:"progress-circle",children:(0,g.jsx)("div",{className:"progress-number",children:e.pendingKYC})}),(0,g.jsx)("div",{className:"progress-label",children:"Pending KYC"})]}),(0,g.jsxs)("div",{className:"progress-card refer-back",children:[(0,g.jsx)("div",{className:"progress-circle",children:(0,g.jsx)("div",{className:"progress-number",children:e.referBackKYC})}),(0,g.jsx)("div",{className:"progress-label",children:"Refer Back"})]}),(0,g.jsxs)("div",{className:"progress-card rejected",children:[(0,g.jsx)("div",{className:"progress-circle",children:(0,g.jsx)("div",{className:"progress-number",children:e.rejectedKYC})}),(0,g.jsx)("div",{className:"progress-label",children:"Rejected KYC"})]})]})]})]})})(),"farmers"===a&&(()=>{const e=(N||[]).filter((e=>{const s=!de.state||e.state===de.state,a=!de.district||e.district===de.district,t=!de.kycStatus||e.kycStatus===de.kycStatus,l=!de.employeeFilter||e.assignedEmployee===de.employeeFilter;return s&&a&&t&&l}));return(0,g.jsx)("div",{className:"overview-section",children:ie?(0,g.jsxs)("div",{className:"farmer-registration-section",children:[(0,g.jsxs)("div",{className:"section-header",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"section-title",children:"Add New Farmer"}),(0,g.jsx)("p",{className:"section-description",children:"Fill in the farmer details to create a new farmer account."})]}),(0,g.jsx)("div",{className:"section-actions",children:(0,g.jsxs)("button",{className:"action-btn-small secondary",onClick:()=>ne(!1),children:[(0,g.jsx)("i",{className:"fas fa-arrow-left"}),"Back to Farmers"]})})]}),(0,g.jsx)(n.A,{isInDashboard:!0,onClose:()=>ne(!1),onSubmit:async e=>{try{const s=await r.xs.createFarmer(e);k((e=>[...e,s])),alert("Farmer created successfully!"),ne(!1)}catch(s){console.error("Error creating farmer:",s),alert("Failed to create farmer. Please try again.")}}})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"overview-header",children:[(0,g.jsx)("h2",{className:"overview-title",children:"Farmer Management"}),(0,g.jsx)("p",{className:"overview-description",children:"View and manage all farmer profiles with KYC status and assignments."}),(0,g.jsxs)("div",{className:"overview-actions",children:[(0,g.jsx)("button",{className:"action-btn primary",onClick:()=>ne(!0),children:"Add Farmer"}),(0,g.jsx)("button",{className:"action-btn secondary",onClick:()=>S(!0),children:"Assign Farmers"})]})]}),(0,g.jsxs)("div",{className:"filters-section",children:[(0,g.jsxs)("div",{className:"filter-group",children:[(0,g.jsx)("label",{className:"filter-label",children:"State"}),(0,g.jsxs)("select",{value:de.state,onChange:e=>me((s=>({...s,state:e.target.value}))),className:"filter-select",children:[(0,g.jsx)("option",{value:"",children:"All States"}),(0,g.jsx)("option",{value:"Telangana",children:"Telangana"}),(0,g.jsx)("option",{value:"Andhrapradesh",children:"Andhrapradesh"}),(0,g.jsx)("option",{value:"Maharashtra",children:"Maharashtra"}),(0,g.jsx)("option",{value:"Gujarat",children:"Gujarat"}),(0,g.jsx)("option",{value:"Punjab",children:"Punjab"}),(0,g.jsx)("option",{value:"Uttar Pradesh",children:"Uttar Pradesh"}),(0,g.jsx)("option",{value:"Tamil Nadu",children:"Tamil Nadu"})]})]}),(0,g.jsxs)("div",{className:"filter-group",children:[(0,g.jsx)("label",{className:"filter-label",children:"District"}),(0,g.jsxs)("select",{value:de.district,onChange:e=>me((s=>({...s,district:e.target.value}))),className:"filter-select",children:[(0,g.jsx)("option",{value:"",children:"All Districts"}),(0,g.jsx)("option",{value:"Karimnagar",children:"Karimnagar"}),(0,g.jsx)("option",{value:"rangareddy",children:"Rangareddy"}),(0,g.jsx)("option",{value:"kadapa",children:"Kadapa"}),(0,g.jsx)("option",{value:"Kadapa",children:"Kadapa"}),(0,g.jsx)("option",{value:"kadpaa",children:"Kadpaa"}),(0,g.jsx)("option",{value:"Kuppam",children:"Kuppam"}),(0,g.jsx)("option",{value:"Pune",children:"Pune"}),(0,g.jsx)("option",{value:"Ahmedabad",children:"Ahmedabad"}),(0,g.jsx)("option",{value:"Amritsar",children:"Amritsar"}),(0,g.jsx)("option",{value:"Lucknow",children:"Lucknow"}),(0,g.jsx)("option",{value:"Chennai",children:"Chennai"})]})]}),(0,g.jsxs)("div",{className:"filter-group",children:[(0,g.jsx)("label",{className:"filter-label",children:"KYC Status"}),(0,g.jsxs)("select",{value:de.kycStatus,onChange:e=>me((s=>({...s,kycStatus:e.target.value}))),className:"filter-select",children:[(0,g.jsx)("option",{value:"",children:"All KYC Status"}),(0,g.jsx)("option",{value:"APPROVED",children:"Approved"}),(0,g.jsx)("option",{value:"PENDING",children:"Pending"}),(0,g.jsx)("option",{value:"NOT_STARTED",children:"Not Started"}),(0,g.jsx)("option",{value:"REFER_BACK",children:"Refer Back"}),(0,g.jsx)("option",{value:"REJECTED",children:"Rejected"})]})]}),(0,g.jsxs)("div",{className:"filter-group",children:[(0,g.jsx)("label",{className:"filter-label",children:"Assignment Status"}),(0,g.jsxs)("select",{value:de.assignmentStatus,onChange:e=>me((s=>({...s,assignmentStatus:e.target.value}))),className:"filter-select",children:[(0,g.jsx)("option",{value:"",children:"All Assignment Status"}),(0,g.jsx)("option",{value:"ASSIGNED",children:"Assigned"}),(0,g.jsx)("option",{value:"UNASSIGNED",children:"Unassigned"})]})]}),(0,g.jsxs)("div",{className:"filter-group",children:[(0,g.jsx)("label",{className:"filter-label",children:"Assigned Employee"}),(0,g.jsxs)("select",{value:de.employeeFilter,onChange:e=>me((s=>({...s,employeeFilter:e.target.value}))),className:"filter-select",children:[(0,g.jsx)("option",{value:"",children:"All Employees"}),f.map((e=>(0,g.jsx)("option",{value:e.name,children:e.name},e.id)))]})]}),(0,g.jsx)("div",{className:"filter-actions",children:(0,g.jsxs)("button",{className:"filter-btn-clear",onClick:()=>me({state:"",district:"",region:"",kycStatus:"",assignmentStatus:"",employeeFilter:""}),children:[(0,g.jsx)("i",{className:"fas fa-times"}),"Clear Filters"]})})]}),(0,g.jsx)(x.A,{data:e,columns:[{key:"name",label:"Name"},{key:"contactNumber",label:"Phone"},{key:"state",label:"State"},{key:"district",label:"District"},{key:"kycStatus",label:"KYC Status",render:e=>e?"PENDING"===e||"pending"===e?"PENDING":"APPROVED"===e||"approved"===e?"APPROVED":"REFER_BACK"===e||"refer_back"===e?"REFER_BACK":"REJECTED"===e||"rejected"===e?"REJECTED":"NOT_STARTED"===e||"not_started"===e?"NOT_STARTED":e.toUpperCase():"NOT_STARTED"},{key:"assignedEmployee",label:"Assigned Employee"}],customActions:[{label:"View",className:"action-btn-small info",onClick:ye},{label:"Edit",className:"action-btn-small primary",onClick:fe},{label:"KYC",className:"action-btn-small warning",onClick:ke}]})]})})})(),"employees"===a&&(()=>{const e=(f||[]).filter((e=>!de.district||e.district===de.district));return(0,g.jsx)("div",{className:"overview-section",children:le?(0,g.jsxs)("div",{className:"employee-registration-section",children:[(0,g.jsxs)("div",{className:"section-header",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"section-title",children:"Add New Employee"}),(0,g.jsx)("p",{className:"section-description",children:"Fill in the employee details to create a new employee account."})]}),(0,g.jsx)("div",{className:"section-actions",children:(0,g.jsxs)("button",{className:"action-btn-small secondary",onClick:()=>re(!1),children:[(0,g.jsx)("i",{className:"fas fa-arrow-left"}),"Back to Employees"]})})]}),(0,g.jsx)(c.A,{isInDashboard:!0,onClose:()=>re(!1),onSubmit:async e=>{try{const s=await r.s2.createEmployee(e);b((e=>[...e,s])),alert("Employee created successfully!"),re(!1)}catch(s){console.error("Error creating employee:",s),alert("Failed to create employee. Please try again.")}}})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"overview-header",children:[(0,g.jsx)("h2",{className:"overview-title",children:"Employee Management"}),(0,g.jsx)("p",{className:"overview-description",children:"View and manage employee profiles with KYC assignment statistics."}),(0,g.jsx)("div",{className:"overview-actions",children:(0,g.jsx)("button",{className:"action-btn primary",onClick:()=>re(!0),children:"Add Employee"})})]}),(0,g.jsxs)("div",{className:"employee-stats",children:[(0,g.jsx)("h3",{children:"Employee KYC Progress"}),(0,g.jsx)("div",{className:"employee-stats-grid",children:f.map((e=>{const s=(N||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,t=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,l=s.filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,r=s.filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return(0,g.jsxs)("div",{className:"employee-stat-card",children:[(0,g.jsxs)("div",{className:"employee-info",children:[(0,g.jsx)("h4",{children:e.name}),(0,g.jsxs)("p",{children:[e.designation," - ",e.district]})]}),(0,g.jsxs)("div",{className:"employee-kyc-stats",children:[(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number",children:s.length}),(0,g.jsx)("span",{className:"stat-label",children:"Total Assigned"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number approved",children:a}),(0,g.jsx)("span",{className:"stat-label",children:"Approved"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number pending",children:t}),(0,g.jsx)("span",{className:"stat-label",children:"Pending"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number refer-back",children:l}),(0,g.jsx)("span",{className:"stat-label",children:"Refer Back"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number rejected",children:r}),(0,g.jsx)("span",{className:"stat-label",children:"Rejected"})]})]})]},e.id)}))})]}),(0,g.jsx)(x.A,{data:e.map((e=>{const s=(N||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,t=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length;return{...e,totalAssigned:s.length,approvedKyc:a,pendingKyc:t}})),columns:[{key:"name",label:"Name"},{key:"contactNumber",label:"Contact"},{key:"email",label:"Email"},{key:"state",label:"State"},{key:"district",label:"District"},{key:"totalAssigned",label:"Assigned Farmers"},{key:"approvedKyc",label:"Approved KYC"},{key:"pendingKyc",label:"Pending KYC"}],customActions:[{label:"View",className:"action-btn-small info",onClick:Ne},{label:"Edit",className:"action-btn-small primary",onClick:be}]})]})})})(),"registration"===a&&(()=>{const e=(()=>{console.log("All registrations:",$);const e=($||[]).filter((e=>{const s=!ce.role||e.role===ce.role,a=!ce.status||e.status===ce.status;return s&&a}));return console.log("Filtered registrations:",e),e})();return(0,g.jsxs)("div",{className:"registration-section",children:[(0,g.jsxs)("div",{className:"section-header",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"section-title",children:"Registration Management"}),(0,g.jsx)("p",{className:"section-description",children:"Review and manage user registration requests."})]}),(0,g.jsx)("div",{className:"section-actions",children:(0,g.jsxs)("button",{className:"action-btn-small primary",onClick:()=>{console.log("\ud83d\udd04 Manually refreshing data..."),xe()},children:[(0,g.jsx)("i",{className:"fas fa-sync-alt"}),"Refresh Data"]})})]}),(0,g.jsxs)("div",{className:"filters-section",children:[(0,g.jsx)("div",{className:"filter-group",children:(0,g.jsxs)("select",{className:"filter-select",value:ce.role,onChange:e=>oe((s=>({...s,role:e.target.value}))),children:[(0,g.jsx)("option",{value:"",children:"All Roles"}),(0,g.jsx)("option",{value:"FARMER",children:"Farmer"}),(0,g.jsx)("option",{value:"EMPLOYEE",children:"Employee"}),(0,g.jsx)("option",{value:"ADMIN",children:"Admin"})]})}),(0,g.jsx)("div",{className:"filter-group",children:(0,g.jsxs)("select",{className:"filter-select",value:ce.status,onChange:e=>oe((s=>({...s,status:e.target.value}))),children:[(0,g.jsx)("option",{value:"",children:"All Status"}),(0,g.jsx)("option",{value:"PENDING",children:"Pending"}),(0,g.jsx)("option",{value:"APPROVED",children:"Approved"}),(0,g.jsx)("option",{value:"REJECTED",children:"Rejected"})]})})]}),(0,g.jsx)(x.A,{data:e,columns:[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"phoneNumber",label:"Phone"},{key:"role",label:"Role"},{key:"status",label:"Status"}],customActions:[{label:"View",className:"action-btn-small info",onClick:ue},{label:"Approve",className:"action-btn-small success",onClick:e=>ve(e.id),show:e=>"PENDING"===e.status},{label:"Reject",className:"action-btn-small danger",onClick:e=>je(e.id),show:e=>"PENDING"===e.status}]})]})})()]})]})}),A&&(0,g.jsx)(o.A,{farmers:N.filter((e=>!e.assignedEmployee||"Not Assigned"===e.assignedEmployee||null===e.assignedEmployee||void 0===e.assignedEmployee||""===e.assignedEmployee)),employees:f,onClose:()=>S(!1),onAssign:async e=>{try{var s;const l=e.map((e=>e.farmerId)),i=null===(s=e[0])||void 0===s?void 0:s.employeeId;if(!i||0===l.length)return void alert("Please select an employee and at least one farmer");try{await r.Er.bulkAssignFarmers(l,i)}catch(a){console.log("Bulk assign failed, trying individual assignments...");for(const e of l)try{await r.Er.assignFarmer(e,i)}catch(t){console.error(`Failed to assign farmer ${e}:`,t)}}k((s=>s.map((s=>{const a=e.find((e=>e.farmerId===s.id));return a?{...s,assignmentStatus:"ASSIGNED",assignedEmployee:a.employeeName,assignedDate:(new Date).toISOString().split("T")[0]}:s})))),S(!1),alert("Farmers assigned successfully!")}catch(l){console.error("Error assigning farmers:",l),alert("Failed to assign farmers")}}}),P&&T&&(0,g.jsx)(m.A,{farmerData:T,onClose:()=>{K(!1),Y(null)}}),I&&O&&(0,g.jsx)(h.A,{employee:O,onClose:()=>{_(!1),W(null)},onUpdate:e=>{b((s=>s.map((s=>s.id===e.id?e:s)))),_(!1),W(null)}}),B&&G&&(0,g.jsx)(d.A,{farmer:G,onClose:()=>{M(!1),U(null)},onApprove:(e,s)=>{k((s=>s.map((s=>s.id===e?{...s,kycStatus:"APPROVED"}:s)))),M(!1),U(null)},onReject:(e,s,a)=>{k((s=>s.map((s=>s.id===e?{...s,kycStatus:"REJECTED"}:s)))),M(!1),U(null)},onReferBack:(e,s,a)=>{k((s=>s.map((s=>s.id===e?{...s,kycStatus:"REFER_BACK"}:s)))),M(!1),U(null)}}),ee&&ae&&(0,g.jsx)(j.A,{registration:ae,onClose:()=>{se(!1),te(null)},onUpdate:()=>{xe()},onApprove:ve,onReject:je})]})}},8756:(e,s,a)=>{a.d(s,{A:()=>l});a(5043);var t=a(579);const l=e=>{let{title:s,value:a,icon:l,color:r="blue"}=e;return(0,t.jsxs)("div",{className:`stats-card-component ${r}`,children:[(0,t.jsx)("div",{className:"stats-card-icon",children:l}),(0,t.jsxs)("div",{className:"stats-card-content",children:[(0,t.jsx)("h3",{className:"stats-card-title",children:s}),(0,t.jsx)("p",{className:"stats-card-value",children:a})]})]})}}}]);
//# sourceMappingURL=682.c13a655d.chunk.js.map