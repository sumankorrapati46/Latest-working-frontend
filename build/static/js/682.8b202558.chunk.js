"use strict";(self.webpackChunkagristack_farmer_management=self.webpackChunkagristack_farmer_management||[]).push([[682],{6682:(e,s,a)=>{a.r(s),a.d(s,{default:()=>y});var l=a(5043),t=a(5016),i=a(476),n=(a(5812),a(6428)),r=a(980),c=a(2383),d=a(9553),o=a(1125),m=a(8022),h=a(2343),u=(a(8756),a(838)),v=a(2064),p=a(8874),j=(a(1953),a(9764)),x=a(7105),N=a(4801),g=a(579);const y=()=>{const{user:e,logout:s}=(0,t.As)(),[a,y]=(0,l.useState)("overview"),[b,k]=(0,l.useState)([]),[f,E]=(0,l.useState)([]),[S,A]=(0,l.useState)(""),[C,w]=(0,l.useState)(!1),[R,D]=(0,l.useState)(!1),[P,F]=(0,l.useState)(!1),[K,T]=(0,l.useState)(!1),[Y,I]=(0,l.useState)(null),[O,_]=(0,l.useState)(!1),[B,G]=(0,l.useState)(null),[U,V]=(0,l.useState)(!1),[M,J]=(0,l.useState)(null),[q,L]=(0,l.useState)(null),[W,$]=(0,l.useState)(null),[H,Q]=(0,l.useState)([]),[z,X]=(0,l.useState)(!1),[Z,ee]=(0,l.useState)(null),[se,ae]=(0,l.useState)(!1),[le,te]=(0,l.useState)(null),[ie,ne]=(0,l.useState)(!1),[re,ce]=(0,l.useState)(!1),[de,oe]=(0,l.useState)({role:"",status:""}),[me,he]=(0,l.useState)({state:"",district:"",region:"",kycStatus:"",assignmentStatus:"",employeeFilter:""}),[ue,ve]=(0,l.useState)(!1),[pe,je]=(0,l.useState)(!1),[xe,Ne]=(0,l.useState)(!1),[ge,ye]=(0,l.useState)(null),[be,ke]=(0,l.useState)(null),[fe,Ee]=(0,l.useState)(!1),[Se,Ae]=(0,l.useState)(!1),[Ce,we]=(0,l.useState)(!1),[Re,De]=(0,l.useState)(null);(0,l.useEffect)((()=>{Pe();const e=e=>{console.log("\ud83d\udd04 Admin Dashboard: KYC status updated, refreshing data..."),console.log("\ud83d\udcca KYC Update details:",e.detail),setTimeout((()=>{console.log("\ud83d\udd04 Refreshing Admin data after KYC update..."),Pe()}),2e3)};return window.addEventListener("kycStatusUpdated",e),()=>{window.removeEventListener("kycStatusUpdated",e)}}),[]);const Pe=async()=>{try{console.log("\ud83d\udd0d Admin: Starting to fetch real data from API...");const[e,s,a]=await Promise.all([i.Er.getFarmersWithKyc(),i.Er.getEmployeesWithStats(),i.Dv.getRegistrationList()]);console.log("\u2705 Admin API Response:",{farmersCount:(null===e||void 0===e?void 0:e.length)||0,employeesCount:(null===s||void 0===s?void 0:s.length)||0,registrationsCount:(null===a||void 0===a?void 0:a.length)||0}),k(e||[]),E(s||[]),Q(a||[]),console.log("\u2705 Admin: Using real data from APIs"),console.log("- Farmers:",(null===e||void 0===e?void 0:e.length)||0,"records"),console.log("- Employees:",(null===s||void 0===s?void 0:s.length)||0,"records"),console.log("- Registrations:",(null===a||void 0===a?void 0:a.length)||0,"records")}catch(e){console.error("\u274c Admin error fetching data:",e),console.log("\u274c Using fallback endpoints due to API error");try{const[e,s,a]=await Promise.all([i.Er.getAllFarmers(),i.Er.getAllEmployees(),i.Dv.getRegistrationList()]);console.log("\u2705 Fallback API Response:",{farmersCount:(null===e||void 0===e?void 0:e.length)||0,employeesCount:(null===s||void 0===s?void 0:s.length)||0,registrationsCount:(null===a||void 0===a?void 0:a.length)||0}),k(e||[]),E(s||[]),Q(a||[])}catch(s){console.error("\u274c Fallback API also failed:",s),k([]),E([]),Q([])}}},Fe=e=>{te(e),ae(!0)},Ke=async e=>{try{await i.Dv.approveUser(e,"FARMER"),Q((s=>s.map((s=>s.id===e?{...s,status:"APPROVED"}:s)))),alert("Registration approved successfully!")}catch(s){console.error("Error approving registration:",s),alert("Failed to approve registration. Please try again.")}},Te=async e=>{try{await i.Dv.rejectUser(e,"Rejected by Admin"),Q((s=>s.map((s=>s.id===e?{...s,status:"REJECTED"}:s)))),alert("Registration rejected successfully!")}catch(s){console.error("Error rejecting registration:",s),alert("Failed to reject registration. Please try again.")}},Ye=()=>{const e=(null===b||void 0===b?void 0:b.length)||0,s=(null===f||void 0===f?void 0:f.length)||0,a=(b||[]).filter((e=>!e.assignedEmployee||"Not Assigned"===e.assignedEmployee)).length,l=(b||[]).filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,t=(b||[]).filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,i=(b||[]).filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,n=(b||[]).filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return console.log("Admin Stats calculated from real data:"),console.log("- Total Farmers:",e),console.log("- Total Employees:",s),console.log("- Unassigned Farmers:",a),console.log("- Pending KYC:",l),console.log("- Approved KYC:",t),console.log("- Refer Back KYC:",i),console.log("- Rejected KYC:",n),{totalFarmers:e,totalEmployees:s,unassignedFarmers:a,pendingKYC:l,approvedKYC:t,referBackKYC:i,rejectedKYC:n}},Ie=e=>{I(e),T(!0)},Oe=e=>{G(e),_(!0)},_e=e=>{J(e),V(!0)},Be=e=>{L(e),D(!0)},Ge=e=>{$(e),F(!0)},Ue=()=>{D(!0),y("overview")},Ve=()=>{je(!0),ye(null),y("overview")},Me=()=>{F(!0),y("overview")},Je=()=>{Ne(!0),ke(null),y("overview")},qe=()=>{w(!0),y("overview")},Le=()=>{Ee(!0),y("overview")};return(0,g.jsxs)("div",{className:"dashboard",children:[(0,g.jsxs)("div",{className:"top-bar",children:[(0,g.jsxs)("div",{className:"top-bar-left",children:[(0,g.jsx)("div",{className:"logo-container",children:(0,g.jsxs)("div",{className:"logo-text",children:[(0,g.jsx)("h1",{className:"logo-title",children:"DATE"}),(0,g.jsx)("p",{className:"logo-subtitle",children:"Digital Agristack Transaction Enterprises"})]})}),(0,g.jsx)("div",{className:"date-display",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,g.jsxs)("div",{className:"top-bar-right",children:[(0,g.jsx)(p.A,{}),(0,g.jsx)(v.A,{onShowChangePassword:()=>Ae(!0),onShowChangeUserId:()=>we(!0)})]})]}),(0,g.jsxs)("aside",{className:"dashboard-sidebar",children:[(0,g.jsx)("div",{className:"sidebar-header",children:(0,g.jsxs)("div",{className:"logo",children:[(0,g.jsx)("div",{className:"logo-text",children:"Welcome !!!"}),(0,g.jsx)("div",{className:"logo-subtitle",children:"Admin"})]})}),(0,g.jsxs)("nav",{className:"sidebar-nav",children:[(0,g.jsx)("button",{className:"nav-item "+("overview"===a?"active":""),onClick:()=>y("overview"),children:"\ud83d\udcca Overview"}),(0,g.jsx)("button",{className:"nav-item "+("kyc-overview"===a?"active":""),onClick:()=>y("kyc-overview"),children:"\ud83e\udeaa KYC Overview"}),(0,g.jsx)("button",{className:"nav-item "+("farmers"===a?"active":""),onClick:()=>y("farmers"),children:"\ud83d\udc68\u200d\ud83c\udf3e Farmers"}),(0,g.jsx)("button",{className:"nav-item "+("employees"===a?"active":""),onClick:()=>y("employees"),children:"\ud83d\udc65 Employees"}),(0,g.jsx)("button",{className:"nav-item "+("registration"===a?"active":""),onClick:()=>y("registration"),children:"\ud83d\udcdd Registrations"})]})]}),(0,g.jsx)("main",{className:"dashboard-main",children:(0,g.jsxs)("div",{className:"dashboard-content",children:["overview"===a&&(0,g.jsx)("header",{className:"dashboard-header",children:(0,g.jsx)("div",{className:"header-center",children:(0,g.jsxs)("div",{className:"welcome-message",children:[(0,g.jsxs)("h2",{className:"greeting",children:[(()=>{const e=(new Date).getHours();return e>=5&&e<12?"Good Morning":e>=12&&e<17?"Good Afternoon":e>=17&&e<21?"Good Evening":"Good Night"})(),", ",(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.email)||"Admin","! \ud83c\udf8b"]}),(0,g.jsx)("p",{className:"welcome-text",children:"Welcome to DATE Digital Agristack - Manage farmers, employees and registrations efficiently."})]})})}),R?(0,g.jsx)("div",{className:"dashboard-form-container",children:(0,g.jsx)(n.A,{isInDashboard:!0,editData:q,onClose:()=>{D(!1),L(null)},onSubmit:async e=>{try{if(q){const s=await i.xs.updateFarmer(q.id,e);k((e=>e.map((e=>e.id===q.id?s:e)))),alert("Farmer updated successfully!")}else{const s=await i.xs.createFarmer(e);k((e=>[...e,s])),alert("Farmer created successfully!")}D(!1),L(null)}catch(s){console.error("Error saving farmer:",s),alert("Failed to save farmer. Please try again.")}}})}):P?(0,g.jsx)("div",{className:"dashboard-form-container",children:(0,g.jsx)(c.A,{isInDashboard:!0,editData:W,onClose:()=>{F(!1),$(null)},onSubmit:async e=>{try{if(W){const s=await i.s2.updateEmployee(W.id,e);E((e=>e.map((e=>e.id===W.id?s:e)))),alert("Employee updated successfully!")}else{const s=await i.s2.createEmployee(e);E((e=>[...e,s])),alert("Employee created successfully!")}F(!1),$(null)}catch(s){console.error("Error saving employee:",s),alert("Failed to save employee. Please try again.")}}})}):pe?(0,g.jsx)("div",{className:"dashboard-form-container",children:(0,g.jsx)(m.A,{isInDashboard:!0,farmerData:ge||b,onClose:()=>{ge?ye(null):je(!1)},onFarmerSelect:e=>{ye(e)}})}):xe?(0,g.jsx)("div",{className:"dashboard-form-container",children:(0,g.jsx)(h.A,{isInDashboard:!0,employeeData:be||f,onClose:()=>{be?ke(null):Ne(!1)},onEmployeeSelect:e=>{ke(e)}})}):Se?(0,g.jsx)("div",{className:"dashboard-form-container",children:(0,g.jsx)(x.A,{isOpen:!0,onClose:()=>Ae(!1),onSuccess:()=>{De({type:"success",message:"Password changed successfully!"}),Ae(!1)},isInDashboard:!0})}):Ce?(0,g.jsx)("div",{className:"dashboard-form-container",children:(0,g.jsx)(N.A,{isOpen:!0,onClose:()=>we(!1),onSuccess:()=>{De({type:"success",message:"User ID changed successfully!"}),we(!1)},isInDashboard:!0})}):fe?(0,g.jsx)("div",{className:"dashboard-form-container",children:(0,g.jsxs)("div",{className:"view-farmer-dashboard",children:[(0,g.jsx)("div",{className:"dashboard-header",children:(0,g.jsxs)("div",{className:"header-content",children:[(0,g.jsxs)("div",{className:"header-text",children:[(0,g.jsx)("h1",{className:"dashboard-title",children:"Pending KYC"}),(0,g.jsx)("p",{className:"dashboard-subtitle",children:"Review and manage pending KYC applications"})]}),(0,g.jsxs)("button",{className:"back-button",onClick:()=>{Ee(!1)},children:[(0,g.jsx)("i",{className:"fas fa-arrow-left"}),"Back"]})]})}),(0,g.jsx)("div",{className:"dashboard-content",children:(0,g.jsx)("div",{className:"farmers-table-container",children:(0,g.jsxs)("table",{className:"farmers-table",children:[(0,g.jsx)("thead",{className:"table-header",children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{children:"Name"}),(0,g.jsx)("th",{children:"Phone"}),(0,g.jsx)("th",{children:"State"}),(0,g.jsx)("th",{children:"District"}),(0,g.jsx)("th",{children:"KYC Status"}),(0,g.jsx)("th",{children:"Actions"})]})}),(0,g.jsx)("tbody",{className:"table-body",children:b.filter((e=>"PENDING"===e.kycStatus)).map((e=>(0,g.jsxs)("tr",{className:"table-row",children:[(0,g.jsx)("td",{className:"table-cell",children:e.name}),(0,g.jsx)("td",{className:"table-cell",children:e.phone}),(0,g.jsx)("td",{className:"table-cell",children:e.state}),(0,g.jsx)("td",{className:"table-cell",children:e.district}),(0,g.jsx)("td",{className:"table-cell",children:(0,g.jsx)("span",{className:"status-badge pending",children:"PENDING"})}),(0,g.jsx)("td",{className:"table-cell",children:(0,g.jsx)("button",{className:"action-btn small",onClick:()=>_e(e),children:"Review KYC"})})]},e.id)))})]})})})]})}):(0,g.jsxs)(g.Fragment,{children:["overview"===a&&(()=>{const e=Ye();return(0,g.jsxs)("div",{className:"overview-section",children:[(0,g.jsxs)("div",{className:"overview-header",children:[(0,g.jsx)("h2",{className:"overview-title",children:"Admin Dashboard Overview"}),(0,g.jsx)("p",{className:"overview-description",children:"Manage farmers, employees, and assignments efficiently."})]}),(0,g.jsxs)("div",{className:"stats-grid admin-stats-grid",children:[(0,g.jsxs)("div",{className:"stats-card assigned",children:[(0,g.jsx)("h3",{className:"stats-title",children:"Farmers"}),(0,g.jsx)("div",{className:"stats-number",children:e.totalFarmers})]}),(0,g.jsxs)("div",{className:"stats-card approved",children:[(0,g.jsx)("h3",{className:"stats-title",children:"Employees"}),(0,g.jsx)("div",{className:"stats-number",children:e.totalEmployees})]}),(0,g.jsxs)("div",{className:"stats-card refer",children:[(0,g.jsx)("h3",{className:"stats-title",children:"FPO"}),(0,g.jsx)("div",{className:"stats-number",children:"0"})]})]}),(0,g.jsxs)("div",{className:"bottom-sections",children:[(0,g.jsxs)("div",{className:"section-card",children:[(0,g.jsxs)("div",{className:"section-header",children:[(0,g.jsx)("h3",{children:"Recent Activities"}),(0,g.jsx)("button",{className:"section-link",onClick:()=>console.log("View All clicked"),children:"View All"})]}),(0,g.jsxs)("div",{className:"activities-list",children:[(0,g.jsxs)("div",{className:"activity-item success",children:[(0,g.jsx)("div",{className:"activity-icon",children:"\ud83d\udc64"}),(0,g.jsxs)("div",{className:"activity-content",children:[(0,g.jsx)("div",{className:"activity-text",children:"Farmer profile updated"}),(0,g.jsx)("div",{className:"activity-time",children:"20m ago"}),(0,g.jsx)("button",{className:"activity-badge success",children:"SUCCESS"})]})]}),(0,g.jsxs)("div",{className:"activity-item success",children:[(0,g.jsx)("div",{className:"activity-icon",children:"\ud83d\udc68\u200d\ud83d\udcbc"}),(0,g.jsxs)("div",{className:"activity-content",children:[(0,g.jsx)("div",{className:"activity-text",children:"Employee profile updated"}),(0,g.jsx)("div",{className:"activity-time",children:"10m ago"}),(0,g.jsx)("button",{className:"activity-badge success",children:"SUCCESS"})]})]}),(0,g.jsxs)("div",{className:"activity-item pending",children:[(0,g.jsx)("div",{className:"activity-icon",children:"\ud83d\udccb"}),(0,g.jsxs)("div",{className:"activity-content",children:[(0,g.jsx)("div",{className:"activity-text",children:"New registration pending approval"}),(0,g.jsx)("div",{className:"activity-time",children:"5m ago"}),(0,g.jsx)("button",{className:"activity-badge pending",children:"PENDING"})]})]})]})]}),(0,g.jsxs)("div",{className:"section-card",children:[(0,g.jsx)("div",{className:"section-header",children:(0,g.jsx)("h3",{children:"Quick Actions"})}),(0,g.jsxs)("div",{className:"quick-actions-grid",children:[(0,g.jsxs)("button",{className:"quick-action-btn primary",onClick:Ue,children:[(0,g.jsx)("i",{className:"fas fa-user-plus"}),"Add Farmer"]}),(0,g.jsxs)("button",{className:"quick-action-btn secondary",onClick:Ve,children:[(0,g.jsx)("i",{className:"fas fa-users"}),"View Farmers"]}),(0,g.jsxs)("button",{className:"quick-action-btn primary",onClick:Me,children:[(0,g.jsx)("i",{className:"fas fa-user-tie"}),"Add Employee"]}),(0,g.jsxs)("button",{className:"quick-action-btn secondary",onClick:Je,children:[(0,g.jsx)("i",{className:"fas fa-user-tie"}),"View Employee"]}),(0,g.jsxs)("button",{className:"quick-action-btn primary",onClick:qe,children:[(0,g.jsx)("i",{className:"fas fa-link"}),"Assign Farmers"]}),(0,g.jsxs)("button",{className:"quick-action-btn secondary",onClick:Le,children:[(0,g.jsx)("i",{className:"fas fa-clock"}),"Pending KYC"]})]})]})]})]})})(),"kyc-overview"===a&&(()=>{const e=Ye();return(0,g.jsxs)("div",{className:"overview-section",children:[(0,g.jsxs)("div",{className:"overview-header",children:[(0,g.jsx)("h2",{className:"overview-title",children:"KYC Overview"}),(0,g.jsx)("p",{className:"overview-description",children:"Comprehensive view of KYC status across all farmers and employees."})]}),(0,g.jsxs)("div",{className:"kyc-breakdown",children:[(0,g.jsx)("h3",{children:"KYC Status Breakdown"}),(0,g.jsxs)("div",{className:"kyc-stats-grid",children:[(0,g.jsxs)("div",{className:"kyc-stat-card approved",children:[(0,g.jsx)("span",{className:"kyc-stat-number",children:e.approvedKYC}),(0,g.jsx)("span",{className:"kyc-stat-label",children:"Approved"})]}),(0,g.jsxs)("div",{className:"kyc-stat-card pending",children:[(0,g.jsx)("span",{className:"kyc-stat-number",children:e.pendingKYC}),(0,g.jsx)("span",{className:"kyc-stat-label",children:"Pending"})]}),(0,g.jsxs)("div",{className:"kyc-stat-card refer-back",children:[(0,g.jsx)("span",{className:"kyc-stat-number",children:e.referBackKYC}),(0,g.jsx)("span",{className:"kyc-stat-label",children:"Refer Back"})]}),(0,g.jsxs)("div",{className:"kyc-stat-card rejected",children:[(0,g.jsx)("span",{className:"kyc-stat-number",children:e.rejectedKYC}),(0,g.jsx)("span",{className:"kyc-stat-label",children:"Rejected"})]})]})]}),(0,g.jsxs)("div",{className:"employee-stats",children:[(0,g.jsx)("h3",{children:"Employee KYC Progress"}),(0,g.jsx)("div",{className:"employee-stats-grid",children:f.map((e=>{const s=(b||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,l=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,t=s.filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,i=s.filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return(0,g.jsxs)("div",{className:"employee-stat-card",children:[(0,g.jsxs)("div",{className:"employee-info",children:[(0,g.jsx)("h4",{children:e.name}),(0,g.jsxs)("p",{children:[e.designation," - ",e.district]})]}),(0,g.jsxs)("div",{className:"employee-kyc-stats",children:[(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number",children:s.length}),(0,g.jsx)("span",{className:"stat-label",children:"Total Assigned"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number approved",children:a}),(0,g.jsx)("span",{className:"stat-label",children:"Approved"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number pending",children:l}),(0,g.jsx)("span",{className:"stat-label",children:"Pending"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number refer-back",children:t}),(0,g.jsx)("span",{className:"stat-label",children:"Refer Back"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number rejected",children:i}),(0,g.jsx)("span",{className:"stat-label",children:"Rejected"})]})]})]},e.id)}))})]}),(0,g.jsxs)("div",{className:"kyc-progress-section",children:[(0,g.jsx)("h3",{children:"KYC Progress Overview"}),(0,g.jsxs)("div",{className:"kyc-progress-grid",children:[(0,g.jsxs)("div",{className:"progress-card approved",children:[(0,g.jsx)("div",{className:"progress-circle",children:(0,g.jsx)("div",{className:"progress-number",children:e.approvedKYC})}),(0,g.jsx)("div",{className:"progress-label",children:"Approved KYC"})]}),(0,g.jsxs)("div",{className:"progress-card pending",children:[(0,g.jsx)("div",{className:"progress-circle",children:(0,g.jsx)("div",{className:"progress-number",children:e.pendingKYC})}),(0,g.jsx)("div",{className:"progress-label",children:"Pending KYC"})]}),(0,g.jsxs)("div",{className:"progress-card refer-back",children:[(0,g.jsx)("div",{className:"progress-circle",children:(0,g.jsx)("div",{className:"progress-number",children:e.referBackKYC})}),(0,g.jsx)("div",{className:"progress-label",children:"Refer Back"})]}),(0,g.jsxs)("div",{className:"progress-card rejected",children:[(0,g.jsx)("div",{className:"progress-circle",children:(0,g.jsx)("div",{className:"progress-number",children:e.rejectedKYC})}),(0,g.jsx)("div",{className:"progress-label",children:"Rejected KYC"})]})]})]})]})})(),"farmers"===a&&(()=>{const e=(b||[]).filter((e=>{const s=!me.state||e.state===me.state,a=!me.district||e.district===me.district,l=!me.kycStatus||e.kycStatus===me.kycStatus,t=!me.employeeFilter||e.assignedEmployee===me.employeeFilter;return s&&a&&l&&t}));return(0,g.jsx)("div",{className:"overview-section",children:re?(0,g.jsxs)("div",{className:"farmer-registration-section",children:[(0,g.jsxs)("div",{className:"section-header",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"section-title",children:"Add New Farmer"}),(0,g.jsx)("p",{className:"section-description",children:"Fill in the farmer details to create a new farmer account."})]}),(0,g.jsx)("div",{className:"section-actions",children:(0,g.jsxs)("button",{className:"action-btn-small secondary",onClick:()=>ce(!1),children:[(0,g.jsx)("i",{className:"fas fa-arrow-left"}),"Back to Farmers"]})})]}),(0,g.jsx)(r.A,{isInDashboard:!0,onClose:()=>ce(!1),onSubmit:async e=>{try{const s=await i.xs.createFarmer(e);k((e=>[...e,s])),alert("Farmer created successfully!"),ce(!1)}catch(s){console.error("Error creating farmer:",s),alert("Failed to create farmer. Please try again.")}}})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"overview-header",children:[(0,g.jsx)("h2",{className:"overview-title",children:"Farmer Management"}),(0,g.jsx)("p",{className:"overview-description",children:"View and manage all farmer profiles with KYC status and assignments."}),(0,g.jsxs)("div",{className:"overview-actions",children:[(0,g.jsx)("button",{className:"action-btn primary",onClick:()=>ce(!0),children:"Add Farmer"}),(0,g.jsx)("button",{className:"action-btn secondary",onClick:()=>w(!0),children:"Assign Farmers"})]})]}),(0,g.jsxs)("div",{className:"filters-section",children:[(0,g.jsxs)("div",{className:"filter-group",children:[(0,g.jsx)("label",{className:"filter-label",children:"State"}),(0,g.jsxs)("select",{value:me.state,onChange:e=>he((s=>({...s,state:e.target.value}))),className:"filter-select",children:[(0,g.jsx)("option",{value:"",children:"All States"}),(0,g.jsx)("option",{value:"Telangana",children:"Telangana"}),(0,g.jsx)("option",{value:"Andhrapradesh",children:"Andhrapradesh"}),(0,g.jsx)("option",{value:"Maharashtra",children:"Maharashtra"}),(0,g.jsx)("option",{value:"Gujarat",children:"Gujarat"}),(0,g.jsx)("option",{value:"Punjab",children:"Punjab"}),(0,g.jsx)("option",{value:"Uttar Pradesh",children:"Uttar Pradesh"}),(0,g.jsx)("option",{value:"Tamil Nadu",children:"Tamil Nadu"})]})]}),(0,g.jsxs)("div",{className:"filter-group",children:[(0,g.jsx)("label",{className:"filter-label",children:"District"}),(0,g.jsxs)("select",{value:me.district,onChange:e=>he((s=>({...s,district:e.target.value}))),className:"filter-select",children:[(0,g.jsx)("option",{value:"",children:"All Districts"}),(0,g.jsx)("option",{value:"Karimnagar",children:"Karimnagar"}),(0,g.jsx)("option",{value:"rangareddy",children:"Rangareddy"}),(0,g.jsx)("option",{value:"kadapa",children:"Kadapa"}),(0,g.jsx)("option",{value:"Kadapa",children:"Kadapa"}),(0,g.jsx)("option",{value:"kadpaa",children:"Kadpaa"}),(0,g.jsx)("option",{value:"Kuppam",children:"Kuppam"}),(0,g.jsx)("option",{value:"Pune",children:"Pune"}),(0,g.jsx)("option",{value:"Ahmedabad",children:"Ahmedabad"}),(0,g.jsx)("option",{value:"Amritsar",children:"Amritsar"}),(0,g.jsx)("option",{value:"Lucknow",children:"Lucknow"}),(0,g.jsx)("option",{value:"Chennai",children:"Chennai"})]})]}),(0,g.jsxs)("div",{className:"filter-group",children:[(0,g.jsx)("label",{className:"filter-label",children:"KYC Status"}),(0,g.jsxs)("select",{value:me.kycStatus,onChange:e=>he((s=>({...s,kycStatus:e.target.value}))),className:"filter-select",children:[(0,g.jsx)("option",{value:"",children:"All KYC Status"}),(0,g.jsx)("option",{value:"APPROVED",children:"Approved"}),(0,g.jsx)("option",{value:"PENDING",children:"Pending"}),(0,g.jsx)("option",{value:"NOT_STARTED",children:"Not Started"}),(0,g.jsx)("option",{value:"REFER_BACK",children:"Refer Back"}),(0,g.jsx)("option",{value:"REJECTED",children:"Rejected"})]})]}),(0,g.jsxs)("div",{className:"filter-group",children:[(0,g.jsx)("label",{className:"filter-label",children:"Assignment Status"}),(0,g.jsxs)("select",{value:me.assignmentStatus,onChange:e=>he((s=>({...s,assignmentStatus:e.target.value}))),className:"filter-select",children:[(0,g.jsx)("option",{value:"",children:"All Assignment Status"}),(0,g.jsx)("option",{value:"ASSIGNED",children:"Assigned"}),(0,g.jsx)("option",{value:"UNASSIGNED",children:"Unassigned"})]})]}),(0,g.jsxs)("div",{className:"filter-group",children:[(0,g.jsx)("label",{className:"filter-label",children:"Assigned Employee"}),(0,g.jsxs)("select",{value:me.employeeFilter,onChange:e=>he((s=>({...s,employeeFilter:e.target.value}))),className:"filter-select",children:[(0,g.jsx)("option",{value:"",children:"All Employees"}),f.map((e=>(0,g.jsx)("option",{value:e.name,children:e.name},e.id)))]})]}),(0,g.jsx)("div",{className:"filter-actions",children:(0,g.jsxs)("button",{className:"filter-btn-clear",onClick:()=>he({state:"",district:"",region:"",kycStatus:"",assignmentStatus:"",employeeFilter:""}),children:[(0,g.jsx)("i",{className:"fas fa-times"}),"Clear Filters"]})})]}),(0,g.jsx)(u.A,{data:e,columns:[{key:"name",label:"Name"},{key:"contactNumber",label:"Phone"},{key:"state",label:"State"},{key:"district",label:"District"},{key:"kycStatus",label:"KYC Status",render:e=>e?"PENDING"===e||"pending"===e?"PENDING":"APPROVED"===e||"approved"===e?"APPROVED":"REFER_BACK"===e||"refer_back"===e?"REFER_BACK":"REJECTED"===e||"rejected"===e?"REJECTED":"NOT_STARTED"===e||"not_started"===e?"NOT_STARTED":e.toUpperCase():"NOT_STARTED"},{key:"assignedEmployee",label:"Assigned Employee"}],customActions:[{label:"View",className:"action-btn-small info",onClick:Ie},{label:"Edit",className:"action-btn-small primary",onClick:Be},{label:"KYC",className:"action-btn-small warning",onClick:_e}]})]})})})(),"employees"===a&&(()=>{const e=(f||[]).filter((e=>!me.district||e.district===me.district));return(0,g.jsx)("div",{className:"overview-section",children:ie?(0,g.jsxs)("div",{className:"employee-registration-section",children:[(0,g.jsxs)("div",{className:"section-header",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"section-title",children:"Add New Employee"}),(0,g.jsx)("p",{className:"section-description",children:"Fill in the employee details to create a new employee account."})]}),(0,g.jsx)("div",{className:"section-actions",children:(0,g.jsxs)("button",{className:"action-btn-small secondary",onClick:()=>ne(!1),children:[(0,g.jsx)("i",{className:"fas fa-arrow-left"}),"Back to Employees"]})})]}),(0,g.jsx)(c.A,{isInDashboard:!0,onClose:()=>ne(!1),onSubmit:async e=>{try{const s=await i.s2.createEmployee(e);E((e=>[...e,s])),alert("Employee created successfully!"),ne(!1)}catch(s){console.error("Error creating employee:",s),alert("Failed to create employee. Please try again.")}}})]}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"overview-header",children:[(0,g.jsx)("h2",{className:"overview-title",children:"Employee Management"}),(0,g.jsx)("p",{className:"overview-description",children:"View and manage employee profiles with KYC assignment statistics."}),(0,g.jsx)("div",{className:"overview-actions",children:(0,g.jsx)("button",{className:"action-btn primary",onClick:()=>ne(!0),children:"Add Employee"})})]}),(0,g.jsxs)("div",{className:"employee-stats",children:[(0,g.jsx)("h3",{children:"Employee KYC Progress"}),(0,g.jsx)("div",{className:"employee-stats-grid",children:f.map((e=>{const s=(b||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,l=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,t=s.filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,i=s.filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return(0,g.jsxs)("div",{className:"employee-stat-card",children:[(0,g.jsxs)("div",{className:"employee-info",children:[(0,g.jsx)("h4",{children:e.name}),(0,g.jsxs)("p",{children:[e.designation," - ",e.district]})]}),(0,g.jsxs)("div",{className:"employee-kyc-stats",children:[(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number",children:s.length}),(0,g.jsx)("span",{className:"stat-label",children:"Total Assigned"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number approved",children:a}),(0,g.jsx)("span",{className:"stat-label",children:"Approved"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number pending",children:l}),(0,g.jsx)("span",{className:"stat-label",children:"Pending"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number refer-back",children:t}),(0,g.jsx)("span",{className:"stat-label",children:"Refer Back"})]}),(0,g.jsxs)("div",{className:"kyc-stat",children:[(0,g.jsx)("span",{className:"stat-number rejected",children:i}),(0,g.jsx)("span",{className:"stat-label",children:"Rejected"})]})]})]},e.id)}))})]}),(0,g.jsx)(u.A,{data:e.map((e=>{const s=(b||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,l=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length;return{...e,totalAssigned:s.length,approvedKyc:a,pendingKyc:l}})),columns:[{key:"name",label:"Name"},{key:"contactNumber",label:"Contact"},{key:"email",label:"Email"},{key:"state",label:"State"},{key:"district",label:"District"},{key:"totalAssigned",label:"Assigned Farmers"},{key:"approvedKyc",label:"Approved KYC"},{key:"pendingKyc",label:"Pending KYC"}],customActions:[{label:"View",className:"action-btn-small info",onClick:Oe},{label:"Edit",className:"action-btn-small primary",onClick:Ge}]})]})})})(),"registration"===a&&(()=>{const e=(()=>{console.log("All registrations:",H);const e=(H||[]).filter((e=>{const s=!de.role||e.role===de.role,a=!de.status||e.status===de.status;return s&&a}));return console.log("Filtered registrations:",e),e})();return(0,g.jsxs)("div",{className:"registration-section",children:[(0,g.jsxs)("div",{className:"section-header",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"section-title",children:"Registration Management"}),(0,g.jsx)("p",{className:"section-description",children:"Review and manage user registration requests."})]}),(0,g.jsx)("div",{className:"section-actions",children:(0,g.jsxs)("button",{className:"action-btn-small primary",onClick:()=>{console.log("\ud83d\udd04 Manually refreshing data..."),Pe()},children:[(0,g.jsx)("i",{className:"fas fa-sync-alt"}),"Refresh Data"]})})]}),(0,g.jsxs)("div",{className:"filters-section",children:[(0,g.jsx)("div",{className:"filter-group",children:(0,g.jsxs)("select",{className:"filter-select",value:de.role,onChange:e=>oe((s=>({...s,role:e.target.value}))),children:[(0,g.jsx)("option",{value:"",children:"All Roles"}),(0,g.jsx)("option",{value:"FARMER",children:"Farmer"}),(0,g.jsx)("option",{value:"EMPLOYEE",children:"Employee"}),(0,g.jsx)("option",{value:"ADMIN",children:"Admin"})]})}),(0,g.jsx)("div",{className:"filter-group",children:(0,g.jsxs)("select",{className:"filter-select",value:de.status,onChange:e=>oe((s=>({...s,status:e.target.value}))),children:[(0,g.jsx)("option",{value:"",children:"All Status"}),(0,g.jsx)("option",{value:"PENDING",children:"Pending"}),(0,g.jsx)("option",{value:"APPROVED",children:"Approved"}),(0,g.jsx)("option",{value:"REJECTED",children:"Rejected"})]})})]}),(0,g.jsx)(u.A,{data:e,columns:[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"phoneNumber",label:"Phone"},{key:"role",label:"Role"},{key:"status",label:"Status"}],customActions:[{label:"View",className:"action-btn-small info",onClick:Fe},{label:"Approve",className:"action-btn-small success",onClick:e=>Ke(e.id),show:e=>"PENDING"===e.status},{label:"Reject",className:"action-btn-small danger",onClick:e=>Te(e.id),show:e=>"PENDING"===e.status}]})]})})()]})]})}),C&&(0,g.jsx)(d.A,{farmers:b.filter((e=>!e.assignedEmployee||"Not Assigned"===e.assignedEmployee||null===e.assignedEmployee||void 0===e.assignedEmployee||""===e.assignedEmployee)),employees:f,onClose:()=>w(!1),onAssign:async e=>{try{var s;const t=e.map((e=>e.farmerId)),n=null===(s=e[0])||void 0===s?void 0:s.employeeId;if(!n||0===t.length)return void alert("Please select an employee and at least one farmer");try{await i.Er.bulkAssignFarmers(t,n)}catch(a){console.log("Bulk assign failed, trying individual assignments...");for(const e of t)try{await i.Er.assignFarmer(e,n)}catch(l){console.error(`Failed to assign farmer ${e}:`,l)}}k((s=>s.map((s=>{const a=e.find((e=>e.farmerId===s.id));return a?{...s,assignmentStatus:"ASSIGNED",assignedEmployee:a.employeeName,assignedDate:(new Date).toISOString().split("T")[0]}:s})))),w(!1),alert("Farmers assigned successfully!")}catch(t){console.error("Error assigning farmers:",t),alert("Failed to assign farmers")}}}),K&&Y&&(0,g.jsx)(m.A,{farmerData:Y,onClose:()=>{T(!1),I(null)}}),O&&B&&(0,g.jsx)(h.A,{employee:B,onClose:()=>{_(!1),G(null)},onUpdate:e=>{E((s=>s.map((s=>s.id===e.id?e:s)))),_(!1),G(null)}}),U&&M&&(0,g.jsx)(o.A,{farmer:M,onClose:()=>{V(!1),J(null)},onApprove:(e,s)=>{k((s=>s.map((s=>s.id===e?{...s,kycStatus:"APPROVED"}:s)))),V(!1),J(null)},onReject:(e,s,a)=>{k((s=>s.map((s=>s.id===e?{...s,kycStatus:"REJECTED"}:s)))),V(!1),J(null)},onReferBack:(e,s,a)=>{k((s=>s.map((s=>s.id===e?{...s,kycStatus:"REFER_BACK"}:s)))),V(!1),J(null)}}),se&&le&&(0,g.jsx)(j.A,{registration:le,onClose:()=>{ae(!1),te(null)},onUpdate:()=>{Pe()},onApprove:Ke,onReject:Te}),Re&&(0,g.jsxs)("div",{className:`notification-toast ${Re.type}`,children:[(0,g.jsx)("span",{children:Re.message}),(0,g.jsx)("button",{onClick:()=>De(null),children:"\xd7"})]})]})}},8756:(e,s,a)=>{a(5043),a(579)}}]);
//# sourceMappingURL=682.8b202558.chunk.js.map