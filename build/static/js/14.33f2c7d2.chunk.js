"use strict";(self.webpackChunkagristack_farmer_management=self.webpackChunkagristack_farmer_management||[]).push([[14],{476:(e,a,s)=>{s.d(a,{Dv:()=>n,Er:()=>r,JL:()=>c,R2:()=>o,kM:()=>d,s2:()=>l,xs:()=>i});const t=s(6213).A.create({baseURL:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"http://localhost:8080/api",timeout:1e4,headers:{"Content-Type":"application/json"}});t.interceptors.request.use((e=>{const a=localStorage.getItem("token");return a&&(e.headers.Authorization=`Bearer ${a}`),e}),(e=>Promise.reject(e))),t.interceptors.response.use((e=>e),(e=>{var a;return 401===(null===(a=e.response)||void 0===a?void 0:a.status)&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)}));const o={login:async e=>(await t.post("/auth/login",e)).data,getProfile:async()=>(await t.get("/auth/profile")).data,register:async e=>(await t.post("/auth/register",e)).data,sendOTP:async e=>(await t.post("/auth/send-otp",{emailOrPhone:e})).data,verifyOTP:async e=>(await t.post("/auth/verify-otp",{emailOrPhone:e.email,otp:e.otp})).data,resendOTP:async e=>(await t.post("/auth/resend-otp",{emailOrPhone:e})).data,forgotPassword:async e=>(await t.post("/auth/forgot-password",{emailOrPhone:e})).data,forgotUserId:async e=>(await t.post("/auth/forgot-user-id",{emailOrPhone:e})).data,resetPassword:async e=>(await t.post("/auth/reset-password",e)).data,changePassword:async e=>(await t.post("/auth/change-password",e)).data,changeUserId:async e=>(await t.post("/auth/change-user-id",e)).data,getCountries:async()=>(await t.get("/auth/countries")).data,getStates:async e=>(await t.post("/auth/states",{countryId:e})).data},n={getAllUsers:async()=>(await t.get("/super-admin/registration-list")).data,getRegistrationList:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.get("/super-admin/registration-list",{params:e})).data},getRegistrationListByStatus:async e=>(await t.get("/super-admin/registration-list/filter",{params:{status:e}})).data,searchRegistrations:async e=>(await t.get("/super-admin/registration-list/search",{params:{query:e}})).data,getPendingRegistrations:async()=>(await t.get("/super-admin/pending-registrations")).data,getApprovedUsers:async()=>(await t.get("/super-admin/approved-users")).data,getUsersByRole:async e=>(await t.get(`/super-admin/users/by-role/${e}`)).data,getPendingUsersByRole:async e=>(await t.get(`/super-admin/pending-users/by-role/${e}`)).data,approveUser:async(e,a)=>(await t.put(`/auth/users/${e}/approve`,{role:a})).data,rejectUser:async(e,a)=>(await t.put(`/auth/users/${e}/status`,{status:"REJECTED"})).data,deleteUser:async e=>(await t.delete(`/super-admin/users/${e}`)).data,updateUser:async(e,a)=>(await t.put(`/super-admin/users/${e}`,a)).data,updateUserStatus:async(e,a)=>(await t.put(`/auth/users/${e}/status`,{status:a})).data,getDashboardStats:async()=>(await t.get("/super-admin/dashboard/stats")).data,bulkAssignFarmers:async(e,a)=>(await t.post("/super-admin/bulk-assign-farmers",{farmerIds:e,employeeId:a})).data,assignFarmer:async(e,a)=>(await t.post("/super-admin/assign-farmer",null,{params:{farmerId:e,employeeId:a}})).data},i={getAllFarmers:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.get("/super-admin/farmers",{params:e})).data},getFarmerById:async e=>(await t.get(`/super-admin/farmers/${e}`)).data,createFarmer:async e=>(await t.post("/super-admin/farmers",e)).data,updateFarmer:async(e,a)=>(await t.put(`/super-admin/farmers/${e}`,a)).data,deleteFarmer:async e=>(await t.delete(`/super-admin/farmers/${e}`)).data,assignFarmer:async(e,a)=>(await t.post(`/super-admin/farmers/${e}/assign`,{employeeId:a})).data,getFarmerStats:async()=>(await t.get("/super-admin/farmers/stats")).data},r={getAllFarmers:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.get("/admin/farmers",{params:e})).data},getAllEmployees:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.get("/admin/employees",{params:e})).data},getFarmersWithKyc:async()=>(await t.get("/admin/farmers-with-kyc")).data,getEmployeesWithStats:async()=>(await t.get("/admin/employees-with-stats")).data,getFarmersByEmployee:async e=>(await t.get(`/admin/employees/${e}/assigned-farmers`)).data,getTodoList:async()=>(await t.get("/admin/todo-list")).data,getEnhancedTodoList:async()=>(await t.get("/admin/enhanced-todo-list")).data,getDashboardStats:async()=>(await t.get("/admin/dashboard-stats")).data,filterFarmers:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.get("/admin/farmers/filter",{params:e})).data},getLocations:async()=>(await t.get("/admin/locations")).data,bulkAssignFarmers:async(e,a)=>(await t.post("/admin/bulk-assign-farmers",{farmerIds:e,employeeId:a})).data,assignFarmer:async(e,a)=>(await t.post("/admin/assign-farmer",null,{params:{farmerId:e,employeeId:a}})).data,getAssignmentHistory:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.get("/admin/assignment-history",{params:e})).data},getFarmersByAssignmentStatus:async e=>(await t.get("/admin/farmers/by-assignment-status",{params:{assignmentStatus:e}})).data,getAllRegistrations:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.get("/admin/registration-list",{params:e})).data},getRegistrationListByStatus:async e=>(await t.get("/admin/registration-list/filter",{params:{status:e}})).data,approveRegistration:async(e,a)=>(await t.post(`/admin/registrations/${e}/approve`,a)).data,rejectRegistration:async(e,a)=>(await t.post(`/admin/registrations/${e}/reject`,a)).data},l={getAllEmployees:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.get("/super-admin/employees",{params:e})).data},getEmployeeById:async e=>(await t.get(`/super-admin/employees/${e}`)).data,createEmployee:async e=>(await t.post("/super-admin/employees",e)).data,updateEmployee:async(e,a)=>(await t.put(`/super-admin/employees/${e}`,a)).data,deleteEmployee:async e=>(await t.delete(`/super-admin/employees/${e}`)).data,getAssignedFarmers:async e=>(await t.get(`/super-admin/employees/${e}/assigned-farmers`)).data,getEmployeeStats:async()=>(await t.get("/super-admin/employees/stats")).data},c={getAssignedFarmers:async e=>{try{console.log("\ud83d\udd04 Fetching assigned farmers from dashboard endpoint");const e=await t.get("/employees/dashboard/assigned-farmers");return console.log("\u2705 Success with dashboard endpoint"),e.data}catch(a){throw console.error("\u274c Failed to fetch assigned farmers:",a),a}},getProfile:async()=>(await t.get("/employees/profile")).data,updateProfile:async e=>(await t.put("/employees/profile",e)).data,getStats:async()=>(await t.get("/employees/stats")).data},d={uploadDocuments:async(e,a)=>{const s=new FormData;Object.keys(a).forEach((e=>{a[e]&&s.append(e,a[e])}));return(await t.post(`/employees/kyc/${e}/upload`,s,{headers:{"Content-Type":"multipart/form-data"}})).data},approveKYC:async(e,a)=>(await t.put(`/employees/kyc/approve/${e}`)).data,rejectKYC:async(e,a)=>(await t.put(`/employees/kyc/reject/${e}`,{reason:a.reason||"KYC rejected"})).data,referBackKYC:async(e,a)=>(await t.put(`/employees/kyc/refer-back/${e}`,{reason:a.reason||"KYC referred back"})).data,getKYCStatus:async e=>(await t.get(`/employees/kyc/${e}/status`)).data,getKYCDocuments:async e=>(await t.get(`/employees/kyc/${e}/documents`)).data}},4003:()=>{},4513:(e,a,s)=>{e.exports=s.p+"static/media/rightlogo.1742b4514aa334820279.png"},7014:(e,a,s)=>{s.r(a),s.d(a,{default:()=>d});var t=s(5043),o=s(3216),n=s(5016),i=s(476),r=s(4513),l=(s(4003),s(579));const c=()=>{const e="abcdefghijklmnopqrstuvwxyz0123456789";let a="";for(let s=0;s<5;s++)a+=e.charAt(Math.floor(36*Math.random()));return a},d=()=>{const{login:e}=(0,t.useContext)(n.cy),[a,s]=(0,t.useState)(""),[d,g]=(0,t.useState)(""),[p,m]=(0,t.useState)("official"),[u,h]=(0,t.useState)(""),[y,f]=(0,t.useState)(c()),[w,v]=(0,t.useState)(!1),[j,x]=(0,t.useState)(""),[b,E]=(0,t.useState)(!1),N=(0,o.Zp)(),L=e=>{m(e),x(""),h(""),f(c())};return(0,l.jsx)("div",{className:"login-page-container",children:(0,l.jsxs)("div",{className:"login-page-main-content",children:[(0,l.jsxs)("div",{className:"login-page-info-panel",children:[(0,l.jsxs)("div",{className:"login-page-brand-header",children:[(0,l.jsxs)("div",{className:"login-page-brand-logo",children:[(0,l.jsx)("span",{className:"login-page-brand-text",children:"Date"}),(0,l.jsx)("span",{className:"login-page-brand-accent",children:"Agri"}),(0,l.jsx)("span",{className:"login-page-brand-icon",children:"\ud83c\udf3f"}),(0,l.jsx)("span",{className:"login-page-brand-text",children:"Stack"})]}),(0,l.jsx)("h1",{className:"login-page-main-title",children:"India Farmer Registry"})]}),(0,l.jsxs)("div",{className:"login-page-platform-info",children:[(0,l.jsx)("h2",{children:"Digital Agristack Transaction Enterprises"}),(0,l.jsx)("p",{className:"login-page-tagline",children:"Empowering Agricultural Excellence"})]}),(0,l.jsxs)("div",{className:"login-page-features-grid",children:[(0,l.jsxs)("div",{className:"login-page-feature-card",children:[(0,l.jsx)("div",{className:"login-page-feature-icon",children:"\ud83c\udf3e"}),(0,l.jsxs)("div",{className:"login-page-feature-content",children:[(0,l.jsx)("h3",{children:"Revolutionizing Indian Agriculture"}),(0,l.jsx)("p",{children:"Connecting 140+ million farmers with cutting-edge digital solutions"})]})]}),(0,l.jsxs)("div",{className:"login-page-feature-card",children:[(0,l.jsx)("div",{className:"login-page-feature-icon",children:"\ud83d\udcf1"}),(0,l.jsxs)("div",{className:"login-page-feature-content",children:[(0,l.jsx)("h3",{children:"Smart Farming Technology"}),(0,l.jsx)("p",{children:"AI-powered crop monitoring and precision agriculture tools"})]})]}),(0,l.jsxs)("div",{className:"login-page-feature-card",children:[(0,l.jsx)("div",{className:"login-page-feature-icon",children:"\ud83d\udcb0"}),(0,l.jsxs)("div",{className:"login-page-feature-content",children:[(0,l.jsx)("h3",{children:"Financial Inclusion"}),(0,l.jsx)("p",{children:"Direct benefit transfers and digital payment solutions"})]})]}),(0,l.jsxs)("div",{className:"login-page-feature-card",children:[(0,l.jsx)("div",{className:"login-page-feature-icon",children:"\ud83c\udf31"}),(0,l.jsxs)("div",{className:"login-page-feature-content",children:[(0,l.jsx)("h3",{children:"Sustainable Practices"}),(0,l.jsx)("p",{children:"Promoting eco-friendly farming and climate-smart agriculture"})]})]}),(0,l.jsxs)("div",{className:"login-page-feature-card",children:[(0,l.jsx)("div",{className:"login-page-feature-icon",children:"\ud83c\udfc6"}),(0,l.jsxs)("div",{className:"login-page-feature-content",children:[(0,l.jsx)("h3",{children:"National Recognition"}),(0,l.jsx)("p",{children:"Government of India's flagship agricultural digitization initiative"})]})]})]})]}),(0,l.jsx)("div",{className:"login-page-form-section",children:(0,l.jsxs)("div",{className:"login-page-card",children:[(0,l.jsxs)("div",{className:"login-page-date-logo-section",children:[(0,l.jsx)("img",{src:r,alt:"DATE Logo",className:"login-page-date-logo"}),(0,l.jsxs)("div",{className:"login-page-date-text",children:[(0,l.jsx)("h3",{children:"Digital Agristack Transaction Enterprises"}),(0,l.jsx)("p",{children:"Empowering Agricultural Excellence"})]})]}),(0,l.jsxs)("div",{className:"login-page-login-type-section",children:[(0,l.jsx)("h3",{children:"Log In as"}),(0,l.jsxs)("div",{className:"login-page-login-type-toggle",children:[(0,l.jsx)("button",{type:"button",className:"login-page-toggle-btn "+("official"===p?"login-page-active":""),onClick:()=>L("official"),children:"Official"}),(0,l.jsx)("button",{type:"button",className:"login-page-toggle-btn "+("fpo"===p?"login-page-active":""),onClick:()=>L("fpo"),children:"FPO"}),(0,l.jsx)("button",{type:"button",className:"login-page-toggle-btn "+("employee"===p?"login-page-active":""),onClick:()=>L("employee"),children:"Employee"}),(0,l.jsx)("button",{type:"button",className:"login-page-toggle-btn "+("farmer"===p?"login-page-active":""),onClick:()=>L("farmer"),children:"Farmer"})]})]}),(0,l.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),x(""),E(!0),u.trim().toLowerCase()!==y.toLowerCase())return x("Captcha does not match."),E(!1),f(c()),void h("");try{const s={userName:a,password:d},c=await i.R2.login(s);console.log("Login - Full login response:",c),console.log("Login - Login response data keys:",Object.keys(c||{}));const{token:u}=c;u&&localStorage.setItem("token",u);const h=e=>(e||"").toString().toUpperCase().trim(),y=e=>{const a=h(e).replace(/^ROLE[ _-]*/,"").replace(/-/g,"_").replace(/\s+/g,"_");return a.includes("SUPER")&&a.includes("ADMIN")||"SUPERADMIN"===a?"SUPER_ADMIN":a.includes("ADMIN")&&!a.includes("SUPER")?"ADMIN":a.includes("EMPLOYEE")||a.includes("STAFF")?"EMPLOYEE":a.includes("FARMER")?"FARMER":""},f=()=>{switch(p){case"official":case"fpo":return"ADMIN";case"employee":return"EMPLOYEE";case"farmer":return"FARMER";default:return""}};try{var t,o;const s=await i.R2.getProfile();console.log("Login - Profile response data:",s),console.log("Login - Profile response data keys:",Object.keys(s||{}));const n={userName:s.userName||a,name:s.name,email:s.email,role:y(s.role)||f()||"FARMER",forcePasswordChange:s.forcePasswordChange||!1,status:s.status};if(d.includes("Temp@")&&(n.forcePasswordChange=!0,console.log("Login - Detected temporary password, forcing password change")),console.log("Login - User data from profile:",n),console.log("Login - User role from profile:",s.role),e(n,u),console.log("Login - Checking forcePasswordChange:",n.forcePasswordChange),console.log("Login - Password contains Temp@:",d.includes("Temp@")),n.forcePasswordChange)return console.log("Login - Redirecting to change password page"),void N("/change-password");console.log("Login - User role for navigation (known):",n.role),console.log("Login - User role type:",typeof n.role),console.log("Login - User role length:",null===(t=n.role)||void 0===t?void 0:t.length),console.log("Login - User role includes spaces:",null===(o=n.role)||void 0===o?void 0:o.includes(" "));const r=y(n.role)||f()||"";console.log("Login - Known role:",r),"SUPER_ADMIN"===r?(console.log("Login - Redirecting SUPER_ADMIN to /super-admin/dashboard"),N("/super-admin/dashboard")):"ADMIN"===r?(console.log("Login - Redirecting ADMIN to /admin/dashboard"),N("/admin/dashboard")):"EMPLOYEE"===r?(console.log("Login - Redirecting EMPLOYEE to /employee/dashboard"),N("/employee/dashboard")):(console.log("Login - Redirecting FARMER to /dashboard"),N("/dashboard"))}catch(j){var n,r,l,g,m;console.log("Profile fetch failed, trying alternative methods"),console.log("Profile error:",j);let s=y(null===(n=c.data)||void 0===n?void 0:n.role),t=(null===(r=c.data)||void 0===r?void 0:r.forcePasswordChange)||!1;if(d.includes("Temp@")&&(t=!0,console.log("Login - Detected temporary password, forcing password change")),!s)try{console.log("Login - Trying to get role from /auth/me endpoint");const e=await i.R2.getProfile();console.log("Login - /auth/me response:",e),s=y(null===e||void 0===e?void 0:e.role),console.log("Login - Role from /auth/me:",s)}catch(b){console.log("Login - /auth/me failed:",b);try{console.log("Login - Trying to get role from /api/auth/users/profile endpoint");const e=await i.R2.getProfile();console.log("Login - /api/auth/users/profile response:",e),s=y(null===e||void 0===e?void 0:e.role),console.log("Login - Role from /api/auth/users/profile:",s)}catch(L){console.log("Login - /api/auth/users/profile failed:",L)}}if(!s){console.log("Login - No role found, trying to determine from username"),console.log("Login - Username being checked:",a);a.toLowerCase();const e=["projecthinfintiy@12.in","superadmin@hinfinity.in"],t=["karthik.m@hinfinity.in","admin@hinfinity.in"],o=["employee@hinfinity.in","emp@hinfinity.in","testemployee@hinfinity.in","hari2912@gmail.com","harish134@gmail.com","employee2@hinfinity.in","test@employee.com"];console.log("Login - Checking against employee usernames:",o),console.log("Login - Username in employee list?",o.includes(a)),e.includes(a)?(s="SUPER_ADMIN",console.log("Login - Determined role as SUPER_ADMIN from specific username mapping")):t.includes(a)?(s="ADMIN",console.log("Login - Determined role as ADMIN from specific username mapping")):o.includes(a)?(s="EMPLOYEE",console.log("Login - Determined role as EMPLOYEE from specific username mapping"),console.log("Login - Employee username detected:",a)):(s=f()||"FARMER",console.log("Login - Falling back to loginType role:",s))}const o={userName:a,name:(null===(l=c.data)||void 0===l?void 0:l.name)||a,email:(null===(g=c.data)||void 0===g?void 0:g.email)||a,role:s,forcePasswordChange:t,status:(null===(m=c.data)||void 0===m?void 0:m.status)||"ACTIVE"};if(console.log("Login - Fallback user data:",o),e(o,u),o.forcePasswordChange)return console.log("Login - Fallback: Redirecting to change password page"),void N("/change-password");const p=y(s)||f()||"";console.log("Login - Fallback: Known role:",p),"SUPER_ADMIN"===p?(console.log("Login - Fallback: Redirecting SUPER_ADMIN to /super-admin/dashboard"),N("/super-admin/dashboard")):"ADMIN"===p?(console.log("Login - Fallback: Redirecting ADMIN to /admin/dashboard"),N("/admin/dashboard")):"EMPLOYEE"===p?(console.log("Login - Fallback: Redirecting EMPLOYEE to /employee/dashboard"),N("/employee/dashboard")):(console.log("Login - Fallback: Redirecting FARMER to /dashboard"),N("/dashboard"))}}catch(P){var w,v;console.error("Login error:",P),console.error("Login error response:",P.response),console.error("Login error message:",P.message),x(`Login failed: ${(null===(w=P.response)||void 0===w||null===(v=w.data)||void 0===v?void 0:v.message)||P.message||"Invalid credentials or server error."}`)}finally{E(!1)}},className:"login-page-form",children:[(0,l.jsxs)("div",{className:"login-page-form-field",children:[(0,l.jsx)("label",{children:"Insert Registered Mobile Number as Username"}),(0,l.jsx)("input",{type:"text",value:a,onChange:e=>s(e.target.value),required:!0,disabled:b,placeholder:"Enter username"})]}),(0,l.jsxs)("div",{className:"login-page-form-field",children:[(0,l.jsx)("label",{children:"Enter password"}),(0,l.jsxs)("div",{className:"login-page-password-input-container",children:[(0,l.jsx)("input",{type:w?"text":"password",value:d,onChange:e=>g(e.target.value),required:!0,disabled:b,placeholder:"Enter password"}),(0,l.jsx)("button",{type:"button",className:"login-page-eye-icon",onClick:()=>v(!w),children:"\ud83d\udc41\ufe0f"})]})]}),(0,l.jsxs)("div",{className:"login-page-forgot-password",children:[(0,l.jsx)("a",{href:"/forgot-password",children:"Forgot Password?"}),(0,l.jsx)("span",{className:"login-page-separator",children:"|"}),(0,l.jsx)("a",{href:"/forgot-userid",children:"Forgot User ID?"})]}),(0,l.jsxs)("div",{className:"login-page-captcha-section",children:[(0,l.jsx)("label",{children:"Captcha"}),(0,l.jsxs)("div",{className:"login-page-captcha-container",children:[(0,l.jsx)("div",{className:"login-page-captcha-image",children:(0,l.jsx)("span",{children:y})}),(0,l.jsx)("button",{type:"button",className:"login-page-refresh-captcha",onClick:()=>{f(c()),h("")},children:"\ud83d\udd04"}),(0,l.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Enter Captcha",className:"login-page-captcha-input"})]})]}),j&&(0,l.jsx)("div",{className:"login-page-error-message",children:j}),(0,l.jsxs)("div",{className:"login-page-actions-row",children:[(0,l.jsx)("button",{type:"submit",className:"login-page-login-btn",disabled:b,children:b?"Logging in...":"Log In"}),("employee"===p||"farmer"===p||"fpo"===p)&&(0,l.jsx)("button",{type:"button",className:"login-page-create-account-btn",onClick:()=>{"employee"===p?N("/register-employee",{state:{role:"EMPLOYEE"}}):"farmer"===p?N("/register-farmer",{state:{role:"FARMER"}}):"fpo"===p&&N("/register-fpo",{state:{role:"FPO"}})},children:"Create New user Acount"})]})]})]})})]})})}}}]);
//# sourceMappingURL=14.33f2c7d2.chunk.js.map