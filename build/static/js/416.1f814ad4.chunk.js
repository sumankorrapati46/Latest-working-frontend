"use strict";(self.webpackChunkagristack_farmer_management=self.webpackChunkagristack_farmer_management||[]).push([[416],{1416:(e,s,a)=>{a.r(s),a.d(s,{default:()=>f});var l=a(5043),t=a(3216),i=a(5016),r=a(476),n=(a(5812),a(6428)),c=a(980),o=a(2383),d=a(4499),m=a(1125),h=a(8022),u=a(2343),p=(a(8756),a(838)),v=a(2064),x=a(8874),j=(a(1953),a(9764)),g=a(7105),N=a(4801),y=a(579);const b=()=>{const[e,s]=(0,l.useState)({}),[a,t]=(0,l.useState)(!1),i=()=>Object.values(e).some((e=>e.success&&e.count>0));return(0,y.jsxs)("div",{style:{padding:"20px",border:"2px solid #ccc",borderRadius:"8px",margin:"20px",backgroundColor:"#f9f9f9"},children:[(0,y.jsx)("h2",{children:"\ud83d\udd0d Data Fetch Test Component"}),(0,y.jsx)("p",{children:"This component helps verify if your app is fetching real data from the backend."}),(0,y.jsx)("button",{onClick:async()=>{t(!0);const e={};try{console.log("\ud83e\uddea Testing Admin API - Get Farmers...");try{const s=await r.Er.getFarmersWithKyc();e.farmers={success:!0,count:(null===s||void 0===s?void 0:s.length)||0,data:(null===s||void 0===s?void 0:s.slice(0,2))||[]},console.log("\u2705 Farmers API Success:",null===s||void 0===s?void 0:s.length,"records")}catch(a){e.farmers={success:!1,error:a.message},console.log("\u274c Farmers API Failed:",a.message)}console.log("\ud83e\uddea Testing Admin API - Get Employees...");try{const s=await r.Er.getEmployeesWithStats();e.employees={success:!0,count:(null===s||void 0===s?void 0:s.length)||0,data:(null===s||void 0===s?void 0:s.slice(0,2))||[]},console.log("\u2705 Employees API Success:",null===s||void 0===s?void 0:s.length,"records")}catch(a){e.employees={success:!1,error:a.message},console.log("\u274c Employees API Failed:",a.message)}console.log("\ud83e\uddea Testing Super Admin API - Get Registrations...");try{const s=await r.Dv.getRegistrationList();e.registrations={success:!0,count:(null===s||void 0===s?void 0:s.length)||0,data:(null===s||void 0===s?void 0:s.slice(0,2))||[]},console.log("\u2705 Registrations API Success:",null===s||void 0===s?void 0:s.length,"records")}catch(a){e.registrations={success:!1,error:a.message},console.log("\u274c Registrations API Failed:",a.message)}}catch(a){console.error("\u274c Test suite failed:",a)}s(e),t(!1)},disabled:a,style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:a?"not-allowed":"pointer"},children:a?"Running Tests...":"Run API Tests"}),Object.keys(e).length>0&&(0,y.jsxs)("div",{style:{marginTop:"20px"},children:[(0,y.jsx)("h3",{children:"Test Results:"}),(0,y.jsxs)("div",{style:{padding:"10px",backgroundColor:i()?"#d4edda":"#f8d7da",border:"1px solid "+(i()?"#c3e6cb":"#f5c6cb"),borderRadius:"4px",marginBottom:"15px"},children:[(0,y.jsx)("strong",{children:"Status: "}),i()?"\u2705 Using Real Data":"\u274c Using Mock Data or API Failed"]}),Object.entries(e).map((e=>{let[s,a]=e;return(0,y.jsxs)("div",{style:{marginBottom:"10px",padding:"10px",border:"1px solid "+(a.success?"#c3e6cb":"#f5c6cb"),borderRadius:"4px",backgroundColor:a.success?"#d4edda":"#f8d7da"},children:[(0,y.jsxs)("h4",{children:[s.charAt(0).toUpperCase()+s.slice(1)," API:"]}),a.success?(0,y.jsxs)("div",{children:[(0,y.jsxs)("p",{children:["\u2705 Success: ",a.count," records found"]}),a.data.length>0&&(0,y.jsxs)("details",{children:[(0,y.jsx)("summary",{children:"Sample Data (first 2 records)"}),(0,y.jsx)("pre",{style:{backgroundColor:"#f8f9fa",padding:"10px",borderRadius:"4px",fontSize:"12px",overflow:"auto"},children:JSON.stringify(a.data,null,2)})]})]}):(0,y.jsxs)("p",{children:["\u274c Failed: ",a.error]})]},s)}))]}),(0,y.jsxs)("div",{style:{marginTop:"20px",fontSize:"14px",color:"#666"},children:[(0,y.jsx)("h4",{children:"How to interpret results:"}),(0,y.jsxs)("ul",{children:[(0,y.jsxs)("li",{children:[(0,y.jsx)("strong",{children:"\u2705 Success with data:"})," Real data is being fetched from backend"]}),(0,y.jsxs)("li",{children:[(0,y.jsx)("strong",{children:"\u2705 Success with 0 records:"})," API works but no data in database"]}),(0,y.jsxs)("li",{children:[(0,y.jsx)("strong",{children:"\u274c Failed:"})," Backend not running or API endpoint doesn't exist"]})]}),(0,y.jsx)("h4",{children:"Next steps:"}),(0,y.jsxs)("ul",{children:[(0,y.jsx)("li",{children:"Make sure your backend server is running on port 8080"}),(0,y.jsx)("li",{children:"Check browser console for detailed error messages"}),(0,y.jsx)("li",{children:"Verify API endpoints in Network tab of Developer Tools"})]})]})]})},f=()=>{const e=(0,t.Zp)(),{user:s,logout:a}=(0,i.As)(),[f,k]=(0,l.useState)("overview"),[S,E]=(0,l.useState)([]),[A,C]=(0,l.useState)([]),[w,R]=(0,l.useState)(""),[D,P]=(0,l.useState)(!1),[F,I]=(0,l.useState)(!1),[T,K]=(0,l.useState)(!1),[Y,O]=(0,l.useState)(!1),[B,G]=(0,l.useState)(null),[_,U]=(0,l.useState)(!1),[V,M]=(0,l.useState)(null),[q,J]=(0,l.useState)(!1),[L,W]=(0,l.useState)(null),[H,z]=(0,l.useState)(null),[$,Q]=(0,l.useState)(null),[Z,X]=(0,l.useState)([]),[ee,se]=(0,l.useState)(!1),[ae,le]=(0,l.useState)(null),[te,ie]=(0,l.useState)(!1),[re,ne]=(0,l.useState)(null),[ce,oe]=(0,l.useState)(!1),[de,me]=(0,l.useState)(!1),[he,ue]=(0,l.useState)({role:"",status:""}),[pe,ve]=(0,l.useState)({state:"",district:"",region:"",kycStatus:"",assignmentStatus:"",employeeFilter:""}),[xe,je]=(0,l.useState)(!1),[ge,Ne]=(0,l.useState)(!1),[ye,be]=(0,l.useState)(!1),[fe,ke]=(0,l.useState)(null),[Se,Ee]=(0,l.useState)(null),[Ae,Ce]=(0,l.useState)(!1),[we,Re]=(0,l.useState)(!1),[De,Pe]=(0,l.useState)(!1),[Fe,Ie]=(0,l.useState)(null);(0,l.useEffect)((()=>{Te();const e=e=>{console.log("\ud83d\udd04 Admin Dashboard: KYC status updated, refreshing data..."),console.log("\ud83d\udcca KYC Update details:",e.detail),setTimeout((()=>{console.log("\ud83d\udd04 Refreshing Admin data after KYC update..."),Te()}),2e3)};return window.addEventListener("kycStatusUpdated",e),()=>{window.removeEventListener("kycStatusUpdated",e)}}),[]);const Te=async()=>{try{console.log("\ud83d\udd0d Admin: Starting to fetch real data from API...");const[e,s,a]=await Promise.all([r.Er.getFarmersWithKyc(),r.Er.getEmployeesWithStats(),r.Dv.getRegistrationList()]);console.log("\u2705 Admin API Response:",{farmersCount:(null===e||void 0===e?void 0:e.length)||0,employeesCount:(null===s||void 0===s?void 0:s.length)||0,registrationsCount:(null===a||void 0===a?void 0:a.length)||0}),E(e||[]),C(s||[]),X(a||[]),console.log("\u2705 Admin: Using real data from APIs"),console.log("- Farmers:",(null===e||void 0===e?void 0:e.length)||0,"records"),console.log("- Employees:",(null===s||void 0===s?void 0:s.length)||0,"records"),console.log("- Registrations:",(null===a||void 0===a?void 0:a.length)||0,"records")}catch(e){console.error("\u274c Admin error fetching data:",e),console.log("\u274c Using fallback endpoints due to API error");try{const[e,s,a]=await Promise.all([r.Er.getAllFarmers(),r.Er.getAllEmployees(),r.Dv.getRegistrationList()]);console.log("\u2705 Fallback API Response:",{farmersCount:(null===e||void 0===e?void 0:e.length)||0,employeesCount:(null===s||void 0===s?void 0:s.length)||0,registrationsCount:(null===a||void 0===a?void 0:a.length)||0}),E(e||[]),C(s||[]),X(a||[])}catch(s){console.error("\u274c Fallback API also failed:",s),E([]),C([]),X([])}}},Ke=e=>{ne(e),ie(!0)},Ye=async e=>{try{await r.Dv.approveUser(e,"FARMER"),X((s=>s.map((s=>s.id===e?{...s,status:"APPROVED"}:s)))),alert("Registration approved successfully!")}catch(s){console.error("Error approving registration:",s),alert("Failed to approve registration. Please try again.")}},Oe=async e=>{try{await r.Dv.rejectUser(e,"Rejected by Admin"),X((s=>s.map((s=>s.id===e?{...s,status:"REJECTED"}:s)))),alert("Registration rejected successfully!")}catch(s){console.error("Error rejecting registration:",s),alert("Failed to reject registration. Please try again.")}},Be=()=>{const e=(null===S||void 0===S?void 0:S.length)||0,s=(null===A||void 0===A?void 0:A.length)||0,a=(S||[]).filter((e=>!e.assignedEmployee||"Not Assigned"===e.assignedEmployee)).length,l=(S||[]).filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,t=(S||[]).filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,i=(S||[]).filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,r=(S||[]).filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return console.log("Admin Stats calculated from real data:"),console.log("- Total Farmers:",e),console.log("- Total Employees:",s),console.log("- Unassigned Farmers:",a),console.log("- Pending KYC:",l),console.log("- Approved KYC:",t),console.log("- Refer Back KYC:",i),console.log("- Rejected KYC:",r),{totalFarmers:e,totalEmployees:s,unassignedFarmers:a,pendingKYC:l,approvedKYC:t,referBackKYC:i,rejectedKYC:r}},Ge=e=>{G(e),O(!0)},_e=e=>{Ee(e),be(!0)},Ue=e=>{W(e),J(!0)},Ve=e=>{z(e),I(!0)},Me=e=>{Q(e),K(!0)},qe=()=>{I(!0),k("overview")},Je=()=>{Ne(!0),ke(null),k("overview")},Le=()=>{K(!0),k("overview")},We=()=>{be(!0),Ee(null),k("overview")},He=()=>{P(!0),k("overview")},ze=()=>{Ce(!0),k("overview")};return(0,y.jsxs)("div",{className:"dashboard",children:[(0,y.jsxs)("div",{className:"top-bar",children:[(0,y.jsxs)("div",{className:"top-bar-left",children:[(0,y.jsx)("div",{className:"logo-container",children:(0,y.jsxs)("div",{className:"logo-text",children:[(0,y.jsx)("h1",{className:"logo-title",children:"DATE"}),(0,y.jsx)("p",{className:"logo-subtitle",children:"Digital Agristack Transaction Enterprises"})]})}),(0,y.jsx)("div",{className:"date-display",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,y.jsxs)("div",{className:"top-bar-right",children:[(0,y.jsx)(x.A,{}),(0,y.jsx)(v.A,{onShowChangePassword:()=>Re(!0),onShowChangeUserId:()=>Pe(!0)})]})]}),(0,y.jsxs)("aside",{className:"dashboard-sidebar",children:[(0,y.jsx)("div",{className:"sidebar-header",children:(0,y.jsxs)("div",{className:"logo",children:[(0,y.jsx)("div",{className:"logo-text",children:"Welcome !!!"}),(0,y.jsx)("div",{className:"logo-subtitle",children:"Admin"})]})}),(0,y.jsxs)("nav",{className:"sidebar-nav",children:[(0,y.jsx)("button",{className:"nav-item "+("overview"===f?"active":""),onClick:()=>k("overview"),children:"\ud83d\udcca Overview"}),(0,y.jsx)("button",{className:"nav-item "+("kyc-overview"===f?"active":""),onClick:()=>k("kyc-overview"),children:"\ud83e\udeaa KYC Overview"}),(0,y.jsx)("button",{className:"nav-item "+("farmers"===f?"active":""),onClick:()=>k("farmers"),children:"\ud83d\udc68\u200d\ud83c\udf3e Farmers"}),(0,y.jsx)("button",{className:"nav-item "+("employees"===f?"active":""),onClick:()=>k("employees"),children:"\ud83d\udc65 Employees"}),(0,y.jsx)("button",{className:"nav-item "+("registration"===f?"active":""),onClick:()=>k("registration"),children:"\ud83d\udcdd Registrations"}),(0,y.jsx)("button",{className:"nav-item",onClick:()=>e("/analytical-dashboard"),children:"\ud83d\udcc8 Dashboard"})]})]}),(0,y.jsx)("main",{className:"dashboard-main",children:(0,y.jsxs)("div",{className:"dashboard-content",children:["overview"===f&&!(F||T||ge||ye||we||De||Ae||D||q||te)&&(0,y.jsx)("header",{className:"dashboard-header",children:(0,y.jsx)("div",{className:"header-center",children:(0,y.jsxs)("div",{className:"welcome-message",children:[(0,y.jsxs)("h2",{className:"greeting",children:[(()=>{const e=(new Date).getHours();return e>=5&&e<12?"Good Morning":e>=12&&e<17?"Good Afternoon":e>=17&&e<21?"Good Evening":"Good Night"})(),", ",(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.email)||"Admin","! \ud83c\udf8b"]}),(0,y.jsx)("p",{className:"welcome-text",children:"Welcome to DATE Digital Agristack - Manage farmers, employees and registrations efficiently."})]})})}),F?(0,y.jsx)("div",{className:"dashboard-form-container",children:(0,y.jsx)(n.A,{isInDashboard:!0,editData:H,onClose:()=>{I(!1),z(null)},onSubmit:async e=>{try{if(H){const s=await r.xs.updateFarmer(H.id,e);E((e=>e.map((e=>e.id===H.id?s:e)))),alert("Farmer updated successfully!")}else{const s=await r.xs.createFarmer(e);E((e=>[...e,s])),alert("Farmer created successfully!")}I(!1),z(null)}catch(s){console.error("Error saving farmer:",s),alert("Failed to save farmer. Please try again.")}}})}):T?(0,y.jsx)("div",{className:"dashboard-form-container",children:(0,y.jsx)(o.A,{isInDashboard:!0,editData:$,onClose:()=>{K(!1),Q(null)},onSubmit:async e=>{try{if($){const s=await r.s2.updateEmployee($.id,e);C((e=>e.map((e=>e.id===$.id?s:e)))),alert("Employee updated successfully!")}else{const s=await r.s2.createEmployee(e);C((e=>[...e,s])),alert("Employee created successfully!")}K(!1),Q(null)}catch(s){console.error("Error saving employee:",s),alert("Failed to save employee. Please try again.")}}})}):ge?(0,y.jsx)("div",{className:"dashboard-form-container",children:(0,y.jsx)(h.A,{isInDashboard:!0,farmerData:fe||S,onClose:()=>{fe?ke(null):Ne(!1)},onFarmerSelect:e=>{ke(e)}})}):ye?(0,y.jsx)("div",{className:"dashboard-form-container",children:(0,y.jsx)(u.A,{isInDashboard:!0,employeeData:Se||A,onClose:()=>{Se?Ee(null):be(!1)},onEmployeeSelect:e=>{Ee(e)}})}):we?(0,y.jsx)("div",{className:"dashboard-form-container",children:(0,y.jsx)(g.A,{isOpen:!0,onClose:()=>Re(!1),onSuccess:()=>{Ie({type:"success",message:"Password changed successfully!"}),Re(!1)},isInDashboard:!0})}):De?(0,y.jsx)("div",{className:"dashboard-form-container",children:(0,y.jsx)(N.A,{isOpen:!0,onClose:()=>Pe(!1),onSuccess:()=>{Ie({type:"success",message:"User ID changed successfully!"}),Pe(!1)},isInDashboard:!0})}):Ae?(0,y.jsx)("div",{className:"dashboard-form-container",children:(0,y.jsxs)("div",{className:"view-farmer-dashboard",children:[(0,y.jsx)("div",{className:"dashboard-header",children:(0,y.jsxs)("div",{className:"header-content",children:[(0,y.jsxs)("div",{className:"header-text",children:[(0,y.jsx)("h1",{className:"dashboard-title",children:"Pending KYC"}),(0,y.jsx)("p",{className:"dashboard-subtitle",children:"Review and manage pending KYC applications"})]}),(0,y.jsxs)("button",{className:"back-button",onClick:()=>{Ce(!1)},children:[(0,y.jsx)("i",{className:"fas fa-arrow-left"}),"Back"]})]})}),(0,y.jsx)("div",{className:"dashboard-content",children:(0,y.jsx)("div",{className:"farmers-table-container",children:(0,y.jsxs)("table",{className:"farmers-table",children:[(0,y.jsx)("thead",{className:"table-header",children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{children:"Name"}),(0,y.jsx)("th",{children:"Phone"}),(0,y.jsx)("th",{children:"State"}),(0,y.jsx)("th",{children:"District"}),(0,y.jsx)("th",{children:"KYC Status"}),(0,y.jsx)("th",{children:"Actions"})]})}),(0,y.jsx)("tbody",{className:"table-body",children:S.filter((e=>"PENDING"===e.kycStatus)).map((e=>(0,y.jsxs)("tr",{className:"table-row",children:[(0,y.jsx)("td",{className:"table-cell",children:e.name}),(0,y.jsx)("td",{className:"table-cell",children:e.phone}),(0,y.jsx)("td",{className:"table-cell",children:e.state}),(0,y.jsx)("td",{className:"table-cell",children:e.district}),(0,y.jsx)("td",{className:"table-cell",children:(0,y.jsx)("span",{className:"status-badge pending",children:"PENDING"})}),(0,y.jsx)("td",{className:"table-cell",children:(0,y.jsx)("button",{className:"action-btn small",onClick:()=>Ue(e),children:"Review KYC"})})]},e.id)))})]})})})]})}):(0,y.jsxs)(y.Fragment,{children:["overview"===f&&(()=>{const e=Be();return(0,y.jsxs)("div",{className:"overview-section",children:[(0,y.jsxs)("div",{className:"overview-header",children:[(0,y.jsx)("h2",{className:"overview-title",children:"Admin Dashboard Overview"}),(0,y.jsx)("p",{className:"overview-description",children:"Manage farmers, employees, and assignments efficiently."})]}),(0,y.jsxs)("div",{className:"stats-grid admin-stats-grid",children:[(0,y.jsxs)("div",{className:"stats-card assigned",children:[(0,y.jsx)("h3",{className:"stats-title",children:"Farmers"}),(0,y.jsx)("div",{className:"stats-number",children:e.totalFarmers})]}),(0,y.jsxs)("div",{className:"stats-card approved",children:[(0,y.jsx)("h3",{className:"stats-title",children:"Employees"}),(0,y.jsx)("div",{className:"stats-number",children:e.totalEmployees})]}),(0,y.jsxs)("div",{className:"stats-card refer",children:[(0,y.jsx)("h3",{className:"stats-title",children:"FPO"}),(0,y.jsx)("div",{className:"stats-number",children:"0"})]})]}),(0,y.jsxs)("div",{className:"bottom-sections",children:[(0,y.jsxs)("div",{className:"section-card",children:[(0,y.jsxs)("div",{className:"section-header",children:[(0,y.jsx)("h3",{children:"Recent Activities"}),(0,y.jsx)("button",{className:"section-link",onClick:()=>console.log("View All clicked"),children:"View All"})]}),(0,y.jsxs)("div",{className:"activities-list",children:[(0,y.jsxs)("div",{className:"activity-item success",children:[(0,y.jsx)("div",{className:"activity-icon",children:"\ud83d\udc64"}),(0,y.jsxs)("div",{className:"activity-content",children:[(0,y.jsx)("div",{className:"activity-text",children:"Farmer profile updated"}),(0,y.jsx)("div",{className:"activity-time",children:"20m ago"}),(0,y.jsx)("button",{className:"activity-badge success",children:"SUCCESS"})]})]}),(0,y.jsxs)("div",{className:"activity-item success",children:[(0,y.jsx)("div",{className:"activity-icon",children:"\ud83d\udc68\u200d\ud83d\udcbc"}),(0,y.jsxs)("div",{className:"activity-content",children:[(0,y.jsx)("div",{className:"activity-text",children:"Employee profile updated"}),(0,y.jsx)("div",{className:"activity-time",children:"10m ago"}),(0,y.jsx)("button",{className:"activity-badge success",children:"SUCCESS"})]})]}),(0,y.jsxs)("div",{className:"activity-item pending",children:[(0,y.jsx)("div",{className:"activity-icon",children:"\ud83d\udccb"}),(0,y.jsxs)("div",{className:"activity-content",children:[(0,y.jsx)("div",{className:"activity-text",children:"New registration pending approval"}),(0,y.jsx)("div",{className:"activity-time",children:"5m ago"}),(0,y.jsx)("button",{className:"activity-badge pending",children:"PENDING"})]})]})]})]}),(0,y.jsxs)("div",{className:"section-card",children:[(0,y.jsx)("div",{className:"section-header",children:(0,y.jsx)("h3",{children:"Quick Actions"})}),(0,y.jsxs)("div",{className:"quick-actions-grid",children:[(0,y.jsxs)("button",{className:"quick-action-btn primary",onClick:qe,children:[(0,y.jsx)("i",{className:"fas fa-user-plus"}),"Add Farmer"]}),(0,y.jsxs)("button",{className:"quick-action-btn secondary",onClick:Je,children:[(0,y.jsx)("i",{className:"fas fa-users"}),"View Farmers"]}),(0,y.jsxs)("button",{className:"quick-action-btn primary",onClick:Le,children:[(0,y.jsx)("i",{className:"fas fa-user-tie"}),"Add Employee"]}),(0,y.jsxs)("button",{className:"quick-action-btn secondary",onClick:We,children:[(0,y.jsx)("i",{className:"fas fa-user-tie"}),"View Employee"]}),(0,y.jsxs)("button",{className:"quick-action-btn primary",onClick:He,children:[(0,y.jsx)("i",{className:"fas fa-link"}),"Assign Farmers"]}),(0,y.jsxs)("button",{className:"quick-action-btn secondary",onClick:ze,children:[(0,y.jsx)("i",{className:"fas fa-clock"}),"Pending KYC"]})]})]})]})]})})(),"kyc-overview"===f&&(()=>{const e=Be();return(0,y.jsxs)("div",{className:"overview-section",children:[(0,y.jsxs)("div",{className:"overview-header",children:[(0,y.jsx)("h2",{className:"overview-title",children:"KYC Overview"}),(0,y.jsx)("p",{className:"overview-description",children:"Comprehensive view of KYC status across all farmers and employees."})]}),(0,y.jsxs)("div",{className:"kyc-breakdown",children:[(0,y.jsx)("h3",{children:"KYC Status Breakdown"}),(0,y.jsxs)("div",{className:"kyc-stats-grid",children:[(0,y.jsxs)("div",{className:"kyc-stat-card approved",children:[(0,y.jsx)("span",{className:"kyc-stat-number",children:e.approvedKYC}),(0,y.jsx)("span",{className:"kyc-stat-label",children:"Approved"})]}),(0,y.jsxs)("div",{className:"kyc-stat-card pending",children:[(0,y.jsx)("span",{className:"kyc-stat-number",children:e.pendingKYC}),(0,y.jsx)("span",{className:"kyc-stat-label",children:"Pending"})]}),(0,y.jsxs)("div",{className:"kyc-stat-card refer-back",children:[(0,y.jsx)("span",{className:"kyc-stat-number",children:e.referBackKYC}),(0,y.jsx)("span",{className:"kyc-stat-label",children:"Refer Back"})]}),(0,y.jsxs)("div",{className:"kyc-stat-card rejected",children:[(0,y.jsx)("span",{className:"kyc-stat-number",children:e.rejectedKYC}),(0,y.jsx)("span",{className:"kyc-stat-label",children:"Rejected"})]})]})]}),(0,y.jsxs)("div",{className:"employee-stats",children:[(0,y.jsx)("h3",{children:"Employee KYC Progress"}),(0,y.jsx)("div",{className:"employee-stats-grid",children:A.map((e=>{const s=(S||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,l=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,t=s.filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,i=s.filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return(0,y.jsxs)("div",{className:"employee-stat-card",children:[(0,y.jsxs)("div",{className:"employee-info",children:[(0,y.jsx)("h4",{children:e.name}),(0,y.jsxs)("p",{children:[e.designation," - ",e.district]})]}),(0,y.jsxs)("div",{className:"employee-kyc-stats",children:[(0,y.jsxs)("div",{className:"kyc-stat",children:[(0,y.jsx)("span",{className:"stat-number",children:s.length}),(0,y.jsx)("span",{className:"stat-label",children:"Total Assigned"})]}),(0,y.jsxs)("div",{className:"kyc-stat",children:[(0,y.jsx)("span",{className:"stat-number approved",children:a}),(0,y.jsx)("span",{className:"stat-label",children:"Approved"})]}),(0,y.jsxs)("div",{className:"kyc-stat",children:[(0,y.jsx)("span",{className:"stat-number pending",children:l}),(0,y.jsx)("span",{className:"stat-label",children:"Pending"})]}),(0,y.jsxs)("div",{className:"kyc-stat",children:[(0,y.jsx)("span",{className:"stat-number refer-back",children:t}),(0,y.jsx)("span",{className:"stat-label",children:"Refer Back"})]}),(0,y.jsxs)("div",{className:"kyc-stat",children:[(0,y.jsx)("span",{className:"stat-number rejected",children:i}),(0,y.jsx)("span",{className:"stat-label",children:"Rejected"})]})]})]},e.id)}))})]}),(0,y.jsxs)("div",{className:"kyc-progress-section",children:[(0,y.jsx)("h3",{children:"KYC Progress Overview"}),(0,y.jsxs)("div",{className:"kyc-progress-grid",children:[(0,y.jsxs)("div",{className:"progress-card approved",children:[(0,y.jsx)("div",{className:"progress-circle",children:(0,y.jsx)("div",{className:"progress-number",children:e.approvedKYC})}),(0,y.jsx)("div",{className:"progress-label",children:"Approved KYC"})]}),(0,y.jsxs)("div",{className:"progress-card pending",children:[(0,y.jsx)("div",{className:"progress-circle",children:(0,y.jsx)("div",{className:"progress-number",children:e.pendingKYC})}),(0,y.jsx)("div",{className:"progress-label",children:"Pending KYC"})]}),(0,y.jsxs)("div",{className:"progress-card refer-back",children:[(0,y.jsx)("div",{className:"progress-circle",children:(0,y.jsx)("div",{className:"progress-number",children:e.referBackKYC})}),(0,y.jsx)("div",{className:"progress-label",children:"Refer Back"})]}),(0,y.jsxs)("div",{className:"progress-card rejected",children:[(0,y.jsx)("div",{className:"progress-circle",children:(0,y.jsx)("div",{className:"progress-number",children:e.rejectedKYC})}),(0,y.jsx)("div",{className:"progress-label",children:"Rejected KYC"})]})]})]})]})})(),"farmers"===f&&(()=>{const e=(S||[]).filter((e=>{const s=!pe.state||e.state===pe.state,a=!pe.district||e.district===pe.district,l=!pe.kycStatus||e.kycStatus===pe.kycStatus,t=!pe.employeeFilter||e.assignedEmployee===pe.employeeFilter;return s&&a&&l&&t}));return(0,y.jsx)("div",{className:"overview-section",children:de||Y?de?(0,y.jsxs)("div",{className:"farmer-registration-section",children:[(0,y.jsxs)("div",{className:"section-header",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"section-title",children:"Add New Farmer"}),(0,y.jsx)("p",{className:"section-description",children:"Fill in the farmer details to create a new farmer account."})]}),(0,y.jsx)("div",{className:"section-actions",children:(0,y.jsxs)("button",{className:"action-btn-small secondary",onClick:()=>me(!1),children:[(0,y.jsx)("i",{className:"fas fa-arrow-left"}),"Back to Farmers"]})})]}),(0,y.jsx)(c.A,{isInDashboard:!0,onClose:()=>me(!1),onSubmit:async e=>{try{const s=await r.xs.createFarmer(e);E((e=>[...e,s])),alert("Farmer created successfully!"),me(!1)}catch(s){console.error("Error creating farmer:",s),alert("Failed to create farmer. Please try again.")}}})]}):Y?(0,y.jsxs)("div",{className:"farmer-details-section",children:[(0,y.jsxs)("div",{className:"section-header",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"section-title",children:"Farmer Details"}),(0,y.jsxs)("p",{className:"section-description",children:["View detailed information for ",(null===B||void 0===B?void 0:B.name)||"selected farmer","."]})]}),(0,y.jsx)("div",{className:"section-actions",children:(0,y.jsxs)("button",{className:"action-btn-small secondary",onClick:()=>O(!1),children:[(0,y.jsx)("i",{className:"fas fa-arrow-left"}),"Back to Farmers"]})})]}),(0,y.jsx)(h.A,{isInDashboard:!0,farmerData:B,onClose:()=>O(!1)})]}):null:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"overview-header",children:[(0,y.jsx)("h2",{className:"overview-title",children:"Farmer Management"}),(0,y.jsx)("p",{className:"overview-description",children:"View and manage all farmer profiles with KYC status and assignments."}),(0,y.jsxs)("div",{className:"overview-actions",children:[(0,y.jsx)("button",{className:"action-btn primary",onClick:()=>me(!0),children:"Add Farmer"}),(0,y.jsx)("button",{className:"action-btn secondary",onClick:()=>P(!0),children:"Assign Farmers"})]})]}),(0,y.jsxs)("div",{className:"filters-section",children:[(0,y.jsx)("div",{className:"filter-group",children:(0,y.jsxs)("select",{className:"filter-select",value:pe.state,onChange:e=>ve((s=>({...s,state:e.target.value}))),children:[(0,y.jsx)("option",{value:"",children:"All States"}),(0,y.jsx)("option",{value:"Telangana",children:"Telangana"}),(0,y.jsx)("option",{value:"Andhra Pradesh",children:"Andhra Pradesh"}),(0,y.jsx)("option",{value:"Karnataka",children:"Karnataka"}),(0,y.jsx)("option",{value:"Tamil Nadu",children:"Tamil Nadu"})]})}),(0,y.jsx)("div",{className:"filter-group",children:(0,y.jsxs)("select",{className:"filter-select",value:pe.district,onChange:e=>ve((s=>({...s,district:e.target.value}))),children:[(0,y.jsx)("option",{value:"",children:"All Districts"}),(0,y.jsx)("option",{value:"Hanumakonda",children:"Hanumakonda"}),(0,y.jsx)("option",{value:"Warangal",children:"Warangal"}),(0,y.jsx)("option",{value:"Karimnagar",children:"Karimnagar"}),(0,y.jsx)("option",{value:"Nizamabad",children:"Nizamabad"})]})}),(0,y.jsx)("div",{className:"filter-group",children:(0,y.jsxs)("select",{className:"filter-select",value:pe.kycStatus,onChange:e=>ve((s=>({...s,kycStatus:e.target.value}))),children:[(0,y.jsx)("option",{value:"",children:"All KYC Status"}),(0,y.jsx)("option",{value:"APPROVED",children:"Approved"}),(0,y.jsx)("option",{value:"PENDING",children:"Pending"}),(0,y.jsx)("option",{value:"REFER_BACK",children:"Refer Back"}),(0,y.jsx)("option",{value:"REJECTED",children:"Rejected"}),(0,y.jsx)("option",{value:"NOT_STARTED",children:"Not Started"})]})}),(0,y.jsx)("div",{className:"filter-group",children:(0,y.jsxs)("select",{className:"filter-select",value:pe.assignmentStatus,onChange:e=>ve((s=>({...s,assignmentStatus:e.target.value}))),children:[(0,y.jsx)("option",{value:"",children:"All Assignment Status"}),(0,y.jsx)("option",{value:"ASSIGNED",children:"Assigned"}),(0,y.jsx)("option",{value:"UNASSIGNED",children:"Unassigned"})]})}),(0,y.jsx)("div",{className:"filter-group",children:(0,y.jsxs)("select",{className:"filter-select",value:pe.assignedEmployee,onChange:e=>ve((s=>({...s,assignedEmployee:e.target.value}))),children:[(0,y.jsx)("option",{value:"",children:"All Employees"}),A.map((e=>(0,y.jsx)("option",{value:e.id,children:e.name},e.id)))]})}),(0,y.jsx)("button",{className:"clear-filters-btn",onClick:()=>ve({state:"",district:"",region:"",kycStatus:"",assignmentStatus:"",assignedEmployee:""}),children:"Clear Filters"})]}),(0,y.jsx)(p.A,{data:e,columns:[{key:"name",label:"NAME",className:"col-name",render:(e,s)=>e||s.fullName||s.userName||s.firstName||"N/A"},{key:"phoneNumber",label:"PHONE",className:"col-phone",render:(e,s)=>e||s.phone||s.contactNumber||s.mobileNumber||"N/A"},{key:"state",label:"STATE",className:"col-state",render:(e,s)=>e||s.state||"N/A"},{key:"district",label:"DISTRICT",className:"col-district",render:(e,s)=>e||s.district||"N/A"},{key:"kycStatus",label:"KYC STATUS",className:"col-kyc",type:"status",render:(e,s)=>e||s.kycStatus||"NOT_STARTED"},{key:"assignedEmployee",label:"ASSIGNED EMPLOYEE",className:"col-employee",render:(e,s)=>"object"===typeof e&&e?e.name||e.firstName+" "+e.lastName||"N/A":e||s.assignedEmployeeName||"Not Assigned"}],actions:[{label:"View",className:"action-btn-small primary",onClick:Ge},{label:"Edit",className:"action-btn-small secondary",onClick:Ve},{label:"KYC",className:"action-btn-small warning",onClick:Ue}]})]})})})(),"employees"===f&&(()=>{const e=(A||[]).filter((e=>!pe.district||e.district===pe.district));return(0,y.jsx)("div",{className:"overview-section",children:ce?(0,y.jsxs)("div",{className:"employee-registration-section",children:[(0,y.jsxs)("div",{className:"section-header",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"section-title",children:"Add New Employee"}),(0,y.jsx)("p",{className:"section-description",children:"Fill in the employee details to create a new employee account."})]}),(0,y.jsx)("div",{className:"section-actions",children:(0,y.jsxs)("button",{className:"action-btn-small secondary",onClick:()=>oe(!1),children:[(0,y.jsx)("i",{className:"fas fa-arrow-left"}),"Back to Employees"]})})]}),(0,y.jsx)(o.A,{isInDashboard:!0,onClose:()=>oe(!1),onSubmit:async e=>{try{const s=await r.s2.createEmployee(e);C((e=>[...e,s])),alert("Employee created successfully!"),oe(!1)}catch(s){console.error("Error creating employee:",s),alert("Failed to create employee. Please try again.")}}})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"overview-header",children:[(0,y.jsx)("h2",{className:"overview-title",children:"Employee Management"}),(0,y.jsx)("p",{className:"overview-description",children:"View and manage employee profiles with KYC assignment statistics."}),(0,y.jsx)("div",{className:"overview-actions",children:(0,y.jsx)("button",{className:"action-btn primary",onClick:()=>oe(!0),children:"Add Employee"})})]}),(0,y.jsxs)("div",{className:"employee-stats",children:[(0,y.jsx)("h3",{children:"Employee KYC Progress"}),(0,y.jsx)("div",{className:"employee-stats-grid",children:A.map((e=>{const s=(S||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,l=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length,t=s.filter((e=>"REFER_BACK"===e.kycStatus||"refer_back"===e.kycStatus)).length,i=s.filter((e=>"REJECTED"===e.kycStatus||"rejected"===e.kycStatus)).length;return(0,y.jsxs)("div",{className:"employee-stat-card",children:[(0,y.jsxs)("div",{className:"employee-info",children:[(0,y.jsx)("h4",{children:e.name}),(0,y.jsxs)("p",{children:[e.designation," - ",e.district]})]}),(0,y.jsxs)("div",{className:"employee-kyc-stats",children:[(0,y.jsxs)("div",{className:"kyc-stat",children:[(0,y.jsx)("span",{className:"stat-number",children:s.length}),(0,y.jsx)("span",{className:"stat-label",children:"Total Assigned"})]}),(0,y.jsxs)("div",{className:"kyc-stat",children:[(0,y.jsx)("span",{className:"stat-number approved",children:a}),(0,y.jsx)("span",{className:"stat-label",children:"Approved"})]}),(0,y.jsxs)("div",{className:"kyc-stat",children:[(0,y.jsx)("span",{className:"stat-number pending",children:l}),(0,y.jsx)("span",{className:"stat-label",children:"Pending"})]}),(0,y.jsxs)("div",{className:"kyc-stat",children:[(0,y.jsx)("span",{className:"stat-number refer-back",children:t}),(0,y.jsx)("span",{className:"stat-label",children:"Refer Back"})]}),(0,y.jsxs)("div",{className:"kyc-stat",children:[(0,y.jsx)("span",{className:"stat-number rejected",children:i}),(0,y.jsx)("span",{className:"stat-label",children:"Rejected"})]})]})]},e.id)}))})]}),(0,y.jsx)(p.A,{data:e.map((e=>{const s=(S||[]).filter((s=>s.assignedEmployee===e.name||s.assignedEmployee===e.contactNumber||s.assignedEmployeeId===e.id)),a=s.filter((e=>"APPROVED"===e.kycStatus||"approved"===e.kycStatus)).length,l=s.filter((e=>"PENDING"===e.kycStatus||"pending"===e.kycStatus||"NOT_STARTED"===e.kycStatus||"not_started"===e.kycStatus)).length;return{...e,totalAssigned:s.length,approvedKyc:a,pendingKyc:l}})),columns:[{key:"name",label:"Name"},{key:"contactNumber",label:"Contact"},{key:"email",label:"Email"},{key:"state",label:"State"},{key:"district",label:"District"},{key:"totalAssigned",label:"Assigned Farmers"},{key:"approvedKyc",label:"Approved KYC"},{key:"pendingKyc",label:"Pending KYC"}],customActions:[{label:"View",className:"action-btn-small info",onClick:_e},{label:"Edit",className:"action-btn-small primary",onClick:Me}]})]})})})(),"registration"===f&&(()=>{const e=(()=>{console.log("\ud83d\udd0d All registrations:",Z),console.log("\ud83d\udd0d Sample registration structure:",Z[0]);const e=(Z||[]).filter((e=>{const s=!he.role||e.role===he.role,a=!he.status||e.status===he.status;return s&&a}));return console.log("\u2705 Filtered registrations:",e),e})();return(0,y.jsxs)("div",{className:"registration-section",children:[(0,y.jsxs)("div",{className:"section-header",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("h2",{className:"section-title",children:"Registration Management"}),(0,y.jsx)("p",{className:"section-description",children:"Review and manage user registration requests."})]}),(0,y.jsx)("div",{className:"section-actions",children:(0,y.jsxs)("button",{className:"action-btn-small primary",onClick:()=>{console.log("\ud83d\udd04 Manually refreshing data..."),Te()},children:[(0,y.jsx)("i",{className:"fas fa-sync-alt"}),"Refresh Data"]})})]}),(0,y.jsxs)("div",{className:"filters-section",children:[(0,y.jsx)("div",{className:"filter-group",children:(0,y.jsxs)("select",{className:"filter-select",value:he.role,onChange:e=>ue((s=>({...s,role:e.target.value}))),children:[(0,y.jsx)("option",{value:"",children:"All Roles"}),(0,y.jsx)("option",{value:"FARMER",children:"Farmer"}),(0,y.jsx)("option",{value:"EMPLOYEE",children:"Employee"}),(0,y.jsx)("option",{value:"ADMIN",children:"Admin"})]})}),(0,y.jsx)("div",{className:"filter-group",children:(0,y.jsxs)("select",{className:"filter-select",value:he.status,onChange:e=>ue((s=>({...s,status:e.target.value}))),children:[(0,y.jsx)("option",{value:"",children:"All Status"}),(0,y.jsx)("option",{value:"PENDING",children:"Pending"}),(0,y.jsx)("option",{value:"APPROVED",children:"Approved"}),(0,y.jsx)("option",{value:"REJECTED",children:"Rejected"})]})})]}),(0,y.jsx)(p.A,{data:e,columns:[{key:"name",label:"Name",className:"col-name",render:(e,s)=>e||s.fullName||s.userName||s.firstName||"N/A"},{key:"email",label:"Email",className:"col-email",render:(e,s)=>e||s.emailAddress||s.userEmail||"N/A"},{key:"phoneNumber",label:"Phone",className:"col-phone",render:(e,s)=>e||s.phone||s.mobile||s.contactNumber||s.mobileNumber||"N/A"},{key:"role",label:"Role",className:"col-role",render:(e,s)=>e||s.userRole||s.type||s.userType||"N/A"},{key:"status",label:"Status",className:"col-status",type:"status",render:(e,s)=>e||s.registrationStatus||s.approvalStatus||s.kycStatus||"N/A"}],customActions:[{label:"View",className:"action-btn-small info",onClick:Ke},{label:"Approve",className:"action-btn-small success",onClick:e=>Ye(e.id),show:e=>"PENDING"===e.status},{label:"Reject",className:"action-btn-small danger",onClick:e=>Oe(e.id),show:e=>"PENDING"===e.status}]})]})})()]}),(0,y.jsx)(b,{})]})}),D&&(0,y.jsx)(d.A,{farmers:S.filter((e=>!e.assignedEmployee||"Not Assigned"===e.assignedEmployee||null===e.assignedEmployee||void 0===e.assignedEmployee||""===e.assignedEmployee)),employees:A,onClose:()=>P(!1),onAssign:async e=>{try{var s;const t=e.map((e=>e.farmerId)),i=null===(s=e[0])||void 0===s?void 0:s.employeeId;if(!i||0===t.length)return void alert("Please select an employee and at least one farmer");try{await r.Er.bulkAssignFarmers(t,i)}catch(a){console.log("Bulk assign failed, trying individual assignments...");for(const e of t)try{await r.Er.assignFarmer(e,i)}catch(l){console.error(`Failed to assign farmer ${e}:`,l)}}E((s=>s.map((s=>{const a=e.find((e=>e.farmerId===s.id));return a?{...s,assignmentStatus:"ASSIGNED",assignedEmployee:a.employeeName,assignedDate:(new Date).toISOString().split("T")[0]}:s})))),P(!1),alert("Farmers assigned successfully!")}catch(t){console.error("Error assigning farmers:",t),alert("Failed to assign farmers")}}}),_&&V&&(0,y.jsx)(u.A,{employee:V,onClose:()=>{U(!1),M(null)},onUpdate:e=>{C((s=>s.map((s=>s.id===e.id?e:s)))),U(!1),M(null)}}),q&&L&&(0,y.jsx)(m.A,{farmer:L,onClose:()=>{J(!1),W(null)},onApprove:(e,s)=>{E((s=>s.map((s=>s.id===e?{...s,kycStatus:"APPROVED"}:s)))),J(!1),W(null)},onReject:(e,s,a)=>{E((s=>s.map((s=>s.id===e?{...s,kycStatus:"REJECTED"}:s)))),J(!1),W(null)},onReferBack:(e,s,a)=>{E((s=>s.map((s=>s.id===e?{...s,kycStatus:"REFER_BACK"}:s)))),J(!1),W(null)}}),te&&re&&(0,y.jsx)(j.A,{registration:re,onClose:()=>{ie(!1),ne(null)},onUpdate:()=>{Te()},onApprove:Ye,onReject:Oe}),Fe&&(0,y.jsxs)("div",{className:`notification-toast ${Fe.type}`,children:[(0,y.jsx)("span",{children:Fe.message}),(0,y.jsx)("button",{onClick:()=>Ie(null),children:"\xd7"})]})]})}},8756:(e,s,a)=>{a(5043),a(579)}}]);
//# sourceMappingURL=416.1f814ad4.chunk.js.map