"use strict";(self.webpackChunkagristack_farmer_management=self.webpackChunkagristack_farmer_management||[]).push([[372],{476:(e,a,s)=>{s.d(a,{Dv:()=>n,Er:()=>l,JL:()=>c,R2:()=>i,kM:()=>m,s2:()=>d,xs:()=>o});var t=s(6213);const r=t.A.create({baseURL:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"http://localhost:8080/api",timeout:1e4,headers:{"Content-Type":"application/json"}});r.interceptors.request.use((e=>{const a=localStorage.getItem("token");return console.log("\ud83d\udd10 API Request - Token from localStorage:",a?"Present":"Missing"),console.log("\ud83d\udd10 API Request - URL:",e.url),console.log("\ud83d\udd10 API Request - Method:",e.method),a?(e.headers.Authorization=`Bearer ${a}`,console.log("\ud83d\udd10 API Request - Authorization header added")):console.log("\u26a0\ufe0f API Request - No token found in localStorage"),e}),(e=>(console.error("\u274c API Request interceptor error:",e),Promise.reject(e)))),r.interceptors.response.use((e=>e),(e=>{var a,s,t,r,i,n;if(console.error("\u274c API Response Error:",{status:null===(a=e.response)||void 0===a?void 0:a.status,statusText:null===(s=e.response)||void 0===s?void 0:s.statusText,url:null===(t=e.config)||void 0===t?void 0:t.url,method:null===(r=e.config)||void 0===r?void 0:r.method,message:e.message}),401===(null===(i=e.response)||void 0===i?void 0:i.status)||403===(null===(n=e.response)||void 0===n?void 0:n.status)){console.error("\ud83d\udd10 Authentication failed - clearing tokens and redirecting to login");["token","user","authToken","jwtToken","accessToken","refreshToken","auth","session","login"].forEach((e=>{localStorage.removeItem(e),sessionStorage.removeItem(e)})),localStorage.clear(),sessionStorage.clear(),document.cookie.split(";").forEach((function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")})),window.location.pathname.includes("/login")||(window.location.href="/login")}return Promise.reject(e)}));const i={login:async e=>(await r.post("/auth/login",e)).data,getProfile:async()=>(await r.get("/auth/profile")).data,register:async e=>(await r.post("/auth/register",e)).data,sendOTP:async e=>(await r.post("/auth/send-otp",{emailOrPhone:e})).data,verifyOTP:async e=>(await r.post("/auth/verify-otp",{emailOrPhone:e.email,otp:e.otp})).data,resendOTP:async e=>(await r.post("/auth/resend-otp",{emailOrPhone:e})).data,forgotPassword:async e=>(await r.post("/auth/forgot-password",{emailOrPhone:e})).data,forgotUserId:async e=>(await r.post("/auth/forgot-user-id",{emailOrPhone:e})).data,resetPassword:async e=>(await r.post("/auth/reset-password",e)).data,changePassword:async e=>(await r.post("/auth/change-password",e)).data,resetPasswordConfirm:async e=>(await r.post("/auth/reset-password/confirm",e)).data,changeUserId:async e=>(await r.post("/auth/change-user-id",e)).data,getCountries:async()=>(await r.get("/auth/countries")).data,getStates:async e=>(await r.post("/auth/states",{countryId:e})).data},n={getAllUsers:async()=>(await r.get("/super-admin/registration-list")).data,getRegistrationList:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await r.get("/super-admin/registration-list",{params:e})).data},getRegistrationListByStatus:async e=>(await r.get("/super-admin/registration-list/filter",{params:{status:e}})).data,searchRegistrations:async e=>(await r.get("/super-admin/registration-list/search",{params:{query:e}})).data,getPendingRegistrations:async()=>(await r.get("/super-admin/pending-registrations")).data,getApprovedUsers:async()=>(await r.get("/super-admin/approved-users")).data,getUsersByRole:async e=>(await r.get(`/super-admin/users/by-role/${e}`)).data,getPendingUsersByRole:async e=>(await r.get(`/super-admin/pending-users/by-role/${e}`)).data,approveUser:async(e,a)=>(await r.put(`/auth/users/${e}/approve`,{role:a})).data,rejectUser:async(e,a)=>(await r.put(`/auth/users/${e}/status`,{status:"REJECTED"})).data,deleteUser:async e=>(await r.delete(`/super-admin/users/${e}`)).data,updateUser:async(e,a)=>(await r.put(`/super-admin/users/${e}`,a)).data,updateUserStatus:async(e,a)=>(await r.put(`/auth/users/${e}/status`,{status:a})).data,getDashboardStats:async()=>(await r.get("/super-admin/dashboard/stats")).data,bulkAssignFarmers:async(e,a)=>(await r.post("/super-admin/bulk-assign-farmers",{farmerIds:e,employeeId:a})).data,assignFarmer:async(e,a)=>(await r.post("/super-admin/assign-farmer",null,{params:{farmerId:e,employeeId:a}})).data},o={getAllFarmers:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await r.get("/super-admin/farmers",{params:e})).data},getFarmerById:async e=>(await r.get(`/super-admin/farmers/${e}`)).data,createFarmer:async e=>(await r.post("/super-admin/farmers",e)).data,updateFarmer:async(e,a)=>(await r.put(`/super-admin/farmers/${e}`,a)).data,deleteFarmer:async e=>(await r.delete(`/super-admin/farmers/${e}`)).data,assignFarmer:async(e,a)=>(await r.post(`/super-admin/farmers/${e}/assign`,{employeeId:a})).data,getFarmerStats:async()=>(await r.get("/super-admin/farmers/stats")).data},l={getAllFarmers:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await r.get("/admin/farmers",{params:e})).data},getAllEmployees:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await r.get("/admin/employees",{params:e})).data},getFarmersWithKyc:async()=>(await r.get("/admin/farmers-with-kyc")).data,getEmployeesWithStats:async()=>(await r.get("/admin/employees-with-stats")).data,getFarmersByEmployee:async e=>(await r.get(`/admin/employees/${e}/assigned-farmers`)).data,getTodoList:async()=>(await r.get("/admin/todo-list")).data,getEnhancedTodoList:async()=>(await r.get("/admin/enhanced-todo-list")).data,getDashboardStats:async()=>(await r.get("/admin/dashboard-stats")).data,filterFarmers:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await r.get("/admin/farmers/filter",{params:e})).data},getLocations:async()=>(await r.get("/admin/locations")).data,bulkAssignFarmers:async(e,a)=>(await r.post("/admin/bulk-assign-farmers",{farmerIds:e,employeeId:a})).data,assignFarmer:async(e,a)=>(await r.post("/admin/assign-farmer",null,{params:{farmerId:e,employeeId:a}})).data,getAssignmentHistory:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await r.get("/admin/assignment-history",{params:e})).data},getFarmersByAssignmentStatus:async e=>(await r.get("/admin/farmers/by-assignment-status",{params:{assignmentStatus:e}})).data,getAllRegistrations:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await r.get("/admin/registration-list",{params:e})).data},getRegistrationListByStatus:async e=>(await r.get("/admin/registration-list/filter",{params:{status:e}})).data,approveRegistration:async(e,a)=>(await r.post(`/admin/registrations/${e}/approve`,a)).data,rejectRegistration:async(e,a)=>(await r.post(`/admin/registrations/${e}/reject`,a)).data},d={getAllEmployees:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await r.get("/super-admin/employees",{params:e})).data},getEmployeeById:async e=>(await r.get(`/super-admin/employees/${e}`)).data,createEmployee:async e=>(await r.post("/super-admin/employees",e)).data,updateEmployee:async(e,a)=>(await r.put(`/super-admin/employees/${e}`,a)).data,deleteEmployee:async e=>(await r.delete(`/super-admin/employees/${e}`)).data,getEmployeeStats:async()=>(await r.get("/super-admin/employees/stats")).data},c={getAssignedFarmers:async()=>(await r.get("/employee/assigned-farmers")).data,getFarmerById:async e=>(await r.get(`/employee/farmers/${e}`)).data,updateFarmer:async(e,a)=>(await r.put(`/employee/farmers/${e}`,a)).data,getProfile:async()=>(await r.get("/employee/profile")).data,updateProfile:async e=>(await r.put("/employee/profile",e)).data},m={approveKYC:async(e,a)=>(await r.post(`/kyc/${e}/approve`,a)).data,rejectKYC:async(e,a)=>(await r.post(`/kyc/${e}/reject`,a)).data,referBackKYC:async(e,a)=>(await r.post(`/kyc/${e}/refer-back`,a)).data,getKYCStatus:async e=>(await r.get(`/kyc/${e}/status`)).data,uploadKYCDocuments:async(e,a)=>{const s=new FormData;Object.keys(a).forEach((e=>{a[e]&&(Array.isArray(a[e])?a[e].forEach(((a,t)=>{s.append(`${e}[${t}]`,a)})):s.append(e,a[e]))}));const r=t.A.create({baseURL:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"http://localhost:8080/api",timeout:3e4});r.interceptors.request.use((e=>{const a=localStorage.getItem("token");return a&&(e.headers.Authorization=`Bearer ${a}`),e}));return(await r.post(`/kyc/${e}/upload`,s,{headers:{"Content-Type":"multipart/form-data"}})).data},getKYCHistory:async e=>(await r.get(`/kyc/${e}/history`)).data,getKYCDocumentUrl:async(e,a)=>(await r.get(`/kyc/${e}/documents/${a}/download`)).data,deleteKYCDocument:async(e,a)=>(await r.delete(`/kyc/${e}/documents/${a}`)).data}},4003:()=>{},4513:(e,a,s)=>{e.exports=s.p+"static/media/rightlogo.1742b4514aa334820279.png"},7372:(e,a,s)=>{s.r(a),s.d(a,{default:()=>p});var t=s(5043),r=s(4858),i=s(8403),n=s(899),o=s(476),l=s(3216),d=s(5475),c=s(4513),m=(s(4003),s(579));const g=n.Ik().shape({name:n.Yj().required("Name is required"),dateOfBirth:n.Yj().required("Date of Birth is required").test("age-range","Age must be between 18 and 90 years",(function(e){if(!e)return!1;const a=new Date(e),s=new Date,t=new Date(s-a),r=Math.abs(t.getUTCFullYear()-1970);return r>=18&&r<=90})),gender:n.Yj().required("Gender is required"),email:n.Yj().required("Email is required").matches(/^[^\s@]+@[^\s@]+\.[^\s@]+$/,"Email must include @ and be valid"),phoneNumber:n.Yj().matches(/^\d{10}$/,"Enter a valid 10-digit phone number").required("Phone number is required"),role:n.Yj().required("Role is required"),password:n.Yj().required("Password is required").min(8,"Password must be at least 8 characters").matches(/[A-Z]/,"Password must contain at least one uppercase letter").matches(/[a-z]/,"Password must contain at least one lowercase letter").matches(/[0-9]/,"Password must contain at least one number").matches(/[@$!%*?&#^()_+\-=[\]{};':"\\|,.<>/?]/,"Password must contain at least one special character")}),p=()=>{var e;const a=(null===(e=(0,l.zy)().state)||void 0===e?void 0:e.role)||"",{register:s,handleSubmit:n,reset:p,formState:{errors:u}}=(0,r.mN)({resolver:(0,i.t)(g),defaultValues:{role:a}}),[h,y]=(0,t.useState)(""),[f,w]=(0,t.useState)(!1),[j,v]=(0,t.useState)(""),[x,N]=(0,t.useState)(!1),[b,P]=(0,t.useState)(0);(0,t.useEffect)((()=>{if(!b)return;const e=setTimeout((()=>P((e=>e-1))),1e3);return()=>clearTimeout(e)}),[b]);const E=async()=>{if(h.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/))try{await o.R2.sendOTP(h),w(!0),P(30),alert("OTP sent")}catch(s){var e,a;alert((null===(e=s.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||"Failed to send OTP"),console.error(s)}else alert("Enter a valid email first")};return(0,m.jsx)("div",{className:"login-page-container",children:(0,m.jsxs)("div",{className:"login-page-main-content",children:[(0,m.jsxs)("div",{className:"login-page-info-panel",children:[(0,m.jsxs)("div",{className:"login-page-brand-header",children:[(0,m.jsxs)("div",{className:"login-page-brand-logo",children:[(0,m.jsx)("span",{className:"login-page-brand-text",children:"Date"}),(0,m.jsx)("span",{className:"login-page-brand-accent",children:"Agri"}),(0,m.jsx)("span",{className:"login-page-brand-icon",children:"\ud83c\udf3f"}),(0,m.jsx)("span",{className:"login-page-brand-text",children:"Stack"})]}),(0,m.jsx)("h1",{className:"login-page-main-title",children:"India Farmer Registry"})]}),(0,m.jsxs)("div",{className:"login-page-platform-info",children:[(0,m.jsx)("h2",{children:"Join Our Platform"}),(0,m.jsx)("p",{className:"login-page-tagline",children:"Become part of India's agricultural revolution"})]}),(0,m.jsxs)("div",{className:"login-page-features-grid",children:[(0,m.jsxs)("div",{className:"login-page-feature-card",children:[(0,m.jsx)("div",{className:"login-page-feature-icon",children:"\ud83d\ude80"}),(0,m.jsxs)("div",{className:"login-page-feature-content",children:[(0,m.jsx)("h3",{children:"Quick Registration"}),(0,m.jsx)("p",{children:"Get started in minutes with our streamlined signup process"})]})]}),(0,m.jsxs)("div",{className:"login-page-feature-card",children:[(0,m.jsx)("div",{className:"login-page-feature-icon",children:"\ud83d\udd12"}),(0,m.jsxs)("div",{className:"login-page-feature-content",children:[(0,m.jsx)("h3",{children:"Secure Verification"}),(0,m.jsx)("p",{children:"Email verification ensures your account security"})]})]}),(0,m.jsxs)("div",{className:"login-page-feature-card",children:[(0,m.jsx)("div",{className:"login-page-feature-icon",children:"\ud83d\udccb"}),(0,m.jsxs)("div",{className:"login-page-feature-content",children:[(0,m.jsx)("h3",{children:"Easy Profile Setup"}),(0,m.jsx)("p",{children:"Simple form to create your personalized account"})]})]}),(0,m.jsxs)("div",{className:"login-page-feature-card",children:[(0,m.jsx)("div",{className:"login-page-feature-icon",children:"\u26a1"}),(0,m.jsxs)("div",{className:"login-page-feature-content",children:[(0,m.jsx)("h3",{children:"Instant Access"}),(0,m.jsx)("p",{children:"Start using platform features immediately after approval"})]})]}),(0,m.jsxs)("div",{className:"login-page-feature-card",children:[(0,m.jsx)("div",{className:"login-page-feature-icon",children:"\ud83c\udfaf"}),(0,m.jsxs)("div",{className:"login-page-feature-content",children:[(0,m.jsx)("h3",{children:"Tailored Experience"}),(0,m.jsx)("p",{children:"Customized dashboard based on your role and needs"})]})]})]})]}),(0,m.jsx)("div",{className:"login-page-form-section",children:(0,m.jsxs)("div",{className:"login-page-card",children:[(0,m.jsxs)("div",{className:"login-page-date-logo-section",children:[(0,m.jsx)("img",{src:c,alt:"DATE Logo",className:"login-page-date-logo"}),(0,m.jsxs)("div",{className:"login-page-date-text",children:[(0,m.jsx)("h3",{children:"Digital Agristack Transaction Enterprises"}),(0,m.jsx)("p",{children:"Empowering Agricultural Excellence"})]})]}),(0,m.jsxs)("div",{className:"login-page-login-type-section",children:[(0,m.jsx)("h3",{children:"Registration Form"}),(0,m.jsx)("p",{children:"Enter your details to get started"})]}),(0,m.jsxs)("form",{onSubmit:n((async e=>{if(x)try{console.log("Submitting registration data:",e);const a=await o.R2.register(e);console.log("Registration successful:",a),alert("Registration successful! Please wait for admin approval. You will receive an email with login credentials once approved."),p(),N(!1),w(!1),y(""),v("")}catch(a){console.error("Registration error:",a),alert("Registration failed. Please try again.")}else alert("Please verify your email before submitting.")})),className:"login-page-form",children:[(0,m.jsx)("input",{type:"hidden",...s("role"),value:a}),a&&(0,m.jsxs)("div",{className:"login-page-form-field",children:[(0,m.jsx)("label",{children:"Role"}),(0,m.jsx)("input",{type:"text",value:a,readOnly:!0,className:"login-page-form-input role-field"})]}),(0,m.jsxs)("div",{className:"form-fields-grid",children:[(0,m.jsxs)("div",{className:"form-row",children:[(0,m.jsxs)("div",{className:"login-page-form-field",children:[(0,m.jsxs)("label",{children:["Name ",(0,m.jsx)("span",{className:"required",children:"*"})]}),(0,m.jsx)("input",{type:"text",...s("name"),className:"login-page-form-input "+(u.name?"error":""),placeholder:"Enter your first name"}),u.name&&(0,m.jsx)("span",{className:"error-message",children:u.name.message})]}),(0,m.jsxs)("div",{className:"login-page-form-field",children:[(0,m.jsxs)("label",{children:["Gender ",(0,m.jsx)("span",{className:"required",children:"*"})]}),(0,m.jsxs)("select",{...s("gender"),className:"login-page-form-input "+(u.gender?"error":""),children:[(0,m.jsx)("option",{value:"",children:"Select gender"}),(0,m.jsx)("option",{value:"Male",children:"Male"}),(0,m.jsx)("option",{value:"Female",children:"Female"}),(0,m.jsx)("option",{value:"Other",children:"Other"})]}),u.gender&&(0,m.jsx)("span",{className:"error-message",children:u.gender.message})]})]}),(0,m.jsxs)("div",{className:"form-row",children:[(0,m.jsxs)("div",{className:"login-page-form-field",children:[(0,m.jsxs)("label",{children:["Date of Birth ",(0,m.jsx)("span",{className:"required",children:"*"})]}),(0,m.jsx)("input",{type:"date",...s("dateOfBirth"),className:"login-page-form-input "+(u.dateOfBirth?"error":"")}),u.dateOfBirth&&(0,m.jsx)("span",{className:"error-message",children:u.dateOfBirth.message})]}),(0,m.jsxs)("div",{className:"login-page-form-field",children:[(0,m.jsxs)("label",{children:["Phone Number ",(0,m.jsx)("span",{className:"required",children:"*"})]}),(0,m.jsx)("input",{type:"text",...s("phoneNumber"),className:"login-page-form-input "+(u.phoneNumber?"error":""),placeholder:"Enter 10-digit number"}),u.phoneNumber&&(0,m.jsx)("span",{className:"error-message",children:u.phoneNumber.message})]})]}),(0,m.jsxs)("div",{className:"form-row",children:[(0,m.jsxs)("div",{className:"login-page-form-field",children:[(0,m.jsxs)("label",{children:["Email Address ",(0,m.jsx)("span",{className:"required",children:"*"})]}),(0,m.jsx)("input",{type:"email",...s("email"),value:h,onChange:e=>{y(e.target.value),w(!1),N(!1)},className:"login-page-form-input "+(u.email?"error":""),placeholder:"Enter your email"}),u.email&&(0,m.jsx)("span",{className:"error-message",children:u.email.message})]}),(0,m.jsxs)("div",{className:"login-page-form-field",children:[(0,m.jsxs)("label",{children:["Password ",(0,m.jsx)("span",{className:"required",children:"*"})]}),(0,m.jsx)("input",{type:"password",...s("password"),className:"login-page-form-input "+(u.password?"error":""),placeholder:"Enter a strong password",autoComplete:"new-password"}),u.password&&(0,m.jsx)("span",{className:"error-message",children:u.password.message})]})]})]}),(0,m.jsxs)("div",{className:"email-verification",children:[!f&&!x&&(0,m.jsx)("button",{type:"button",onClick:E,className:"login-page-login-btn",children:"Send OTP"}),f&&!x&&(0,m.jsxs)("div",{className:"otp-section",children:[(0,m.jsx)("input",{type:"text",placeholder:"Enter OTP",value:j,onChange:e=>v(e.target.value),className:"login-page-form-input"}),(0,m.jsxs)("div",{className:"otp-buttons",children:[(0,m.jsx)("button",{type:"button",onClick:E,className:"login-page-create-account-btn",disabled:b>0,children:b>0?`Resend (${b}s)`:"Resend"}),(0,m.jsx)("button",{type:"button",onClick:async()=>{try{await o.R2.verifyOTP({email:h,otp:j}),alert("Email verified successfully!"),N(!0)}catch(e){alert("OTP verification error."),console.error(e)}},className:"login-page-login-btn",children:"Verify"})]})]}),x&&(0,m.jsxs)("div",{className:"verification-success",children:[(0,m.jsx)("span",{className:"success-icon",children:"\u2713"}),"Email Verified"]})]}),(0,m.jsx)("div",{className:"login-page-actions-row",children:(0,m.jsx)("button",{type:"submit",className:"login-page-login-btn",children:"Register Now"})}),(0,m.jsx)("div",{className:"login-link",children:(0,m.jsxs)("p",{children:["Already have an account? ",(0,m.jsx)(d.N_,{to:"/login",children:"Sign In"})]})})]})]})})]})})}}}]);
//# sourceMappingURL=372.e93500cc.chunk.js.map