"use strict";(self.webpackChunkagristack_farmer_management=self.webpackChunkagristack_farmer_management||[]).push([[761],{1125:(e,a,s)=>{s.d(a,{A:()=>i});var l=s(5043),n=s(579);const i=e=>{let{isOpen:a,onClose:s,farmer:i,onUpload:o,onApprove:t,onReject:d,onReferBack:r}=e;const[c,m]=(0,l.useState)({aadhaar:null,pan:null,landDocuments:null,bankPassbook:null,incomeCertificate:null,casteCertificate:null,otherDocuments:[]}),[u,h]=(0,l.useState)({}),[p,j]=(0,l.useState)("PENDING"),[g,x]=(0,l.useState)(""),[y,v]=(0,l.useState)(""),[k,N]=(0,l.useState)(!1);if(!a||!i)return null;const b=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;m(null!==a?e=>({...e,otherDocuments:e.otherDocuments.filter(((e,s)=>s!==a))}):a=>({...a,[e]:null}))},f=e=>c[e]?"uploaded":"missing",C=()=>[{key:"aadhaar",label:"Aadhaar Card",required:!0},{key:"pan",label:"PAN Card",required:!0},{key:"landDocuments",label:"Land Documents",required:!0},{key:"bankPassbook",label:"Bank Passbook",required:!0},{key:"incomeCertificate",label:"Income Certificate",required:!1},{key:"casteCertificate",label:"Caste Certificate",required:!1}].filter((e=>e.required)).every((e=>"uploaded"===f(e.key)));return(0,n.jsxs)("div",{className:"kyc-document-upload-component-modal",children:[(0,n.jsx)("div",{className:"kyc-document-upload-overlay",onClick:s}),(0,n.jsxs)("div",{className:"kyc-document-upload-content",children:[(0,n.jsxs)("div",{className:"kyc-document-upload-header",children:[(0,n.jsx)("h2",{children:"KYC Document Upload & Review"}),(0,n.jsx)("button",{className:"kyc-document-upload-close-btn",onClick:s,children:"\xd7"})]}),(0,n.jsxs)("div",{className:"kyc-document-upload-body",children:[(0,n.jsxs)("div",{className:"kyc-document-upload-farmer-info",children:[(0,n.jsx)("h3",{children:"Farmer Information"}),(0,n.jsxs)("div",{className:"kyc-document-upload-info-grid",children:[(0,n.jsxs)("div",{className:"kyc-document-upload-info-item",children:[(0,n.jsx)("label",{children:"Name:"}),(0,n.jsx)("span",{children:i.name})]}),(0,n.jsxs)("div",{className:"kyc-document-upload-info-item",children:[(0,n.jsx)("label",{children:"Phone:"}),(0,n.jsx)("span",{children:i.phone})]}),(0,n.jsxs)("div",{className:"kyc-document-upload-info-item",children:[(0,n.jsx)("label",{children:"State:"}),(0,n.jsx)("span",{children:i.state})]}),(0,n.jsxs)("div",{className:"kyc-document-upload-info-item",children:[(0,n.jsx)("label",{children:"District:"}),(0,n.jsx)("span",{children:i.district})]}),(0,n.jsxs)("div",{className:"kyc-document-upload-info-item",children:[(0,n.jsx)("label",{children:"KYC Status:"}),(0,n.jsx)("span",{className:`kyc-document-upload-status-badge kyc-document-upload-status-${p.toLowerCase()}`,children:p})]})]})]}),(0,n.jsxs)("div",{className:"kyc-document-upload-section",children:[(0,n.jsx)("h3",{children:"Required Documents"}),(0,n.jsx)("div",{className:"kyc-document-upload-document-grid",children:[{key:"aadhaar",label:"Aadhaar Card",required:!0},{key:"pan",label:"PAN Card",required:!0},{key:"landDocuments",label:"Land Documents",required:!0},{key:"bankPassbook",label:"Bank Passbook",required:!0},{key:"incomeCertificate",label:"Income Certificate",required:!1},{key:"casteCertificate",label:"Caste Certificate",required:!1}].map((e=>(0,n.jsxs)("div",{className:`kyc-document-upload-document-item ${f(e.key)}`,children:[(0,n.jsxs)("div",{className:"kyc-document-upload-document-header",children:[(0,n.jsx)("h4",{children:e.label}),e.required&&(0,n.jsx)("span",{className:"kyc-document-upload-required-badge",children:"Required"})]}),c[e.key]?(0,n.jsxs)("div",{className:"kyc-document-upload-uploaded-document",children:[(0,n.jsxs)("div",{className:"kyc-document-upload-document-info",children:[(0,n.jsx)("span",{className:"kyc-document-upload-document-name",children:c[e.key].name}),(0,n.jsxs)("span",{className:"kyc-document-upload-document-size",children:[(c[e.key].size/1024/1024).toFixed(2)," MB"]})]}),(0,n.jsxs)("div",{className:"kyc-document-upload-document-actions",children:[(0,n.jsx)("button",{className:"kyc-document-upload-view-btn",onClick:()=>window.open(c[e.key].url),children:"\ud83d\udc41\ufe0f View"}),(0,n.jsx)("button",{className:"kyc-document-upload-remove-btn",onClick:()=>b(e.key),children:"\ud83d\uddd1\ufe0f Remove"})]})]}):(0,n.jsx)("div",{className:"kyc-document-upload-upload-area",children:void 0!==u[e.key]?(0,n.jsxs)("div",{className:"kyc-document-upload-progress",children:[(0,n.jsx)("div",{className:"kyc-document-upload-progress-bar",children:(0,n.jsx)("div",{className:"kyc-document-upload-progress-fill",style:{width:`${u[e.key]}%`}})}),(0,n.jsxs)("span",{children:[u[e.key],"%"]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{type:"file",id:`file-${e.key}`,accept:".pdf,.jpg,.jpeg,.png,.doc,.docx",onChange:a=>((e,a)=>{if(!a)return;h((a=>({...a,[e]:0})));const s=setInterval((()=>{h((l=>{const n=l[e]+10;return n>=100&&(clearInterval(s),m((s=>({...s,[e]:{name:a.name,size:a.size,type:a.type,uploadedAt:(new Date).toISOString(),url:URL.createObjectURL(a)}})))),{...l,[e]:n}}))}),100);setTimeout((()=>{h((a=>({...a,[e]:100})))}),1e3)})(e.key,a.target.files[0]),style:{display:"none"}}),(0,n.jsxs)("label",{htmlFor:`file-${e.key}`,className:"kyc-document-upload-upload-label",children:[(0,n.jsx)("div",{className:"kyc-document-upload-upload-icon",children:"\ud83d\udcc1"}),(0,n.jsxs)("span",{children:["Click to upload ",e.label]}),(0,n.jsx)("small",{children:"PDF, JPG, PNG, DOC (Max 10MB)"})]})]})})]},e.key)))}),(0,n.jsxs)("div",{className:"kyc-document-upload-additional-documents",children:[(0,n.jsx)("h4",{children:"Additional Documents"}),(0,n.jsxs)("div",{className:"kyc-document-upload-upload-area",children:[(0,n.jsx)("input",{type:"file",id:"additional-files",multiple:!0,accept:".pdf,.jpg,.jpeg,.png,.doc,.docx",onChange:e=>{return a=e.target.files,void Array.from(a).forEach((e=>{const a={name:e.name,size:e.size,type:e.type,uploadedAt:(new Date).toISOString(),url:URL.createObjectURL(e)};m((e=>({...e,otherDocuments:[...e.otherDocuments,a]})))}));var a},style:{display:"none"}}),(0,n.jsxs)("label",{htmlFor:"additional-files",className:"kyc-document-upload-upload-label",children:[(0,n.jsx)("div",{className:"kyc-document-upload-upload-icon",children:"\ud83d\udcc1"}),(0,n.jsx)("span",{children:"Upload Additional Documents"}),(0,n.jsx)("small",{children:"Multiple files allowed"})]})]}),c.otherDocuments.length>0&&(0,n.jsx)("div",{className:"kyc-document-upload-additional-documents-list",children:c.otherDocuments.map(((e,a)=>(0,n.jsxs)("div",{className:"kyc-document-upload-additional-document",children:[(0,n.jsx)("span",{className:"kyc-document-upload-document-name",children:e.name}),(0,n.jsxs)("div",{className:"kyc-document-upload-document-actions",children:[(0,n.jsx)("button",{className:"kyc-document-upload-view-btn",onClick:()=>window.open(e.url),children:"\ud83d\udc41\ufe0f View"}),(0,n.jsx)("button",{className:"kyc-document-upload-remove-btn",onClick:()=>b("otherDocuments",a),children:"\ud83d\uddd1\ufe0f Remove"})]})]},a)))})]})]}),(0,n.jsxs)("div",{className:"kyc-document-upload-kyc-actions",children:[(0,n.jsx)("h3",{children:"KYC Review Actions"}),(0,n.jsxs)("div",{className:"kyc-document-upload-action-buttons",children:[(0,n.jsx)("button",{className:"kyc-document-upload-action-btn kyc-document-upload-approve-btn "+(C()?"":"disabled"),onClick:async()=>{N(!0);try{await new Promise((e=>setTimeout(e,1e3))),j("APPROVED"),t&&t(i.id,c),alert("KYC approved successfully!")}catch(e){console.error("Error approving KYC:",e),alert("Error approving KYC")}finally{N(!1)}},disabled:!C()||k,children:k?"\u23f3 Processing...":"\u2705 Approve KYC"}),(0,n.jsx)("button",{className:"kyc-document-upload-action-btn kyc-document-upload-refer-back-btn",onClick:()=>document.getElementById("refer-back-reason").focus(),disabled:k,children:"\ud83d\udd04 Refer Back"}),(0,n.jsx)("button",{className:"kyc-document-upload-action-btn kyc-document-upload-reject-btn",onClick:()=>document.getElementById("rejection-reason").focus(),disabled:k,children:"\u274c Reject KYC"})]}),(0,n.jsxs)("div",{className:"kyc-document-upload-reason-input",children:[(0,n.jsx)("label",{htmlFor:"refer-back-reason",children:"Refer Back Reason:"}),(0,n.jsx)("textarea",{id:"refer-back-reason",value:y,onChange:e=>v(e.target.value),placeholder:"Enter reason for referring back...",rows:"3"}),y&&(0,n.jsx)("button",{className:"kyc-document-upload-submit-reason-btn",onClick:async()=>{if(y.trim()){N(!0);try{await new Promise((e=>setTimeout(e,1e3))),j("REFER_BACK"),r&&r(i.id,y,c),alert("KYC referred back successfully!")}catch(e){console.error("Error referring back KYC:",e),alert("Error referring back KYC")}finally{N(!1)}}else alert("Please provide a reason for referring back")},disabled:k,children:k?"Processing...":"Submit Refer Back"})]}),(0,n.jsxs)("div",{className:"kyc-document-upload-reason-input",children:[(0,n.jsx)("label",{htmlFor:"rejection-reason",children:"Rejection Reason:"}),(0,n.jsx)("textarea",{id:"rejection-reason",value:g,onChange:e=>x(e.target.value),placeholder:"Enter reason for rejection...",rows:"3"}),g&&(0,n.jsx)("button",{className:"kyc-document-upload-submit-reason-btn kyc-document-upload-reject",onClick:async()=>{if(g.trim()){N(!0);try{await new Promise((e=>setTimeout(e,1e3))),j("REJECTED"),d&&d(i.id,g,c),alert("KYC rejected successfully!")}catch(e){console.error("Error rejecting KYC:",e),alert("Error rejecting KYC")}finally{N(!1)}}else alert("Please provide a rejection reason")},disabled:k,children:k?"Processing...":"Submit Rejection"})]})]})]}),(0,n.jsx)("div",{className:"kyc-document-upload-footer",children:(0,n.jsx)("button",{className:"kyc-document-upload-close-button",onClick:s,children:"Close"})})]})]})}},1953:(e,a,s)=>{s(5043),s(579)},4499:(e,a,s)=>{s.d(a,{A:()=>i});var l=s(5043),n=s(579);const i=e=>{var a;let{farmers:s,employees:i,onClose:o,onAssign:t}=e;const[d,r]=(0,l.useState)([]),[c,m]=(0,l.useState)(""),[u,h]=(0,l.useState)(!1);var p,j;((0,l.useEffect)((()=>{console.log("=== ASSIGNMENT MODAL MOUNTED ==="),console.log("Employees on mount:",i),console.log("Employees count on mount:",(null===i||void 0===i?void 0:i.length)||0),i&&i.length>0&&console.log("First employee on mount:",i[0])}),[]),console.log("=== ASSIGNMENT MODAL DEBUG ==="),console.log("Employees received:",i),console.log("Employees count:",(null===i||void 0===i?void 0:i.length)||0),console.log("Employees type:",typeof i),console.log("Employees is array:",Array.isArray(i)),i&&i.length>0)&&(console.log("First employee:",i[0]),console.log("First employee name:",null===(p=i[0])||void 0===p?void 0:p.name),console.log("First employee designation:",null===(j=i[0])||void 0===j?void 0:j.designation),console.log("All employee names:",i.map((e=>null===e||void 0===e?void 0:e.name))));return(0,n.jsx)("div",{className:"assignment-modal-overlay",children:(0,n.jsxs)("div",{className:"assignment-modal-content large",children:[(0,n.jsxs)("div",{className:"assignment-modal-header",children:[(0,n.jsx)("h2",{children:"Assign Farmers to Employee"}),(0,n.jsx)("button",{className:"assignment-modal-close-btn",onClick:o,children:"\xd7"})]}),(0,n.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),c&&0!==d.length){h(!0);try{const e=i.find((e=>e.id===parseInt(c))),a=d.map((a=>{const l=s.find((e=>e.id===a));return{farmerId:a,employeeId:parseInt(c),employeeName:e.name,farmerName:l.name}}));await t(a)}catch(a){console.error("Error assigning farmers:",a)}finally{h(!1)}}else alert("Please select an employee and at least one farmer")},className:"assignment-modal-form",children:[(0,n.jsxs)("div",{className:"assignment-modal-section",children:[(0,n.jsx)("div",{className:"assignment-modal-section-header",children:(0,n.jsx)("h3",{children:"Select Employee"})}),(0,n.jsxs)("div",{className:"assignment-modal-form-group",children:[(0,n.jsx)("label",{htmlFor:"employee",children:"Employee *"}),(0,n.jsxs)("select",{id:"employee",value:c,onChange:e=>m(e.target.value),required:!0,children:[(0,n.jsx)("option",{value:"",children:"Select Employee"}),(console.log("=== RENDERING EMPLOYEE OPTIONS ==="),console.log("Employees for rendering:",i),console.log("Employees length for rendering:",(null===i||void 0===i?void 0:i.length)||0),i&&i.length>0&&console.log("Rendering employee options:",i.map((e=>({id:e.id,name:e.name,designation:e.designation,displayText:`${e.name||"Unknown"} - ${e.designation||"Employee"}`})))),i&&i.length>0?i.map((e=>(0,n.jsxs)("option",{value:e.id,children:[e.name||"Unknown"," - ",e.designation||"Employee"]},e.id))):(0,n.jsx)("option",{value:"",disabled:!0,children:"No employees available"}))]})]})]}),(0,n.jsxs)("div",{className:"assignment-modal-section",children:[(0,n.jsxs)("div",{className:"assignment-modal-section-header",children:[(0,n.jsx)("h3",{children:"Select Farmers"}),(0,n.jsx)("button",{type:"button",className:"assignment-modal-btn-link",onClick:()=>{d.length===s.length?r([]):r(s.map((e=>e.id)))},children:d.length===s.length?"Deselect All":"Select All"})]}),(0,n.jsx)("div",{className:"assignment-modal-farmers-list",children:0===s.length?(0,n.jsx)("p",{className:"assignment-modal-no-data",children:"No unassigned farmers available"}):s.map((e=>(0,n.jsx)("div",{className:"assignment-modal-farmer-item",children:(0,n.jsxs)("label",{className:"assignment-modal-checkbox-label",children:[(0,n.jsx)("input",{type:"checkbox",checked:d.includes(e.id),onChange:()=>{return a=e.id,void r((e=>e.includes(a)?e.filter((e=>e!==a)):[...e,a]));var a}}),(0,n.jsx)("span",{className:"assignment-modal-checkmark"}),(0,n.jsxs)("div",{className:"assignment-modal-farmer-info",children:[(0,n.jsx)("strong",{children:e.name}),(0,n.jsx)("span",{children:e.phone}),(0,n.jsxs)("span",{children:[e.state,", ",e.district]})]})]})},e.id)))})]}),(0,n.jsxs)("div",{className:"assignment-modal-summary",children:[(0,n.jsxs)("div",{className:"assignment-modal-summary-item",children:[(0,n.jsx)("span",{children:"Selected Farmers:"}),(0,n.jsx)("strong",{children:d.length})]}),(0,n.jsxs)("div",{className:"assignment-modal-summary-item",children:[(0,n.jsx)("span",{children:"Selected Employee:"}),(0,n.jsx)("strong",{children:c?null===(a=i.find((e=>e.id===parseInt(c))))||void 0===a?void 0:a.name:"None"})]})]}),(0,n.jsxs)("div",{className:"assignment-modal-form-actions",children:[(0,n.jsx)("button",{type:"button",className:"assignment-modal-btn-secondary",onClick:o,children:"Cancel"}),(0,n.jsx)("button",{type:"submit",className:"assignment-modal-btn-primary",disabled:u||0===d.length||!c,children:u?"Assigning...":`Assign ${d.length} Farmer${1!==d.length?"s":""}`})]})]})]})})}},9764:(e,a,s)=>{s.d(a,{A:()=>o});var l=s(5043),n=s(476),i=s(579);const o=e=>{var a;let{registration:s,onClose:o,onUpdate:t}=e;const[d,r]=(0,l.useState)(!1),[c,m]=(0,l.useState)({status:(null===s||void 0===s?void 0:s.status)||"",role:(null===s||void 0===s?void 0:s.role)||""});return s?(0,i.jsx)("div",{className:"registration-detail-modal-overlay",children:(0,i.jsxs)("div",{className:"registration-detail-modal-content registration-detail-modal",children:[(0,i.jsxs)("div",{className:"registration-detail-modal-header",children:[(0,i.jsx)("h2",{children:"Registration Details"}),(0,i.jsx)("button",{className:"registration-detail-modal-close",onClick:o,children:"\xd7"})]}),(0,i.jsx)("div",{className:"registration-detail-modal-body",children:(0,i.jsxs)("div",{className:"registration-detail-modal-registration-info",children:[(0,i.jsxs)("div",{className:"registration-detail-modal-info-section",children:[(0,i.jsx)("h3",{children:"Personal Information"}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-grid",children:[(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"Name:"}),(0,i.jsx)("span",{children:s.name})]}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"Email:"}),(0,i.jsx)("span",{children:s.email})]}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"Phone:"}),(0,i.jsx)("span",{children:s.phoneNumber})]}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"Gender:"}),(0,i.jsx)("span",{children:s.gender})]}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"Date of Birth:"}),(0,i.jsx)("span",{children:s.dateOfBirth})]})]})]}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-section",children:[(0,i.jsx)("h3",{children:"Account Information"}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-grid",children:[(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"Role:"}),(0,i.jsx)("div",{className:"registration-detail-modal-editable-field",children:d?(0,i.jsxs)("select",{value:c.role,onChange:e=>(async e=>{try{await n.Dv.updateUser(s.id,{role:e}),m((a=>({...a,role:e}))),t&&t(),alert("Role updated successfully!")}catch(i){var a,l;console.error("Error updating role:",i),alert(`Failed to update role: ${(null===(a=i.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.message)||i.message}`)}})(e.target.value),className:"registration-detail-modal-form-select",children:[(0,i.jsx)("option",{value:"FARMER",children:"Farmer"}),(0,i.jsx)("option",{value:"EMPLOYEE",children:"Employee"}),(0,i.jsx)("option",{value:"ADMIN",children:"Admin"}),(0,i.jsx)("option",{value:"SUPER_ADMIN",children:"Super Admin"})]}):(0,i.jsx)("span",{className:`registration-detail-modal-status-badge registration-detail-modal-role-${s.role.toLowerCase()}`,children:s.role})})]}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"Status:"}),(0,i.jsx)("div",{className:"registration-detail-modal-editable-field",children:d?(0,i.jsxs)("select",{value:c.status,onChange:e=>(async e=>{try{"APPROVED"===e?await n.Dv.approveUser(s.id,s.role):"REJECTED"===e?await n.Dv.rejectUser(s.id,"Rejected by admin"):await n.Dv.updateUserStatus(s.id,e),m((a=>({...a,status:e}))),t&&t(),alert(`Registration ${e.toLowerCase()} successfully!`)}catch(i){var a,l;console.error("Error updating registration status:",i),alert(`Failed to update registration status: ${(null===(a=i.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.message)||i.message}`)}})(e.target.value),className:"registration-detail-modal-form-select",children:[(0,i.jsx)("option",{value:"PENDING",children:"Pending"}),(0,i.jsx)("option",{value:"APPROVED",children:"Approved"}),(0,i.jsx)("option",{value:"REJECTED",children:"Rejected"})]}):(0,i.jsx)("span",{className:`registration-detail-modal-status-badge registration-detail-modal-status-${s.status.toLowerCase()}`,children:s.status})})]}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"KYC Status:"}),(0,i.jsx)("span",{className:`registration-detail-modal-status-badge registration-detail-modal-kyc-${(null===(a=s.kycStatus)||void 0===a?void 0:a.toLowerCase())||"pending"}`,children:s.kycStatus||"PENDING"})]}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"Registration Date:"}),(0,i.jsx)("span",{children:new Date(s.createdAt).toLocaleDateString()})]})]})]}),s.state&&(0,i.jsxs)("div",{className:"registration-detail-modal-info-section",children:[(0,i.jsx)("h3",{children:"Location Information"}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-grid",children:[(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"State:"}),(0,i.jsx)("span",{children:s.state})]}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"District:"}),(0,i.jsx)("span",{children:s.district})]}),(0,i.jsxs)("div",{className:"registration-detail-modal-info-item",children:[(0,i.jsx)("label",{children:"Region:"}),(0,i.jsx)("span",{children:s.region})]})]})]})]})}),(0,i.jsxs)("div",{className:"registration-detail-modal-footer",children:[(0,i.jsx)("button",{className:"registration-detail-modal-action-btn "+(d?"registration-detail-modal-secondary":"registration-detail-modal-primary"),onClick:()=>r(!d),children:d?"Cancel Editing":"Edit Registration"}),(0,i.jsx)("button",{className:"registration-detail-modal-action-btn registration-detail-modal-secondary",onClick:o,children:"Close"})]})]})}):null}}}]);
//# sourceMappingURL=761.387aa97b.chunk.js.map